(()=>{var e={57:e=>{!function(){var r={};function t(){"undefined"==typeof process&&console.log.apply(console,arguments)}e.exports=r,function(e){var r,i,n,a,o,f,s,h,l,u,d,c,v,g,m,w;!function(){"use strict";var r=function(){function e(e){this.message="JPEG error: "+e}return e.prototype=new Error,e.prototype.name="JpegError",e.constructor=e,e}(),t=function(){var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,n=799,a=3406,o=2276,f=1567,s=3784,h=5793,l=2896;function u(e){null==e&&(e={}),null==e.w&&(e.w=-1),this.V=e.n,this.N=e.w}function d(e,r){for(var t,i,n,a=0,o=[],f=16;f>0&&!e[f-1];)f--;o.push({children:[],index:0});var s=o[0];for(t=0;t<f;t++){for(i=0;i<e[t];i++){for((s=o.pop()).children[s.index]=r[a];s.index>0;)s=o.pop();for(s.index++,o.push(s);o.length<=t;)o.push(n={children:[],index:0}),s.children[s.index]=n.children,s=n;a++}t+1<f&&(o.push(n={children:[],index:0}),s.children[s.index]=n.children,s=n)}return o[0].children}function c(e,r,t){return 64*((e.P+1)*r+t)}function v(t,n,a,o,f,s,h,l,u,d){null==d&&(d=!1);var v,g,m,p,b,y,_,I,A,U,E,B=a.m,D=a.Z,M=n,P=0,C=0,k=0,x=0,F=0,T=0;function S(){if(C>0)return C--,P>>C&1;if(255===(P=t[n++])){var e=t[n++];if(e){if(220===e&&d){var o=i(t,n+=2);if(n+=2,o>0&&o!==a.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",o)}else if(217===e){if(d){var f=8*F;if(f>0&&f<a.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",f)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new r("unexpected marker")}}return C=7,P>>>7}function L(e){for(var t=e;;){switch(typeof(t=t[S()])){case"number":return t;case"object":continue}throw new r("invalid huffman sequence")}}function H(e){for(var r=0;e>0;)r=r<<1|S(),e--;return r}function O(e){if(1===e)return 1===S()?1:-1;var r=H(e);return r>=1<<e-1?r:r+(-1<<e)+1}function N(e,r,t,i,n){var a=t%B;F=(t/B|0)*e.A+i;var o=a*e.h+n;r(e,c(e,F,o))}function G(e,r,t){F=t/e.P|0;var i=t%e.P;r(e,c(e,F,i))}var R=o.length;for(_=D?0===s?0===l?function(e,r){var t=L(e.J),i=0===t?0:O(t)<<u;e.D[r]=e.Q+=i}:function(e,r){e.D[r]|=S()<<u}:0===l?function(r,t){if(k>0)k--;else for(var i=s,n=h;i<=n;){var a=L(r.i),o=15&a,f=a>>4;if(0!==o){var l=e[i+=f];r.D[t+l]=O(o)*(1<<u),i++}else{if(f<15){k=H(f)+(1<<f)-1;break}i+=16}}}:function(t,i){for(var n,a,o=s,f=h,l=0;o<=f;){var d=i+e[o],c=t.D[d]<0?-1:1;switch(x){case 0:if(l=(a=L(t.i))>>4,0==(n=15&a))l<15?(k=H(l)+(1<<l),x=4):(l=16,x=1);else{if(1!==n)throw new r("invalid ACn encoding");v=O(n),x=l?2:3}continue;case 1:case 2:t.D[d]?t.D[d]+=c*(S()<<u):0==--l&&(x=2===x?3:0);break;case 3:t.D[d]?t.D[d]+=c*(S()<<u):(t.D[d]=v<<u,x=0);break;case 4:t.D[d]&&(t.D[d]+=c*(S()<<u))}o++}4===x&&0==--k&&(x=0)}:function(r,t){var i=L(r.J),n=0===i?0:O(i),a=1;for(r.D[t]=r.Q+=n;a<64;){var o=L(r.i),f=15&o,s=o>>4;if(0!==f){var h=e[a+=s];r.D[t+h]=O(f),a++}else{if(s<15)break;a+=16}}},A=1===R?o[0].P*o[0].c:B*a.R;T<=A;){var J=f?Math.min(A-T,f):A;if(J>0){for(m=0;m<R;m++)o[m].Q=0;if(k=0,1===R)for(g=o[0],y=0;y<J;y++)G(g,_,T),T++;else for(y=0;y<J;y++){for(m=0;m<R;m++)for(U=(g=o[m]).h,E=g.A,p=0;p<E;p++)for(b=0;b<U;b++)N(g,_,T,p,b);T++}}if(C=0,!(I=w(t,n)))break;if(I.u&&(n=I.offset),!(I.M>=65488&&I.M<=65495))break;n+=2}return n-M}function g(e,i,u){var d,c,v,g,m,w,p,b,y,_,I,A,U,E,B,D,M,P=e.$,C=e.D;if(!P)throw new r("missing required Quantization Table.");for(var k=0;k<64;k+=8)y=C[i+k],_=C[i+k+1],I=C[i+k+2],A=C[i+k+3],U=C[i+k+4],E=C[i+k+5],B=C[i+k+6],D=C[i+k+7],y*=P[k],0!=(_|I|A|U|E|B|D)?(_*=P[k+1],I*=P[k+2],A*=P[k+3],U*=P[k+4],E*=P[k+5],B*=P[k+6],D*=P[k+7],c=(d=(d=h*y+128>>8)+(c=h*U+128>>8)+1>>1)-c,M=(v=I)*s+(g=B)*f+128>>8,v=v*f-g*s+128>>8,p=(m=(m=l*(_-D)+128>>8)+(p=E<<4)+1>>1)-p,w=(b=(b=l*(_+D)+128>>8)+(w=A<<4)+1>>1)-w,g=(d=d+(g=M)+1>>1)-g,v=(c=c+v+1>>1)-v,M=m*o+b*a+2048>>12,m=m*a-b*o+2048>>12,b=M,M=w*n+p*t+2048>>12,w=w*t-p*n+2048>>12,p=M,u[k]=d+b,u[k+7]=d-b,u[k+1]=c+p,u[k+6]=c-p,u[k+2]=v+w,u[k+5]=v-w,u[k+3]=g+m,u[k+4]=g-m):(M=h*y+512>>10,u[k]=M,u[k+1]=M,u[k+2]=M,u[k+3]=M,u[k+4]=M,u[k+5]=M,u[k+6]=M,u[k+7]=M);for(var x=0;x<8;++x)y=u[x],0!=((_=u[x+8])|(I=u[x+16])|(A=u[x+24])|(U=u[x+32])|(E=u[x+40])|(B=u[x+48])|(D=u[x+56]))?(c=(d=4112+((d=h*y+2048>>12)+(c=h*U+2048>>12)+1>>1))-c,M=(v=I)*s+(g=B)*f+2048>>12,v=v*f-g*s+2048>>12,g=M,p=(m=(m=l*(_-D)+2048>>12)+(p=E)+1>>1)-p,w=(b=(b=l*(_+D)+2048>>12)+(w=A)+1>>1)-w,M=m*o+b*a+2048>>12,m=m*a-b*o+2048>>12,b=M,M=w*n+p*t+2048>>12,w=w*t-p*n+2048>>12,(y=(d=d+g+1>>1)+b)<16?y=0:y>=4080?y=255:y>>=4,(_=(c=c+v+1>>1)+(p=M))<16?_=0:_>=4080?_=255:_>>=4,(I=(v=c-v)+w)<16?I=0:I>=4080?I=255:I>>=4,(A=(g=d-g)+m)<16?A=0:A>=4080?A=255:A>>=4,(U=g-m)<16?U=0:U>=4080?U=255:U>>=4,(E=v-w)<16?E=0:E>=4080?E=255:E>>=4,(B=c-p)<16?B=0:B>=4080?B=255:B>>=4,(D=d-b)<16?D=0:D>=4080?D=255:D>>=4,C[i+x]=y,C[i+x+8]=_,C[i+x+16]=I,C[i+x+24]=A,C[i+x+32]=U,C[i+x+40]=E,C[i+x+48]=B,C[i+x+56]=D):(M=(M=h*y+8192>>14)<-2040?0:M>=2024?255:M+2056>>4,C[i+x]=M,C[i+x+8]=M,C[i+x+16]=M,C[i+x+24]=M,C[i+x+32]=M,C[i+x+40]=M,C[i+x+48]=M,C[i+x+56]=M)}function m(e,r){for(var t=r.P,i=r.c,n=new Int16Array(64),a=0;a<i;a++)for(var o=0;o<t;o++)g(r,c(r,a,o),n);return r.D}function w(e,r,t){null==t&&(t=r);var n=e.length-1,a=t<r?t:r;if(r>=n)return null;var o=i(e,r);if(o>=65472&&o<=65534)return{u:null,M:o,offset:r};for(var f=i(e,a);!(f>=65472&&f<=65534);){if(++a>=n)return null;f=i(e,a)}return{u:o.toString(16),M:f,offset:a}}return u.prototype={parse(t,n){null==n&&(n={});var a,o,f=n.F,s=0,h=null,l=null,u=0;function c(){var e=i(t,s),r=(s+=2)+e-2,n=w(t,r,s);n&&n.u&&(r=n.offset);var a=t.subarray(s,r);return s+=a.length,a}function g(e){for(var r=Math.ceil(e.o/8/e.X),t=Math.ceil(e.s/8/e.B),i=0;i<e.W.length;i++){J=e.W[i];var n=Math.ceil(Math.ceil(e.o/8)*J.h/e.X),a=Math.ceil(Math.ceil(e.s/8)*J.A/e.B),o=r*J.h,f=t*J.A*64*(o+1);J.D=new Int16Array(f),J.P=n,J.c=a}e.m=r,e.R=t}var p=[],b=[],y=[],_=i(t,s);if(s+=2,65496!==_)throw new r("SOI not found");_=i(t,s),s+=2;e:for(;65497!==_;){var I,A,U;switch(_){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var E=c();65504===_&&74===E[0]&&70===E[1]&&73===E[2]&&70===E[3]&&0===E[4]&&(h={version:{d:E[5],T:E[6]},K:E[7],j:E[8]<<8|E[9],H:E[10]<<8|E[11],S:E[12],I:E[13],C:E.subarray(14,14+3*E[12]*E[13])}),65518===_&&65===E[0]&&100===E[1]&&111===E[2]&&98===E[3]&&101===E[4]&&(l={version:E[5]<<8|E[6],k:E[7]<<8|E[8],q:E[9]<<8|E[10],a:E[11]});break;case 65499:for(var B=i(t,s)+(s+=2)-2;s<B;){var D=t[s++],M=new Uint16Array(64);if(D>>4==0)for(A=0;A<64;A++)M[e[A]]=t[s++];else{if(D>>4!=1)throw new r("DQT - invalid table spec");for(A=0;A<64;A++)M[e[A]]=i(t,s),s+=2}p[15&D]=M}break;case 65472:case 65473:case 65474:if(a)throw new r("Only single frame JPEGs supported");s+=2,(a={}).G=65473===_,a.Z=65474===_,a.precision=t[s++];var P,C=i(t,s),k=0,x=0;s+=2,a.s=f||C,a.o=i(t,s),s+=2,a.W=[],a._={};var F=t[s++];for(I=0;I<F;I++){P=t[s];var T=t[s+1]>>4,S=15&t[s+1];k<T&&(k=T),x<S&&(x=S);var L=t[s+2];U=a.W.push({h:T,A:S,L,$:null}),a._[P]=U-1,s+=3}a.X=k,a.B=x,g(a);break;case 65476:var H=i(t,s);for(s+=2,I=2;I<H;){var O=t[s++],N=new Uint8Array(16),G=0;for(A=0;A<16;A++,s++)G+=N[A]=t[s];var R=new Uint8Array(G);for(A=0;A<G;A++,s++)R[A]=t[s];I+=17+G,(O>>4==0?y:b)[15&O]=d(N,R)}break;case 65501:o=i(t,s+=2),s+=2;break;case 65498:var J,W=1==++u&&!f;s+=2;var j=t[s++],z=[];for(I=0;I<j;I++){var $=t[s++],q=a._[$];(J=a.W[q]).index=$;var X=t[s++];J.J=y[X>>4],J.i=b[15&X],z.push(J)}var Y=t[s++],Q=t[s++],V=t[s++];try{var Z=v(t,s,a,z,o,Y,Q,V>>4,15&V,W);s+=Z}catch(e){if(e instanceof DNLMarkerError)return this.parse(t,{F:e.s});if(e instanceof EOIMarkerError)break e;throw e}break;case 65500:s+=4;break;case 65535:255!==t[s]&&s--;break;default:var K=w(t,s-2,s-3);if(K&&K.u){s=K.offset;break}if(s>=t.length-1)break e;throw new r("JpegImage.parse - unknown marker: "+_.toString(16))}_=i(t,s),s+=2}for(this.width=a.o,this.height=a.s,this.g=h,this.b=l,this.W=[],I=0;I<a.W.length;I++){var ee=p[(J=a.W[I]).L];ee&&(J.$=ee),this.W.push({index:J.index,e:m(0,J),l:J.h/a.X,t:J.A/a.B,P:J.P,c:J.c})}this.p=this.W.length},Y(e,r,t){null==t&&(t=!1);var i,n,a,o,f,s,h,l,u,d,c,v,g=this.width/e,m=this.height/r,w=0,p=this.W.length,b=e*r*p,y=new Uint8ClampedArray(b),_=new Uint32Array(e),I=4294967288;for(h=0;h<p;h++){if(n=(i=this.W[h]).l*g,a=i.t*m,w=h,c=i.e,o=i.P+1<<3,n!==v){for(f=0;f<e;f++)l=0|f*n,_[f]=(l&I)<<3|7&l;v=n}for(s=0;s<r;s++)for(d=o*((l=0|s*a)&I)|(7&l)<<3,f=0;f<e;f++)y[w]=c[d+_[f]],w+=p}var A=this.V;if(t||4!==p||A||(A=new Int32Array([-256,255,-256,255,-256,255,-256,255])),A)for(h=0;h<b;)for(l=0,u=0;l<p;l++,h++,u+=2)y[h]=(y[h]*A[u]>>8)+A[u+1];return y},get f(){return this.b?!!this.b.a:3===this.p?0!==this.N&&(82!==this.W[0].index||71!==this.W[1].index||66!==this.W[2].index):1===this.N},z:function(e){for(var r,t,i,n=0,a=e.length;n<a;n+=3)r=e[n],t=e[n+1],i=e[n+2],e[n]=r-179.456+1.402*i,e[n+1]=r+135.459-.344*t-.714*i,e[n+2]=r-226.816+1.772*t;return e},O:function(e){for(var r,t,i,n,a=0,o=0,f=e.length;o<f;o+=4)r=e[o],t=e[o+1],i=e[o+2],n=e[o+3],e[a++]=t*(-660635669420364e-19*t+.000437130475926232*i-54080610064599e-18*r+.00048449797120281*n-.154362151871126)-122.67195406894+i*(-.000957964378445773*i+.000817076911346625*r-.00477271405408747*n+1.53380253221734)+r*(.000961250184130688*r-.00266257332283933*n+.48357088451265)+n*(-.000336197177618394*n+.484791561490776),e[a++]=107.268039397724+t*(219927104525741e-19*t-.000640992018297945*i+.000659397001245577*r+.000426105652938837*n-.176491792462875)+i*(-.000778269941513683*i+.00130872261408275*r+.000770482631801132*n-.151051492775562)+r*(.00126935368114843*r-.00265090189010898*n+.25802910206845)+n*(-.000318913117588328*n-.213742400323665),e[a++]=t*(-.000570115196973677*t-263409051004589e-19*i+.0020741088115012*r-.00288260236853442*n+.814272968359295)-20.810012546947+i*(-153496057440975e-19*i-.000132689043961446*r+.000560833691242812*n-.195152027534049)+r*(.00174418132927582*r-.00255243321439347*n+.116935020465145)+n*(-.000343531996510555*n+.24165260232407);return e.subarray(0,a)},r:function(e){for(var r,t,i,n=0,a=e.length;n<a;n+=4)r=e[n],t=e[n+1],i=e[n+2],e[n]=434.456-r-1.402*i,e[n+1]=119.541-r+.344*t+.714*i,e[n+2]=481.816-r-1.772*t;return e},U:function(e){for(var r,t,i,n,a=0,o=0,f=e.length;o<f;o+=4)r=e[o],t=e[o+1],i=e[o+2],n=e[o+3],e[a++]=255+r*(-6747147073602441e-20*r+.0008379262121013727*t+.0002894718188643294*i+.003264231057537806*n-1.1185611867203937)+t*(26374107616089405e-21*t-8626949158638572e-20*i-.0002748769067499491*n-.02155688794978967)+i*(-3878099212869363e-20*i-.0003267808279485286*n+.0686742238595345)-n*(.0003361971776183937*n+.7430659151342254),e[a++]=255+r*(.00013596372813588848*r+.000924537132573585*t+.00010567359618683593*i+.0004791864687436512*n-.3109689587515875)+t*(-.00023545346108370344*t+.0002702845253534714*i+.0020200308977307156*n-.7488052167015494)+i*(6834815998235662e-20*i+.00015168452363460973*n-.09751927774728933)-n*(.0003189131175883281*n+.7364883807733168),e[a++]=255+r*(13598650411385307e-21*r+.00012423956175490851*t+.0004751985097583589*i-36729317476630422e-22*n-.05562186980264034)+t*(.00016141380598724676*t+.0009692239130725186*i+.0007782692450036253*n-.44015232367526463)+i*(5.068882914068769e-7*i+.0017778369011375071*n-.7591454649749609)-n*(.0003435319965105553*n+.7063770186160144);return e.subarray(0,a)},getData:function(e){var t=e.width,i=e.height,n=e.forceRGB,a=e.isSourcePDF;if(this.p>4)throw new r("Unsupported color mode");var o=this.Y(t,i,a);if(1===this.p&&n){for(var f=o.length,s=new Uint8ClampedArray(3*f),h=0,l=0;l<f;l++){var u=o[l];s[h++]=u,s[h++]=u,s[h++]=u}return s}if(3===this.p&&this.f)return this.z(o);if(4===this.p){if(this.f)return n?this.O(o):this.r(o);if(n)return this.U(o)}return o}},u}();function i(e,r){return e[r]<<8|e[r+1]}e.JpegDecoder=t}(),e.encodeImage=function(r,t,i,n){var a={t256:[t],t257:[i],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[i],t279:[t*i*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(n)for(var o in n)a[o]=n[o];var f=new Uint8Array(e.encode([a])),s=new Uint8Array(r),h=new Uint8Array(1e3+t*i*4);for(o=0;o<f.length;o++)h[o]=f[o];for(o=0;o<s.length;o++)h[1e3+o]=s[o];return h.buffer},e.encode=function(r){var t=new Uint8Array(2e4),i=4,n=e._binBE;t[0]=t[1]=77,n.writeUshort(t,2,42);var a=8;n.writeUint(t,i,a),i+=4;for(var o=0;o<r.length;o++){var f=e._writeIFD(n,e._types.basic,t,a,r[o]);a=f[1],o<r.length-1&&(0!=(3&a)&&(a+=4-(3&a)),n.writeUint(t,f[0],a))}return t.slice(0,a).buffer},e.decode=function(r,i){null==i&&(i={parseMN:!0,debug:!1});var n=new Uint8Array(r),a=0,o=e._binBE.readASCII(n,a,2);a+=2;var f="II"==o?e._binLE:e._binBE;f.readUshort(n,a),a+=2;var s=f.readUint(n,a);a+=4;for(var h=[];;){var l=f.readUshort(n,s),u=f.readUshort(n,s+4);if(0!=l&&(u<1||13<u)){t("error in TIFF");break}if(e._readIFD(f,n,s,h,0,i),0==(s=f.readUint(n,s+2+12*l)))break}return h},e.decodeImage=function(r,i,n){if(!i.data){var a=new Uint8Array(r),o=e._binBE.readASCII(a,0,2);if(null!=i.t256){i.isLE="II"==o,i.width=i.t256[0],i.height=i.t257[0];var f=i.t259?i.t259[0]:1,s=i.t266?i.t266[0]:1;i.t284&&2==i.t284[0]&&t("PlanarConfiguration 2 should not be used!"),7==f&&i.t258&&i.t258.length>3&&(i.t258=i.t258.slice(0,3));var h=i.t277?i.t277[0]:1,l=(i.t258?i.t258[0]:1)*h;1==f&&null!=i.t279&&i.t278&&32803==i.t262[0]&&(l=Math.round(8*i.t279[0]/(i.width*i.t278[0]))),i.t50885&&4==i.t50885[0]&&(l=3*i.t258[0]);var u=8*Math.ceil(i.width*l/8),d=i.t273;(null==d||i.t322)&&(d=i.t324);var c=i.t279;1==f&&1==d.length&&(c=[i.height*(u>>>3)]),(null==c||i.t322)&&(c=i.t325);var v=new Uint8Array(i.height*(u>>>3)),g=0;if(null!=i.t322){var m=i.t322[0],w=i.t323[0],p=Math.floor((i.width+m-1)/m),b=Math.floor((i.height+w-1)/w),y=new Uint8Array(0|Math.ceil(m*w*l/8));console.log("====",p,b);for(var _=0;_<b;_++)for(var I=0;I<p;I++){var A=_*p+I;y.fill(0),e.decode._decompress(i,n,a,d[A],c[A],f,y,0,s,m,w),6==f?v=y:e._copyTile(y,0|Math.ceil(m*l/8),w,v,0|Math.ceil(i.width*l/8),i.height,0|Math.ceil(I*m*l/8),_*w)}g=8*v.length}else{if(null==d)return;var U=i.t278?i.t278[0]:i.height;for(U=Math.min(U,i.height),A=0;A<d.length;A++)e.decode._decompress(i,n,a,d[A],c[A],f,v,0|Math.ceil(g/8),s,i.width,U),g+=u*U;g=Math.min(g,8*v.length)}i.data=new Uint8Array(v.buffer,0,0|Math.ceil(g/8))}}},e.decode._decompress=function(r,i,n,a,o,f,s,h,l,u,d){if(r.t271&&"Panasonic"==r.t271[0]&&r.t45&&6==r.t45[0]&&(f=34316),1==f)for(var c=0;c<o;c++)s[h+c]=n[a+c];else if(2==f)e.decode._decodeG2(n,a,o,s,h,u,l);else if(3==f)e.decode._decodeG3(n,a,o,s,h,u,l,!!r.t292&&1==(1&r.t292[0]));else if(4==f)e.decode._decodeG4(n,a,o,s,h,u,l);else if(5==f)e.decode._decodeLZW(n,a,o,s,h,8);else if(6==f)e.decode._decodeOldJPEG(r,n,a,o,s,h);else if(7==f||34892==f)e.decode._decodeNewJPEG(r,n,a,o,s,h);else if(8==f||32946==f){var v=new Uint8Array(n.buffer,a+2,o-6),g=e._inflateRaw(v);h+g.length<=s.length&&s.set(g,h)}else 9==f?e.decode._decodeVC5(n,a,o,s,h,r.t33422):32767==f?e.decode._decodeARW(r,n,a,o,s,h):32773==f?e.decode._decodePackBits(n,a,o,s,h):32809==f?e.decode._decodeThunder(n,a,o,s,h):34316==f?e.decode._decodePanasonic(r,n,a,o,s,h):34713==f?e.decode._decodeNikon(r,i,n,a,o,s,h):34676==f?e.decode._decodeLogLuv32(r,n,a,o,s,h):t("Unknown compression",f);var m=r.t258?Math.min(32,r.t258[0]):1,w=r.t277?r.t277[0]:1,p=m*w>>>3,b=Math.ceil(m*w*u/8);if(16==m&&!r.isLE&&null==r.t33422)for(var y=0;y<d;y++)for(var _=h+y*b,I=1;I<b;I+=2){var A=s[_+I];s[_+I]=s[_+I-1],s[_+I-1]=A}if(r.t317&&2==r.t317[0])for(y=0;y<d;y++){var U=h+y*b;if(16==m)for(c=p;c<b;c+=2){var E=(s[U+c+1]<<8|s[U+c])+(s[U+c-p+1]<<8|s[U+c-p]);s[U+c]=255&E,s[U+c+1]=E>>>8&255}else if(3==w)for(c=3;c<b;c+=3)s[U+c]=s[U+c]+s[U+c-3]&255,s[U+c+1]=s[U+c+1]+s[U+c-2]&255,s[U+c+2]=s[U+c+2]+s[U+c-1]&255;else for(c=p;c<b;c++)s[U+c]=s[U+c]+s[U+c-p]&255}},e.decode._decodePanasonic=function(e,r,t,i,n,a){var o,f,s,h,l,u,d,c,v=r.buffer,g=e.t2[0],m=e.t3[0],w=e.t10[0],p=e.t45[0],b=0,y=0,_=0,I=0,A=6==p?new Uint32Array(18):new Uint8Array(16),U=[0,0],E=[0,0],B=0,D=new Uint8Array(16384),M=new Uint16Array(n.buffer);function P(e){if(0==_){var r=new Uint8Array(v,t+y+8184,8200),i=new Uint8Array(v,t+y,8184);D.set(r),D.set(i,r.length),y+=16384}if(5!=p)return(D[I=(_=_-e&131071)>>3^16368]|D[I+1]<<8)>>(7&_)&~(-1<<e);for(o=0;o<16;o++)A[o]=D[_++],_&=16383}function C(e){return D[_+15-e]}function k(){U[0]=0,U[1]=0,E[0]=0,E[1]=0}if(7==p)throw p;if(6==p){var x=12==w,F=x?function(){A[0]=C(0)<<4|C(1)>>4,A[1]=4095&((15&C(1))<<8|C(2)),A[2]=C(3)>>6&3,A[3]=(63&C(3))<<2|C(4)>>6,A[4]=(63&C(4))<<2|C(5)>>6,A[5]=(63&C(5))<<2|C(6)>>6,A[6]=C(6)>>4&3,A[7]=(15&C(6))<<4|C(7)>>4,A[8]=(15&C(7))<<4|C(8)>>4,A[9]=(15&C(8))<<4|C(9)>>4,A[10]=C(9)>>2&3,A[11]=(3&C(9))<<6|C(10)>>2,A[12]=(3&C(10))<<6|C(11)>>2,A[13]=(3&C(11))<<6|C(12)>>2,A[14]=3&C(12),A[15]=C(13),A[16]=C(14),A[17]=C(15),_+=16,I=0}:function(){A[0]=C(0)<<6|C(1)>>2,A[1]=16383&((3&C(1))<<12|C(2)<<4|C(3)>>4),A[2]=C(3)>>2&3,A[3]=(3&C(3))<<8|C(4),A[4]=C(5)<<2|C(6)>>6,A[5]=(63&C(6))<<4|C(7)>>4,A[6]=C(7)>>2&3,A[7]=(3&C(7))<<8|C(8),A[8]=C(9)<<2&1020|C(10)>>6,A[9]=1023&(C(10)<<4|C(11)>>4),A[10]=C(11)>>2&3,A[11]=(3&C(11))<<8|C(12),A[12]=1023&(C(13)<<2&1020|C(14)>>6),A[13]=1023&(C(14)<<4|C(15)>>4),_+=16,I=0},T=x?14:11,S=x?128:512,L=x?2048:8192,H=x?16383:65535,O=x?4095:16383,N=g/T,G=16*N,R=x?18:14;for(u=0;u<m-15;u+=16){var J=Math.min(16,m-u),W=G*J;for(D=new Uint8Array(v,t+b,W),_=0,b+=W,c=0,d=0;c<J;c++,d=0){B=(u+c)*g;for(var j=0;j<N;j++)for(F(),k(),s=0,l=0,o=0;o<T;o++){if(h=1&o,o%3==2){var z=I<R?A[I++]:0;3==z&&(z=4),l=S<<z,s=1<<z}var $=I<R?A[I++]:0;U[h]?($*=s,l<L&&E[h]>l&&($+=E[h]-l),E[h]=$):(U[h]=$,$?E[h]=$:$=E[h]),M[B+d++]=$-15<=H?$-15&H:$+2147483633>>31&O}}}}else if(5==p){var q=12==w?10:9;for(u=0;u<m;u++)for(d=0;d<g;d+=q)P(0),12==w?(M[B++]=((15&A[1])<<8)+A[0],M[B++]=16*A[2]+(A[1]>>4),M[B++]=((15&A[4])<<8)+A[3],M[B++]=16*A[5]+(A[4]>>4),M[B++]=((15&A[7])<<8)+A[6],M[B++]=16*A[8]+(A[7]>>4),M[B++]=((15&A[10])<<8)+A[9],M[B++]=16*A[11]+(A[10]>>4),M[B++]=((15&A[13])<<8)+A[12],M[B++]=16*A[14]+(A[13]>>4)):14==w&&(M[B++]=A[0]+((63&A[1])<<8),M[B++]=(A[1]>>6)+4*A[2]+((15&A[3])<<10),M[B++]=(A[3]>>4)+16*A[4]+((3&A[5])<<12),M[B++]=((252&A[5])>>2)+(A[6]<<6),M[B++]=A[7]+((63&A[8])<<8),M[B++]=(A[8]>>6)+4*A[9]+((15&A[10])<<10),M[B++]=(A[10]>>4)+16*A[11]+((3&A[12])<<12),M[B++]=((252&A[12])>>2)+(A[13]<<6),M[B++]=A[14]+((63&A[15])<<8))}else{if(4!=p)throw p;for(u=0;u<m;u++)for(d=0;d<g;d++)h=1&(o=d%14),0==o&&k(),o%3==2&&(s=4>>3-P(2)),E[h]?0!=(f=P(8))&&(U[h]-=128<<s,(U[h]<0||4==s)&&(U[h]&=~(-1<<s)),U[h]+=f<<s):(E[h]=P(8),(E[h]||o>11)&&(U[h]=E[h]<<4|P(4))),M[B++]=U[1&d]}},e.decode._decodeVC5=function(){var r,t,i,n=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],a=[3,3,3,3,2,2,2,1,1,1];function o(e){var r=e[1],t=e[0][r>>>3]>>>7-(7&r)&1;return e[1]++,t}function f(e,t){if(null==r){r={};for(var i=0;i<n.length;i+=4)r[n[i+1]]=n.slice(i,i+4)}for(var a=o(e),f=r[a];null==f;)a=a<<1|o(e),f=r[a];var s=f[3];0!=s&&(s=0==o(e)?s:-s),t[0]=f[2],t[1]=s}function s(e,r){for(var t=0;t<r;t++)1==(1&e)&&e++,e>>>=1;return e}function h(e,r){return e>>r}function l(e,r,t,i,n,a){r[t]=h(h(11*e[n]-4*e[n+a]+e[n+a+a]+4,3)+e[i],1),r[t+a]=h(h(5*e[n]+4*e[n+a]-e[n+a+a]+4,3)-e[i],1)}function u(e,r,t,i,n,a){var o=e[n-a]-e[n+a],f=e[n],s=e[i];r[t]=h(h(o+4,3)+f+s,1),r[t+a]=h(h(4-o,3)+f-s,1)}function d(e,r,t,i,n,a){r[t]=h(h(5*e[n]+4*e[n-a]-e[n-a-a]+4,3)+e[i],1),r[t+a]=h(h(11*e[n]-4*e[n-a]+e[n-a-a]+4,3)-e[i],1)}function c(e){return i[e=e<0?0:e>4095?4095:e]>>>2}return function(r,n,o,h,v,g){h=new Uint16Array(h.buffer);var m,w,p,b,y,_,I,A,U=Date.now(),E=e._binBE,B=n+o;n+=4;for(var D=1==g[0];n<B;){var M=E.readShort(r,n),P=E.readUshort(r,n+2);if(n+=4,12==M)L=P;else if(20==M)m=P;else if(21==M)w=P;else if(48==M)p=P;else if(53==M)b=P;else if(35==M);else if(62==M)y=P;else if(101==M);else if(109==M)_=P;else if(84==M);else if(106==M);else if(107==M);else if(108==M);else if(102==M);else if(104==M)te=P;else if(105==M);else{var C=M<0?-M:M,k=65280&C,x=0;if(24576&C&&(8192&C?(x=65535&P,x+=(255&C)<<16):x=65535&P),24576==(24576&C)){if(null==I){I=[];for(var F=0;F<4;F++)I[F]=new Int16Array((m>>>1)*(w>>>1));for(A=new Int16Array((m>>>1)*(w>>>1)),t=new Int16Array(1024),F=0;F<1024;F++){var T=F-512,S=Math.abs(T),L=Math.floor(768*S*S*S/16581375)+S;t[F]=Math.sign(T)*L}for(i=new Uint16Array(4096),F=0;F<4096;F++){var H=F,O=65535*(Math.pow(113,H/4095)-1)/112;i[F]=Math.min(O,65535)}}var N=I[y],G=s(m,1+a[p]),R=s(w,1+a[p]);if(0==p)for(var J=0;J<R;J++)for(var W=0;W<G;W++){var j=n+2*(J*G+W);N[J*(m>>>1)+W]=r[j]<<8|r[j+1]}else{var z=[r,8*n],$=[],q=0,X=G*R,Y=[0,0],Q=0;for(P=0;q<X;)for(f(z,Y),Q=Y[0],P=Y[1];Q>0;)$[q++]=P,Q--;var V=(p-1)%3,Z=1!=V?G:0,K=0!=V?R:0;for(J=0;J<R;J++){var ee=(J+K)*(m>>>1)+Z,re=J*G;for(W=0;W<G;W++)N[ee+W]=t[$[re+W]+512]*b}if(2==V){var te=m>>>1,ie=2*G,ne=2*R;for(J=0;J<R;J++)for(W=0;W<ie;W++){F=2*J*te+W;var ae=R*te+(fe=J*te+W);0==J?l(N,A,F,ae,fe,te):J==R-1?d(N,A,F,ae,fe,te):u(N,A,F,ae,fe,te)}var oe=N;for(N=A,A=oe,J=0;J<ne;J++)for(W=0;W<G;W++){var fe;F=J*te+2*W,ae=G+(fe=J*te+W),0==W?l(N,A,F,ae,fe,1):W==G-1?d(N,A,F,ae,fe,1):u(N,A,F,ae,fe,1)}oe=N,N=A,A=oe;for(var se=[],he=2-~~((p-1)/3),le=0;le<3;le++)se[le]=_>>14-2*le&3;var ue=se[he];if(0!=ue)for(J=0;J<ne;J++)for(W=0;W<ie;W++)N[F=J*te+W]=N[F]<<ue}}if(9==p&&3==y){var de=I[0],ce=I[1],ve=I[2],ge=I[3];for(J=0;J<w;J+=2)for(W=0;W<m;W+=2){var me=J*m+W,we=de[j=(J>>>1)*(m>>>1)+(W>>>1)],pe=ce[j]-2048,be=ve[j]-2048,ye=ge[j]-2048,_e=(pe<<1)+we,Ie=(be<<1)+we,Ae=we+ye,Ue=we-ye;D?(h[me]=c(Ae),h[me+1]=c(Ie),h[me+m]=c(_e),h[me+m+1]=c(Ue)):(h[me]=c(_e),h[me+1]=c(Ae),h[me+m]=c(Ue),h[me+m+1]=c(Ie))}}n+=4*x}else if(16388==C)n+=4*x;else if(8192!=k&&8448!=k&&9216!=k)throw C.toString(16)}}console.log(Date.now()-U)}}(),e.decode._decodeLogLuv32=function(e,r,t,i,n,a){for(var o=e.width,f=4*o,s=0,h=new Uint8Array(f);s<i;){for(var l=0;l<f;){var u=r[t+s];if(s++,u<128){for(var d=0;d<u;d++)h[l+d]=r[t+s+d];l+=u,s+=u}else{for(u-=126,d=0;d<u;d++)h[l+d]=r[t+s];l+=u,s++}}for(var c=0;c<o;c++)n[a+0]=h[c],n[a+1]=h[c+o],n[a+2]=h[c+2*o],n[a+4]=h[c+3*o],a+=6}},e.decode._ljpeg_diff=function(r,t,i){var n,a,o=e.decode._getbithuff;return n=o(r,t,i[0],i),0==((a=o(r,t,n,0))&1<<n-1)&&(a-=(1<<n)-1),a},e.decode._decodeARW=function(r,t,i,n,a,o){var f=r.t256[0],s=r.t257[0],h=r.t258[0],l=r.isLE?e._binLE:e._binBE;if(f*s==n||f*s*1.5==n)if(f*s*1.5!=n){var u,d,c,v,g,m,w,p,b=new Uint16Array(16),y=new Uint8Array(f+1);for(M=0;M<s;M++){for(var _=0;_<f;_++)y[_]=t[i++];for(p=0,D=0;D<f-30;p+=16){for(d=2047&(u=l.readUint(y,p)),c=2047&u>>>11,v=15&u>>>22,g=15&u>>>26,m=0;m<4&&128<<m<=d-c;m++);for(w=30,I=0;I<16;I++)I==v?b[I]=d:I==g?b[I]=c:(b[I]=((l.readUshort(y,p+(w>>3))>>>(7&w)&127)<<m)+c,b[I]>2047&&(b[I]=2047),w+=7);for(I=0;I<16;I++,D+=2)L=b[I]<<1,e.decode._putsF(a,(M*f+D)*h,L<<16-h);D-=1&D?1:31}}}else for(var I=0;I<n;I+=3){var A=t[i+I+0],U=t[i+I+1],E=t[i+I+2];a[o+I]=U<<4|A>>>4,a[o+I+1]=A<<4|E>>>4,a[o+I+2]=E<<4|U>>>4}else{s+=8;var B,D,M,P=[i,0,0,0],C=new Uint16Array(32770),k=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],x=0,F=e.decode._ljpeg_diff;for(C[0]=15,B=I=0;I<18;I++)for(var T=32768>>>(k[I]>>>8),S=0;S<T;S++)C[++B]=k[I];for(D=f;D--;)for(M=0;M<s+1;M+=2)if(M==s&&(M=1),x+=F(t,P,C),M<s){var L=4095&x;e.decode._putsF(a,(M*f+D)*h,L<<16-h)}}},e.decode._decodeNikon=function(r,t,i,n,a,o,f){var s=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],h=r.t256[0],l=r.t257[0],u=r.t258[0],d=0,c=0,v=e.decode._make_decoder,g=e.decode._getbithuff,m=t[0].exifIFD.makerNote,w=m.t150?m.t150:m.t140,p=0,b=w[p++],y=w[p++];73!=b&&88!=y||(p+=2110),70==b&&(d=2),14==u&&(d+=3);for(var _=[[0,0],[0,0]],I=r.isLE?e._binLE:e._binBE,A=0;A<2;A++)for(var U=0;U<2;U++)_[A][U]=I.readShort(w,p),p+=2;var E,B,D,M,P,C=1<<u&32767,k=0,x=I.readShort(w,p);p+=2,x>1&&(k=Math.floor(C/(x-1))),68==b&&32==y&&k>0&&(c=I.readShort(w,562));var F=[0,0],T=v(s[d]),S=[n,0,0,0];for(E=0;E<l;E++)for(c&&E==c&&(T=v(s[d+1])),B=0;B<h;B++){A=g(i,S,T[0],T),0==((P=1+(g(i,S,(D=15&A)-(M=A>>>4),0)<<1)<<M>>>1)&1<<D-1)&&(P-=(1<<D)-(0==M?1:0)),B<2?F[B]=_[1&E][B]+=P:F[1&B]+=P;var L=Math.min(Math.max(F[1&B],0),(1<<u)-1),H=(E*h+B)*u;e.decode._putsF(o,H,L<<16-u)}},e.decode._putsF=function(e,r,t){t<<=8-(7&r);var i=r>>>3;e[i]|=t>>>16,e[i+1]|=t>>>8,e[i+2]|=t},e.decode._getbithuff=function(r,t,i,n){e.decode._get_byte;var a,o=t[0],f=t[1],s=t[2],h=t[3];if(0==i||s<0)return 0;for(;!h&&s<i&&-1!=(a=r[o++])&&!(h=0);)f=(f<<8)+a,s+=8;if(a=f<<32-s>>>32-i,n?(s-=n[a+1]>>>8,a=255&n[a+1]):s-=i,s<0)throw"e";return t[0]=o,t[1]=f,t[2]=s,t[3]=h,a},e.decode._make_decoder=function(e){var r,t,i,n,a,o=[];for(r=16;0!=r&&!e[r];r--);var f=17;for(o[0]=r,i=t=1;t<=r;t++)for(n=0;n<e[t];n++,++f)for(a=0;a<1<<r-t;a++)i<=1<<r&&(o[i++]=t<<8|e[f]);return o},e.decode._decodeNewJPEG=function(r,t,i,n,a,o){n=Math.min(n,t.length-i);var f=r.t347,s=f?f.length:0,h=new Uint8Array(s+n);if(f){for(var l=0,u=0;u<s-1&&(255!=f[u]||217!=f[u+1]);u++)h[l++]=f[u];var d=t[i],c=t[i+1];for(255==d&&216==c||(h[l++]=d,h[l++]=c),u=2;u<n;u++)h[l++]=t[i+u]}else for(u=0;u<n;u++)h[u]=t[i+u];if(32803==r.t262[0]||7==r.t259[0]&&34892==r.t262[0]){var v=r.t258[0],g=e.LosslessJpegDecode(h),m=g.length;if(16==v)if(r.isLE)for(u=0;u<m;u++)a[o+(u<<1)]=255&g[u],a[o+(u<<1)+1]=g[u]>>>8;else for(u=0;u<m;u++)a[o+(u<<1)]=g[u]>>>8,a[o+(u<<1)+1]=255&g[u];else if(14==v||12==v||10==v){var w=16-v;for(u=0;u<m;u++)e.decode._putsF(a,u*v,g[u]<<w)}else{if(8!=v)throw new Error("unsupported bit depth "+v);for(u=0;u<m;u++)a[o+u]=g[u]}}else{var p=new e.JpegDecoder;p.parse(h);var b=p.getData({width:p.width,height:p.height,forceRGB:!0,isSourcePDF:!1});for(u=0;u<b.length;u++)a[o+u]=b[u]}6==r.t262[0]&&(r.t262[0]=2)},e.decode._decodeOldJPEGInit=function(e,r,i,n){var a,o,f,s,h,l=216,u=0,d=0,c=!1,v=e.t513,g=v?v[0]:0,m=e.t514,w=m?m[0]:0,p=e.t324||e.t273||v,b=e.t530,y=0,_=0,I=e.t277?e.t277[0]:1,A=e.t515;if(p&&(d=p[0],c=p.length>1),!c){if(255==r[i]&&r[i+1]==l)return{jpegOffset:i};if(null!=v&&(255==r[i+g]&&r[i+g+1]==l?u=i+g:t("JPEGInterchangeFormat does not point to SOI"),null==m?t("JPEGInterchangeFormatLength field is missing"):(g>=d||g+w<=d)&&t("JPEGInterchangeFormatLength field value is invalid"),null!=u))return{jpegOffset:u}}if(null!=b&&(y=b[0],_=b[1]),null!=v&&null!=m)if(w>=2&&g+w<=d){for(a=255==r[i+g+w-2]&&r[i+g+w-1]==l?new Uint8Array(w-2):new Uint8Array(w),f=0;f<a.length;f++)a[f]=r[i+g+f];t("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else t("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==a){var U=0,E=[];E[U++]=255,E[U++]=l;var B=e.t519;if(null==B)throw new Error("JPEGQTables tag is missing");for(f=0;f<B.length;f++)for(E[U++]=255,E[U++]=219,E[U++]=0,E[U++]=67,E[U++]=f,s=0;s<64;s++)E[U++]=r[i+B[f]+s];for(h=0;h<2;h++){var D=e[0==h?"t520":"t521"];if(null==D)throw new Error((0==h?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(f=0;f<D.length;f++){E[U++]=255,E[U++]=196;var M=19;for(s=0;s<16;s++)M+=r[i+D[f]+s];for(E[U++]=M>>>8,E[U++]=255&M,E[U++]=f|h<<4,s=0;s<16;s++)E[U++]=r[i+D[f]+s];for(s=0;s<M;s++)E[U++]=r[i+D[f]+16+s]}}if(E[U++]=255,E[U++]=192,E[U++]=0,E[U++]=8+3*I,E[U++]=8,E[U++]=e.height>>>8&255,E[U++]=255&e.height,E[U++]=e.width>>>8&255,E[U++]=255&e.width,E[U++]=I,1==I)E[U++]=1,E[U++]=17,E[U++]=0;else for(f=0;f<3;f++)E[U++]=f+1,E[U++]=0!=f?17:(15&y)<<4|15&_,E[U++]=f;null!=A&&0!=A[0]&&(E[U++]=255,E[U++]=221,E[U++]=0,E[U++]=4,E[U++]=A[0]>>>8&255,E[U++]=255&A[0]),a=new Uint8Array(E)}var P=-1;for(f=0;f<a.length-1;){if(255==a[f]&&192==a[f+1]){P=f;break}f++}if(-1==P){var C=new Uint8Array(a.length+10+3*I);C.set(a);var k=a.length;if(P=a.length,(a=C)[k++]=255,a[k++]=192,a[k++]=0,a[k++]=8+3*I,a[k++]=8,a[k++]=e.height>>>8&255,a[k++]=255&e.height,a[k++]=e.width>>>8&255,a[k++]=255&e.width,a[k++]=I,1==I)a[k++]=1,a[k++]=17,a[k++]=0;else for(f=0;f<3;f++)a[k++]=f+1,a[k++]=0!=f?17:(15&y)<<4|15&_,a[k++]=f}if(255==r[d]&&218==r[d+1]){var x=r[d+2]<<8|r[d+3];for((o=new Uint8Array(x+2))[0]=r[d],o[1]=r[d+1],o[2]=r[d+2],o[3]=r[d+3],f=0;f<x-2;f++)o[f+4]=r[d+f+4]}else{var F=0;if((o=new Uint8Array(8+2*I))[F++]=255,o[F++]=218,o[F++]=0,o[F++]=6+2*I,o[F++]=I,1==I)o[F++]=1,o[F++]=0;else for(f=0;f<3;f++)o[F++]=f+1,o[F++]=f<<4|f;o[F++]=0,o[F++]=63,o[F++]=0}return{jpegOffset:i,tables:a,sosMarker:o,sofPosition:P}},e.decode._decodeOldJPEG=function(r,t,i,n,a,o){var f,s,h,l,u=e.decode._decodeOldJPEGInit(r,t,i,n);if(null!=u.jpegOffset)for(f=i+n-u.jpegOffset,h=new Uint8Array(f),v=0;v<f;v++)h[v]=t[u.jpegOffset+v];else{for(s=u.tables.length,(h=new Uint8Array(s+u.sosMarker.length+n+2)).set(u.tables),l=s,h[u.sofPosition+5]=r.height>>>8&255,h[u.sofPosition+6]=255&r.height,h[u.sofPosition+7]=r.width>>>8&255,h[u.sofPosition+8]=255&r.width,255==t[i]&&t[i+1]==SOS||(h.set(u.sosMarker,l),l+=sosMarker.length),v=0;v<n;v++)h[l++]=t[i+v];h[l++]=255,h[l++]=EOI}var d=new e.JpegDecoder;d.parse(h);for(var c=d.getData({width:d.width,height:d.height,forceRGB:!0,isSourcePDF:!1}),v=0;v<c.length;v++)a[o+v]=c[v];r.t262&&6==r.t262[0]&&(r.t262[0]=2)},e.decode._decodePackBits=function(e,r,t,i,n){for(var a=new Int8Array(e.buffer),o=new Int8Array(i.buffer),f=r+t;r<f;){var s=a[r];if(r++,s>=0&&s<128)for(var h=0;h<s+1;h++)o[n]=a[r],n++,r++;if(s>=-127&&s<0){for(h=0;h<1-s;h++)o[n]=a[r],n++;r++}}return n},e.decode._decodeThunder=function(e,r,t,i,n){for(var a=[0,1,0,-1],o=[0,1,2,3,0,-3,-2,-1],f=r+t,s=2*n,h=0;r<f;){var l=e[r],u=l>>>6,d=63&l;if(r++,3==u&&(h=15&d,i[s>>>1]|=h<<4*(1-s&1),s++),0==u)for(var c=0;c<d;c++)i[s>>>1]|=h<<4*(1-s&1),s++;if(2==u)for(c=0;c<2;c++)4!=(v=d>>>3*(1-c)&7)&&(h+=o[v],i[s>>>1]|=h<<4*(1-s&1),s++);if(1==u)for(c=0;c<3;c++){var v;2!=(v=d>>>2*(2-c)&3)&&(h+=a[v],i[s>>>1]|=h<<4*(1-s&1),s++)}}},e.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},e.decode._lens=function(){var e=function(e,r,t,i){for(var n=0;n<r.length;n++)e[r[n]]=t+n*i},r="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",t="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",i="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",n="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",a="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";r=r.split(","),t=t.split(","),i=i.split(","),n=n.split(","),a=a.split(",");var o={},f={};return e(o,r,0,1),e(o,i,64,64),e(o,a,1792,64),e(f,t,0,1),e(f,n,64,64),e(f,a,1792,64),[o,f]}(),e.decode._decodeG4=function(r,t,i,n,a,o,f){for(var s=e.decode,h=t<<3,l=0,u="",d=[],c=[],v=0;v<o;v++)c.push(0);c=s._makeDiff(c);for(var g=0,m=0,w=0,p=0,b=0,y=0,_="",I=0,A=8*Math.ceil(o/8);h>>>3<t+i;){w=s._findDiff(c,g+(0==g?0:1),1-b),p=s._findDiff(c,w,b);var U=0;if(1==f&&(U=r[h>>>3]>>>7-(7&h)&1),2==f&&(U=r[h>>>3]>>>(7&h)&1),h++,u+=U,"H"==_){if(null!=s._lens[b][u]){var E=s._lens[b][u];u="",l+=E,E<64&&(s._addNtimes(d,l,b),g+=l,b=1-b,l=0,0==--I&&(_=""))}}else"0001"==u&&(u="",s._addNtimes(d,p-g,b),g=p),"001"==u&&(u="",_="H",I=2),null!=s._dmap[u]&&(m=w+s._dmap[u],s._addNtimes(d,m-g,b),g=m,u="",b=1-b);d.length==o&&""==_&&(s._writeBits(d,n,8*a+y*A),b=0,y++,g=0,c=s._makeDiff(d),d=[])}},e.decode._findDiff=function(e,r,t){for(var i=0;i<e.length;i+=2)if(e[i]>=r&&e[i+1]==t)return e[i]},e.decode._makeDiff=function(e){var r=[];1==e[0]&&r.push(0,1);for(var t=1;t<e.length;t++)e[t-1]!=e[t]&&r.push(t,e[t]);return r.push(e.length,0,e.length,1),r},e.decode._decodeG2=function(r,t,i,n,a,o,f){for(var s=e.decode,h=t<<3,l=0,u="",d=[],c=0,v=0,g=8*Math.ceil(o/8);h>>>3<t+i;){var m=0;1==f&&(m=r[h>>>3]>>>7-(7&h)&1),2==f&&(m=r[h>>>3]>>>(7&h)&1),h++,u+=m,null!=(l=s._lens[c][u])&&(s._addNtimes(d,l,c),u="",l<64&&(c=1-c),d.length==o&&(s._writeBits(d,n,8*a+v*g),d=[],v++,c=0,0!=(7&h)&&(h+=8-(7&h)),l>=64&&(h+=8)))}},e.decode._decodeG3=function(r,t,i,n,a,o,f,s){for(var h=e.decode,l=t<<3,u=0,d="",c=[],v=[],g=0;g<o;g++)c.push(0);for(var m=0,w=0,p=0,b=0,y=0,_=-1,I="",A=0,U=!0,E=8*Math.ceil(o/8);l>>>3<t+i;){p=h._findDiff(v,m+(0==m?0:1),1-y),b=h._findDiff(v,p,y);var B=0;if(1==f&&(B=r[l>>>3]>>>7-(7&l)&1),2==f&&(B=r[l>>>3]>>>(7&l)&1),l++,d+=B,U){if(null!=h._lens[y][d]){var D=h._lens[y][d];d="",u+=D,D<64&&(h._addNtimes(c,u,y),y=1-y,u=0)}}else"H"==I?null!=h._lens[y][d]&&(D=h._lens[y][d],d="",u+=D,D<64&&(h._addNtimes(c,u,y),m+=u,y=1-y,u=0,0==--A&&(I=""))):("0001"==d&&(d="",h._addNtimes(c,b-m,y),m=b),"001"==d&&(d="",I="H",A=2),null!=h._dmap[d]&&(w=p+h._dmap[d],h._addNtimes(c,w-m,y),m=w,d="",y=1-y));d.endsWith("000000000001")&&(_>=0&&h._writeBits(c,n,8*a+_*E),s&&(1==f&&(U=1==(r[l>>>3]>>>7-(7&l)&1)),2==f&&(U=1==(r[l>>>3]>>>(7&l)&1)),l++),d="",y=0,_++,m=0,v=h._makeDiff(c),c=[])}c.length==o&&h._writeBits(c,n,8*a+_*E)},e.decode._addNtimes=function(e,r,t){for(var i=0;i<r;i++)e.push(t)},e.decode._writeBits=function(e,r,t){for(var i=0;i<e.length;i++)r[t+i>>>3]|=e[i]<<7-(t+i&7)},e.decode._decodeLZW=e.decode._decodeLZW=(o=0,f=0,s=0,h=0,l=function(){var e=r>>>3,t=(i[e]<<16|i[e+1]<<8|i[e+2])>>>24-(7&r)-f&(1<<f)-1;return r+=f,t},u=new Uint32Array(16384),d=0,c=function(e){f=e+1,o=h+1},v=function(e){for(var r=e<<2,t=u[r+2],i=a+t-1;65535!=r;)n[i--]=u[r],r=u[r+1];a+=t},g=function(e,r){var t=o<<2,i=e<<2;u[t]=u[3+(r<<2)],u[t+1]=i,u[t+2]=u[i+2]+1,u[t+3]=u[i+3],1+ ++o==1<<f&&12!=f&&f++},function(e,t,f,m,w,p){r=t<<3,i=e,n=m,a=w;var b=t+f<<3,y=0,_=0;for(function(e){if(e!=d){d=e,h=1+(s=1<<e);for(var r=0;r<h+1;r++)u[4*r]=u[4*r+3]=r,u[4*r+1]=65535,u[4*r+2]=1}}(p),c(p);r<b&&(y=l())!=h;){if(y==s){if(c(p),(y=l())==h)break;v(y)}else y<o?(v(y),g(_,y)):(g(_,_),v(o-1));_=y}return a}),e.tags={},e._types=((w=new Array(250)).fill(0),{basic:{main:w=w.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}),e._readIFD=function(r,i,n,a,o,f){var s=r.readUshort(i,n);n+=2;var h={};f.debug&&t("   ".repeat(o),a.length-1,">>>----------------");for(var l=0;l<s;l++){var u=r.readUshort(i,n);n+=2;var d=r.readUshort(i,n);n+=2;var c=r.readUint(i,n);n+=4;var v=r.readUint(i,n);n+=4;var g=[];if(1==d||7==d){var m=c<5?n-4:v;m+c>i.buffer.byteLength&&(c=i.buffer.byteLength-m),g=new Uint8Array(i.buffer,m,c)}if(2==d){var w=c<5?n-4:v,p=i[w],b=Math.max(0,Math.min(c-1,i.length-w));p<128||0==b?g.push(r.readASCII(i,w,b)):g=new Uint8Array(i.buffer,w,b)}if(3==d)for(var y=0;y<c;y++)g.push(r.readUshort(i,(c<3?n-4:v)+2*y));if(4==d||13==d)for(y=0;y<c;y++)g.push(r.readUint(i,(c<2?n-4:v)+4*y));if(5==d||10==d){var _=5==d?r.readUint:r.readInt;for(y=0;y<c;y++)g.push([_(i,v+8*y),_(i,v+8*y+4)])}if(8==d)for(y=0;y<c;y++)g.push(r.readShort(i,(c<3?n-4:v)+2*y));if(9==d)for(y=0;y<c;y++)g.push(r.readInt(i,(c<2?n-4:v)+4*y));if(11==d)for(y=0;y<c;y++)g.push(r.readFloat(i,v+4*y));if(12==d)for(y=0;y<c;y++)g.push(r.readDouble(i,v+8*y));if(0==c||0!=g.length){if(f.debug&&t("   ".repeat(o),u,d,e.tags[u],g),h["t"+u]=g,330==u&&h.t272&&"DSLR-A100"==h.t272[0]);else if(330==u||34665==u||34853==u||50740==u&&r.readUshort(i,r.readUint(g,0))<300||61440==u){var I=50740==u?[r.readUint(g,0)]:g,A=[];for(y=0;y<I.length;y++)e._readIFD(r,i,I[y],A,o+1,f);330==u&&(h.subIFD=A),34665==u&&(h.exifIFD=A[0]),34853==u&&(h.gpsiIFD=A[0]),50740==u&&(h.dngPrvt=A[0]),61440==u&&(h.fujiIFD=A[0])}if(37500==u&&f.parseMN){var U=g;if("Nikon"==r.readASCII(U,0,5))h.makerNote=e.decode(U.slice(10).buffer)[0];else if("OLYMP"==r.readASCII(U,0,5)||"OM SYSTEM"==r.readASCII(U,0,9)){var E=[8208,8224,8240,8256,8272],B=[];e._readIFD(r,U,77==U[1]?16:85==U[5]?12:8,B,o+1,f);var D=h.makerNote=B.pop();for(y=0;y<E.length;y++){var M="t"+E[y];null!=D[M]&&(e._readIFD(r,U,D[M][0],B,o+1,f),D[M]=B.pop())}D.t12288&&(e._readIFD(r,D.t12288,0,B,o+1,f),D.t12288=B.pop())}else r.readUshort(i,v)<300&&r.readUshort(i,v+4)<=12&&(B=[],e._readIFD(r,i,v,B,o+1,f),h.makerNote=B[0])}}else if(t(u,"unknown TIFF tag type: ",d,"num:",c),0==l)return}return a.push(h),f.debug&&t("   ".repeat(o),"<<<---------------"),n},e._writeIFD=function(r,t,i,n,a){var o=Object.keys(a),f=o.length;a.exifIFD&&f--,a.gpsiIFD&&f--,r.writeUshort(i,n,f);for(var s=(n+=2)+12*f+4,h=0;h<o.length;h++){var l=o[h];if("t34665"!=l&&"t34853"!=l){"exifIFD"==l&&(l="t34665"),"gpsiIFD"==l&&(l="t34853");var u=parseInt(l.slice(1)),d=t.main[u];if(null==d&&(d=t.rest[u]),null==d||0==d)throw new Error("unknown type of tag: "+u);var c=a[l];34665==u&&(c=[s],s=e._writeIFD(r,t,i,s,a.exifIFD)[1]),34853==u&&(c=[s],s=e._writeIFD(r,e._types.gps,i,s,a.gpsiIFD)[1]),2==d&&(c=c[0]+"\0");var v=c.length;r.writeUshort(i,n,u),n+=2,r.writeUshort(i,n,d),n+=2,r.writeUint(i,n,v);var g=[-1,1,1,2,4,8,0,1,0,4,8,0,8][d]*v,m=n+=4;if(g>4&&(r.writeUint(i,n,s),m=s),1==d||7==d)for(var w=0;w<v;w++)i[m+w]=c[w];else if(2==d)r.writeASCII(i,m,c);else if(3==d)for(w=0;w<v;w++)r.writeUshort(i,m+2*w,c[w]);else if(4==d)for(w=0;w<v;w++)r.writeUint(i,m+4*w,c[w]);else if(5==d||10==d){var p=5==d?r.writeUint:r.writeInt;for(w=0;w<v;w++){var b=c[w],y=b[0],_=b[1];if(null==y)throw"e";p(i,m+8*w,y),p(i,m+8*w+4,_)}}else if(9==d)for(w=0;w<v;w++)r.writeInt(i,m+4*w,c[w]);else{if(12!=d)throw d;for(w=0;w<v;w++)r.writeDouble(i,m+8*w,c[w])}g>4&&(s+=g+=1&g),n+=4}}return[n,s]},e.toRGBA8=function(e,r){function i(e){return e<.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}var n=e.width,a=e.height,o=n*a,f=e.data,s=new Uint8Array(4*o),h=e.t262?e.t262[0]:2,l=e.t258?Math.min(32,e.t258[0]):1;null==e.t262&&1==l&&(h=0);var u=e.t277?e.t277[0]:e.t258?e.t258.length:[1,1,3,1,1,4,3][h],d=e.t339?e.t339[0]:null;if(1==h&&32==l&&3!=d)throw"e";var c=Math.ceil(u*l*n/8);if(0==h){r=1/256;for(var v=0;v<a;v++){var g=v*c,m=v*n;if(1==l)for(var w=0;w<n;w++){var p=m+w<<2,b=f[g+(w>>3)]>>7-(7&w)&1;s[p]=s[p+1]=s[p+2]=255*(1-b),s[p+3]=255}if(4==l)for(w=0;w<n;w++)p=m+w<<2,b=f[g+(w>>1)]>>4-4*(1&w)&15,s[p]=s[p+1]=s[p+2]=17*(15-b),s[p+3]=255;if(8==l)for(w=0;w<n;w++)p=m+w<<2,b=f[g+w],s[p]=s[p+1]=s[p+2]=255-b,s[p+3]=255;if(16==l)for(w=0;w<n;w++)p=m+w<<2,b=f[(_=g+2*w)+1]<<8|f[_],s[p]=s[p+1]=s[p+2]=Math.min(255,255-~~(b*r)),s[p+3]=255}}else if(1==h){null==r&&(r=1/256);var y=0==(3&f.length)?new Float32Array(f.buffer):null;for(v=0;v<a;v++){if(g=v*c,m=v*n,1==l)for(w=0;w<n;w++)p=m+w<<2,b=f[g+(w>>3)]>>7-(7&w)&1,s[p]=s[p+1]=s[p+2]=255*b,s[p+3]=255;if(2==l)for(w=0;w<n;w++)p=m+w<<2,b=f[g+(w>>2)]>>6-2*(3&w)&3,s[p]=s[p+1]=s[p+2]=85*b,s[p+3]=255;if(8==l)for(w=0;w<n;w++)p=m+w<<2,b=f[g+w*u],s[p]=s[p+1]=s[p+2]=b,s[p+3]=255;if(16==l)for(w=0;w<n;w++)p=m+w<<2,b=f[(_=g+2*w)+1]<<8|f[_],s[p]=s[p+1]=s[p+2]=Math.min(255,~~(b*r)),s[p+3]=255;if(32==l)for(w=0;w<n;w++){var _;p=m+w<<2,b=y[_=(g>>>2)+w],s[p]=s[p+1]=s[p+2]=~~(.5+255*b),s[p+3]=255}}}else if(2==h)if(8==l){if(1==u)for(w=0;w<o;w++)s[4*w]=s[4*w+1]=s[4*w+2]=f[w],s[4*w+3]=255;if(3==u)for(w=0;w<o;w++){var I=3*w;s[p=w<<2]=f[I],s[p+1]=f[I+1],s[p+2]=f[I+2],s[p+3]=255}if(u>=4)for(w=0;w<o;w++)I=w*u,s[p=w<<2]=f[I],s[p+1]=f[I+1],s[p+2]=f[I+2],s[p+3]=f[I+3]}else if(16==l){if(4==u)for(w=0;w<o;w++)I=8*w+1,s[p=w<<2]=f[I],s[p+1]=f[I+2],s[p+2]=f[I+4],s[p+3]=f[I+6];if(3==u)for(w=0;w<o;w++)I=6*w+1,s[p=w<<2]=f[I],s[p+1]=f[I+2],s[p+2]=f[I+4],s[p+3]=255}else{if(32!=l)throw l;var A=new Float32Array(f.buffer),U=0;for(w=0;w<A.length;w++)U=Math.min(U,A[w]);if(U<0)for(w=0;w<f.length;w+=4){var E=f[w];f[w]=f[w+3],f[w+3]=E,E=f[w+1],f[w+1]=f[w+2],f[w+2]=E}var B=[];for(w=0;w<65536;w++)B.push(i(w/65535));for(w=0;w<A.length;w++){var D=Math.max(0,Math.min(1,A[w]));A[w]=B[~~(.5+65535*D)]}if(3==u)for(w=0;w<o;w++)I=3*w,s[p=w<<2]=~~(.5+255*A[I]),s[p+1]=~~(.5+255*A[I+1]),s[p+2]=~~(.5+255*A[I+2]),s[p+3]=255;else{if(4!=u)throw u;for(w=0;w<o;w++)I=4*w,s[p=w<<2]=~~(.5+255*A[I]),s[p+1]=~~(.5+255*A[I+1]),s[p+2]=~~(.5+255*A[I+2]),s[p+3]=~~(.5+255*A[I+3])}}else if(3==h){var M=e.t320,P=1<<l,C=8==l&&u>1&&e.t338&&0!=e.t338[0];for(v=0;v<a;v++)for(var k=0;k<n;k++){p=(w=v*n+k)<<2;var x=0,F=v*c;if(1==l)x=f[F+(k>>>3)]>>>7-(7&k)&1;else if(2==l)x=f[F+(k>>>2)]>>>6-2*(3&k)&3;else if(4==l)x=f[F+(k>>>1)]>>>4-4*(1&k)&15;else{if(8!=l)throw l;x=f[F+k*u]}s[p]=M[x]>>8,s[p+1]=M[P+x]>>8,s[p+2]=M[P+P+x]>>8,s[p+3]=C?f[F+k*u+1]:255}}else if(5==h){var T=u>4?1:0;for(w=0;w<o;w++){p=w<<2;var S=w*u;if(window.UDOC){var L=f[S],H=f[S+1],O=f[S+2],N=f[S+3],G=UDOC.C.cmykToRgb([L*(1/255),H*(1/255),O*(1/255),N*(1/255)]);s[p]=~~(.5+255*G[0]),s[p+1]=~~(.5+255*G[1]),s[p+2]=~~(.5+255*G[2])}else L=255-f[S],H=255-f[S+1],O=255-f[S+2],N=(255-f[S+3])*(1/255),s[p]=~~(L*N+.5),s[p+1]=~~(H*N+.5),s[p+2]=~~(O*N+.5);s[p+3]=255*(1-T)+f[S+4]*T}}else if(6==h&&e.t278){var R=e.t278[0];for(v=0;v<a;v+=R){w=v*n;for(var J=R*n,W=0;W<J;W++){p=4*(w+W),O=f[(S=3*w+4*(W>>>1))+(1&W)];var j=f[S+2]-128,z=f[S+3]-128,$=O+((z>>2)+(z>>3)+(z>>5)),q=O-((j>>2)+(j>>4)+(j>>5))-((z>>1)+(z>>3)+(z>>4)+(z>>5)),X=O+(j+(j>>1)+(j>>2)+(j>>6));s[p]=Math.max(0,Math.min(255,$)),s[p+1]=Math.max(0,Math.min(255,q)),s[p+2]=Math.max(0,Math.min(255,X)),s[p+3]=255}}}else if(32845==h)for(v=0;v<a;v++)for(k=0;k<n;k++){p=4*(v*n+k);var Y=f[1+(S=6*(v*n+k))]<<8|f[S],Q=(Y=Math.pow(2,(Y+.5)/256-64),(f[S+3]+.5)/410),V=(f[S+5]+.5)/410,Z=9*Q/(6*Q-16*V+12),K=4*V/(6*Q-16*V+12),ee=Z*Y/K,re=(1-Z-K)*Y/K;$=2.69*ee-1.276*(O=Y)-.414*re,q=-1.022*ee+1.978*O+.044*re,X=.061*ee-.224*O+1.163*re,s[p]=255*i(Math.min($,1)),s[p+1]=255*i(Math.min(q,1)),s[p+2]=255*i(Math.min(X,1)),s[p+3]=255}else t("Unknown Photometric interpretation: "+h);return s},e.replaceIMG=function(r){null==r&&(r=document.getElementsByTagName("img"));for(var t=["tif","tiff","dng","cr2","nef"],i=0;i<r.length;i++){var n=r[i],a=n.getAttribute("src");if(null!=a){var o=a.split(".").pop().toLowerCase();if(-1!=t.indexOf(o)){var f=new XMLHttpRequest;e._xhrs.push(f),e._imgs.push(n),f.open("GET",a),f.responseType="arraybuffer",f.onload=e._imgLoaded,f.send()}}}},e._xhrs=[],e._imgs=[],e._imgLoaded=function(r){var t=e._xhrs.indexOf(r.target),i=e._imgs[t];e._xhrs.splice(t,1),e._imgs.splice(t,1),i.setAttribute("src",e.bufferToURI(r.target.response))},e.bufferToURI=function(r){var t=e.decode(r),i=t,n=0,a=i[0];t[0].subIFD&&(i=i.concat(t[0].subIFD));for(var o=0;o<i.length;o++){var f=i[o];if(!(null==f.t258||f.t258.length<3)){var s=f.t256*f.t257;s>n&&(n=s,a=f)}}e.decodeImage(r,a,t);var h=e.toRGBA8(a),l=a.width,u=a.height,d=document.createElement("canvas");d.width=l,d.height=u;var c=d.getContext("2d"),v=new ImageData(new Uint8ClampedArray(h.buffer),l,u);return c.putImageData(v,0,0),d.toDataURL()},e._binBE={nextZero:function(e,r){for(;0!=e[r];)r++;return r},readUshort:function(e,r){return e[r]<<8|e[r+1]},readShort:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+1],i[1]=r[t+0],e._binBE.i16[0]},readInt:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+3],i[1]=r[t+2],i[2]=r[t+1],i[3]=r[t+0],e._binBE.i32[0]},readUint:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+3],i[1]=r[t+2],i[2]=r[t+1],i[3]=r[t+0],e._binBE.ui32[0]},readASCII:function(e,r,t){for(var i="",n=0;n<t;n++)i+=String.fromCharCode(e[r+n]);return i},readFloat:function(r,t){for(var i=e._binBE.ui8,n=0;n<4;n++)i[n]=r[t+3-n];return e._binBE.fl32[0]},readDouble:function(r,t){for(var i=e._binBE.ui8,n=0;n<8;n++)i[n]=r[t+7-n];return e._binBE.fl64[0]},writeUshort:function(e,r,t){e[r]=t>>8&255,e[r+1]=255&t},writeInt:function(r,t,i){var n=e._binBE.ui8;e._binBE.i32[0]=i,r[t+3]=n[0],r[t+2]=n[1],r[t+1]=n[2],r[t+0]=n[3]},writeUint:function(e,r,t){e[r]=t>>24&255,e[r+1]=t>>16&255,e[r+2]=t>>8&255,e[r+3]=t>>0&255},writeASCII:function(e,r,t){for(var i=0;i<t.length;i++)e[r+i]=t.charCodeAt(i)},writeDouble:function(r,t,i){e._binBE.fl64[0]=i;for(var n=0;n<8;n++)r[t+n]=e._binBE.ui8[7-n]}},e._binBE.ui8=new Uint8Array(8),e._binBE.i16=new Int16Array(e._binBE.ui8.buffer),e._binBE.i32=new Int32Array(e._binBE.ui8.buffer),e._binBE.ui32=new Uint32Array(e._binBE.ui8.buffer),e._binBE.fl32=new Float32Array(e._binBE.ui8.buffer),e._binBE.fl64=new Float64Array(e._binBE.ui8.buffer),e._binLE={nextZero:e._binBE.nextZero,readUshort:function(e,r){return e[r+1]<<8|e[r]},readShort:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],e._binBE.i16[0]},readInt:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],i[2]=r[t+2],i[3]=r[t+3],e._binBE.i32[0]},readUint:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],i[2]=r[t+2],i[3]=r[t+3],e._binBE.ui32[0]},readASCII:e._binBE.readASCII,readFloat:function(r,t){for(var i=e._binBE.ui8,n=0;n<4;n++)i[n]=r[t+n];return e._binBE.fl32[0]},readDouble:function(r,t){for(var i=e._binBE.ui8,n=0;n<8;n++)i[n]=r[t+n];return e._binBE.fl64[0]},writeUshort:function(e,r,t){e[r]=255&t,e[r+1]=t>>8&255},writeInt:function(r,t,i){var n=e._binBE.ui8;e._binBE.i32[0]=i,r[t+0]=n[0],r[t+1]=n[1],r[t+2]=n[2],r[t+3]=n[3]},writeUint:function(e,r,t){e[r]=t>>>0&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},writeASCII:e._binBE.writeASCII},e._copyTile=function(e,r,t,i,n,a,o,f){for(var s=Math.min(r,n-o),h=Math.min(t,a-f),l=0;l<h;l++)for(var u=(f+l)*n+o,d=l*r,c=0;c<s;c++)i[u+c]=e[d+c]},e._inflateRaw=((m={H:{}}).H.N=function(e,r){var t,i,n=Uint8Array,a=0,o=0,f=0,s=0,h=0,l=0,u=0,d=0,c=0;if(3==e[0]&&0==e[1])return r||new n(0);var v=m.H,g=v.b,w=v.e,p=v.R,b=v.n,y=v.A,_=v.Z,I=v.m,A=null==r;for(A&&(r=new n(e.length>>>2<<5));0==a;)if(a=g(e,c,1),o=g(e,c+1,2),c+=3,0!=o){if(A&&(r=m.H.W(r,d+(1<<17))),1==o&&(t=I.J,i=I.h,l=511,u=31),2==o){f=w(e,c,5)+257,s=w(e,c+5,5)+1,h=w(e,c+10,4)+4,c+=14;for(var U=1,E=0;E<38;E+=2)I.Q[E]=0,I.Q[E+1]=0;for(E=0;E<h;E++){var B=w(e,c+3*E,3);I.Q[1+(I.X[E]<<1)]=B,B>U&&(U=B)}c+=3*h,b(I.Q,U),y(I.Q,U,I.u),t=I.w,i=I.d,c=p(I.u,(1<<U)-1,f+s,e,c,I.v);var D=v.V(I.v,0,f,I.C);l=(1<<D)-1;var M=v.V(I.v,f,s,I.D);u=(1<<M)-1,b(I.C,D),y(I.C,D,t),b(I.D,M),y(I.D,M,i)}for(;;){var P=t[_(e,c)&l];c+=15&P;var C=P>>>4;if(C>>>8==0)r[d++]=C;else{if(256==C)break;var k=d+C-254;if(C>264){var x=I.q[C-257];k=d+(x>>>3)+w(e,c,7&x),c+=7&x}var F=i[_(e,c)&u];c+=15&F;var T=F>>>4,S=I.c[T],L=(S>>>4)+g(e,c,15&S);for(c+=15&S;d<k;)r[d]=r[d++-L],r[d]=r[d++-L],r[d]=r[d++-L],r[d]=r[d++-L];d=k}}}else{0!=(7&c)&&(c+=8-(7&c));var H=4+(c>>>3),O=e[H-4]|e[H-3]<<8;A&&(r=m.H.W(r,d+O)),r.set(new n(e.buffer,e.byteOffset+H,O),d),c=H+O<<3,d+=O}return r.length==d?r:r.slice(0,d)},m.H.W=function(e,r){var t=e.length;if(r<=t)return e;var i=new Uint8Array(t<<1);return i.set(e,0),i},m.H.R=function(e,r,t,i,n,a){for(var o=m.H.e,f=m.H.Z,s=0;s<t;){var h=e[f(i,n)&r];n+=15&h;var l=h>>>4;if(l<=15)a[s]=l,s++;else{var u=0,d=0;16==l?(d=3+o(i,n,2),n+=2,u=a[s-1]):17==l?(d=3+o(i,n,3),n+=3):18==l&&(d=11+o(i,n,7),n+=7);for(var c=s+d;s<c;)a[s]=u,s++}}return n},m.H.V=function(e,r,t,i){for(var n=0,a=0,o=i.length>>>1;a<t;){var f=e[a+r];i[a<<1]=0,i[1+(a<<1)]=f,f>n&&(n=f),a++}for(;a<o;)i[a<<1]=0,i[1+(a<<1)]=0,a++;return n},m.H.n=function(e,r){for(var t,i,n,a,o=m.H.m,f=e.length,s=o.j,h=0;h<=r;h++)s[h]=0;for(h=1;h<f;h+=2)s[e[h]]++;var l=o.K;for(t=0,s[0]=0,i=1;i<=r;i++)t=t+s[i-1]<<1,l[i]=t;for(n=0;n<f;n+=2)0!=(a=e[n+1])&&(e[n]=l[a],l[a]++)},m.H.A=function(e,r,t){for(var i=e.length,n=m.H.m.r,a=0;a<i;a+=2)if(0!=e[a+1])for(var o=a>>1,f=e[a+1],s=o<<4|f,h=r-f,l=e[a]<<h,u=l+(1<<h);l!=u;)t[n[l]>>>15-r]=s,l++},m.H.l=function(e,r){for(var t=m.H.m.r,i=15-r,n=0;n<e.length;n+=2){var a=e[n]<<r-e[n+1];e[n]=t[a]>>>i}},m.H.M=function(e,r,t){t<<=7&r;var i=r>>>3;e[i]|=t,e[i+1]|=t>>>8},m.H.I=function(e,r,t){t<<=7&r;var i=r>>>3;e[i]|=t,e[i+1]|=t>>>8,e[i+2]|=t>>>16},m.H.e=function(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<t)-1},m.H.b=function(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<t)-1},m.H.Z=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},m.H.i=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},m.H.m=function(){var e=Uint16Array,r=Uint32Array;return{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new e(65536),g:new e(32768)}}(),function(){for(var e=m.H.m,r=0;r<32768;r++){var t=r;t=(4278255360&(t=(4042322160&(t=(3435973836&(t=(2863311530&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8,e.r[r]=(t>>>16|t<<16)>>>17}function i(e,r,t){for(;0!=r--;)e.push(0,t)}for(r=0;r<32;r++)e.q[r]=e.S[r]<<3|e.T[r],e.c[r]=e.p[r]<<4|e.z[r];i(e._,144,8),i(e._,112,9),i(e._,24,7),i(e._,8,8),m.H.n(e._,9),m.H.A(e._,9,e.J),m.H.l(e._,9),i(e.$,32,5),m.H.n(e.$,5),m.H.A(e.$,5,e.h),m.H.l(e.$,5),i(e.Q,19,0),i(e.C,286,0),i(e.D,30,0),i(e.v,320,0)}(),m.H.N),e.LosslessJpegDecode=function(){var e,r;function t(){return e[r++]}function i(){return e[r++]<<8|e[r++]}function n(e){for(var r=t(),i=[0,0,0,255],n=[],o=0;o<16;o++)n[o]=t();for(o=0;o<16;o++)for(var f=0;f<n[o];f++)i[a(i,0,o+1,1)+3]=t();var s=new Uint8Array(256);for(e[r]=[new Uint8Array(i),s],o=0;o<256;o++){for(var h=8,l=o,u=0;255==i[u+3]&&0!=h;)u=i[u+(l>>--h&1)];s[o]=u}}function a(e,r,t,i){if(255!=e[r+3])return 0;if(0==t)return r;for(var n=0;n<2;n++){0==e[r+n]&&(e[r+n]=e.length,e.push(0,0,i,255));var o=a(e,e[r+n],t-1,i+1);if(0!=o)return o}return 0}function o(e){for(var r=e.b,t=e.f;r<25&&e.a<e.d;){var i=e.data[e.a++];255!=i||e.c||e.a++,t=t<<8|i,r+=8}if(r<0)throw"e";e.b=r,e.f=t}function f(e,r){return r.b<e&&o(r),r.f>>(r.b-=e)&65535>>16-e}function s(e,r){var t=e[0],i=0,n=255;r.b<16&&o(r);var a=r.f>>r.b-8&255;for(n=t[(i=e[1][a])+3],r.b-=t[i+2];255==n;)n=t[(i=t[i+(r.f>>--r.b&1)])+3];return n}function h(e,r){return e<32768>>16-r&&(e+=1-(1<<r)),e}function l(e,r){var t=s(e,r);return 0==t?0:16==t?-32768:h(f(t,r),t)}function u(e,r,t,i,n,a){for(var o=0,f=0;f<a;f++){for(var s=f*r,h=0;h<r;h+=n){o++;for(var u=0;u<n;u++)e[s+h+u]=l(i[u],t)}if(0!=t.e&&o%t.e==0&&0!=f){for(var d=t.a,c=t.data;255!=c[d]||!(208<=c[d+1]&&c[d+1]<=215);)d--;t.a=d+2,t.f=0,t.b=0}}}function d(e,r){return h(f(e,r),e)}function c(e,r,t,i,n,a,o,f){for(var s=t*o,h=n;h<a;h++)e[h]+=1<<f-1;for(var l=o;l<s;l+=o)for(h=n;h<a;h++)e[l+h]+=e[l+h-o];for(var u=1;u<i;u++){var d=u*s;for(h=n;h<a;h++)e[d+h]+=e[d+h-s];for(l=o;l<s;l+=o)for(h=n;h<a;h++){var c=d+l+h,v=c-s,g=e[c-o],m=0;if(0==r)m=0;else if(1==r)m=g;else if(2==r)m=e[v];else if(3==r)m=e[v-o];else if(4==r)m=g+(e[v]-e[v-o]);else if(5==r)m=g+(e[v]-e[v-o]>>>1);else if(6==r)m=e[v]+(g-e[v-o]>>>1);else{if(7!=r)throw r;m=g+e[v]>>>1}e[c]+=m}}}return function(a){if(e=a,r=0,65496!=i())throw"e";for(var o=[],f=0,h=0,l=0,v=[],g=[],m=[],w=0,p=0,b=0;;){var y=i();if(65535!=y){var _=i();if(65475==y){h=t(),p=i(),b=i(),w=t();for(var I=0;I<w;I++){var A=t(),U=t();if(0!=t())throw"e";o[A]=[I,U>>4,15&U]}}else if(65476==y)for(var E=r+_-2;r<E;)n(g);else{if(65498==y){for(r++,I=0;I<w;I++){var B=o[t()];m[B[0]]=g[t()>>>4],v[B[0]]=B.slice(1)}f=t(),r+=2;break}65501==y?l=i():r+=_-2}}else r--}var D=new(h>8?Uint16Array:Uint8Array)(p*b*w),M={b:0,f:0,c:8==f,a:r,data:e,d:e.length,e:l};if(M.c)!function(t,i,n,a,o){for(var f=e.length-r,h=0;h<f;h+=4){var l=e[r+h];e[r+h]=e[r+h+3],e[r+h+3]=l,l=e[r+h+1],e[r+h+1]=e[r+h+2],e[r+h+2]=l}for(var u=0;u<o;u++)for(var c=32768,v=32768,g=0;g<i;g+=2){var m=s(a,n),w=s(a,n);0!=m&&(c+=d(m,n)),0!=w&&(v+=d(w,n)),t[u*i+g]=65535&c,t[u*i+g+1]=65535&v}}(D,b*w,M,m[0],p);else{var P=[],C=0,k=0;for(I=0;I<w;I++){var x=v[I];(J=x[0])>C&&(C=J),(R=x[1])>k&&(k=R),P.push(J*R)}if(1!=C||1!=k){if(3!=w||1!=P[1]||1!=P[2])throw"e";if(2!=C||1!=k&&2!=k)throw"e";var F=[],T=0;for(I=0;I<w;I++){for(var S=0;S<P[I];S++)F.push(m[I]);T+=P[I]}var L=b/C,H=p/k,O=L*H;u(D,L*T,M,F,T,H),c(D,f,L,H,T-2,T,T,h);var N=new Uint16Array(O*P[0]);if(2==C&&2==k){for(I=0;I<O;I++)N[4*I]=D[6*I],N[4*I+1]=D[6*I+1],N[4*I+2]=D[6*I+2],N[4*I+3]=D[6*I+3];for(c(N,f,4*L,H,0,1,1,h),I=0;I<O;I++)D[6*I]=N[4*I],D[6*I+1]=N[4*I+1],D[6*I+2]=N[4*I+2],D[6*I+3]=N[4*I+3]}if(2==C&&1==k){for(I=0;I<O;I++)N[2*I]=D[4*I],N[2*I+1]=D[4*I+1];for(c(N,f,2*L,H,0,1,1,h),I=0;I<O;I++)D[4*I]=N[2*I],D[4*I+1]=N[2*I+1]}for(var G=D.slice(0),R=0;R<p;R++)if(2==k)for(var J=0;J<b;J++){var W=((R>>>1)*L+(J>>>1))*T,j=2*(1&R)+(1&J);D[z=(R*b+J)*w]=G[W+j],D[z+1]=G[W+4],D[z+2]=G[W+5]}else for(J=0;J<b;J++){var z;W=(R*L+(J>>>1))*T,j=1&J,D[z=(R*b+J)*w]=G[W+j],D[z+1]=G[W+2],D[z+2]=G[W+3]}}else if(u(D,b*w,M,m,w,p),0==l)c(D,f,b,p,0,w,w,h);else{var $=Math.floor(l/b);for(R=0;R<p;R+=$){var q=D.slice(R*b*w,(R+$)*b*w);c(q,f,b,$,0,w,w,h),D.set(q,R*b*w)}}}return D}}(),function(){var r=2,t=4,i=5,n=6,a=7,o=12,f=13,s=14,h=15,l=17;function u(e){for(var r=[[],[],[]],t=Math.max(2,e.w+32>>>6),i=0;i<3;i++)for(var n=0;n<41;n++)r[i][n]=[t,1];return r}function d(e,r){var t=0,i=8-e.a;if(e.j,e.a,r){if(r>=i)do{t<<=i,r-=i,t|=e[e.j]&(1<<i)-1,e.j++,i=8}while(r>=8);r&&(t<<=r,i-=r,t|=e[e.j]>>>i&(1<<r)-1),e.a=8-i}return t}function c(e,r,t,i,n,a,o,f){null==f&&(f=0);var s,h,l,u,c,v,g=a+1,m=g%2,w=0,p=i[n],b=i[n-1],y=i[n-2][g],_=b[g-1],I=b[g],A=b[g+1],U=p[g-1],E=p[g+1],B=Math.abs;if(m&&(l=B(A-I),u=B(y-I),c=B(_-I)),m){if(v=(v=l>c&&u<l?y+_:l<c&&u<c?y+A:A+_)+2*I>>>2,f)return void(p[g]=v);s=r.t*r.c[e.g+I-y]+r.c[e.g+_-I]}else v=I>_&&I>A||I<_&&I<A?E+U+2*I>>>2:U+E>>>1,s=r.t*r.c[e.g+I-_]+r.c[e.g+_-U];h=B(s);var D=function(e){for(var r=-1,t=0;!t;r++)t=e[e.j]>>>7-e.a&1,e.a++,e.a&=7,e.a||e.j++;return r}(t);if(D<e.n-r.v-1){var M=function(e,r){var t=0;if(r<e)for(;t<=14&&r<<++t<e;);return t}(o[h][0],o[h][1]);w=d(t,M)+(D<<M)}else w=d(t,r.v)+1;w=1&w?-1-(w>>>1):w>>>1,o[h][0]+=B(w),o[h][1]==e.f&&(o[h][0]>>>=1,o[h][1]>>>=1),o[h][1]++,v=s<0?v-w:v+w,e.i&&(v<0?v+=r.w:v>e.g&&(v-=r.w)),p[g]=v>=0?Math.min(v,e.g):0}function v(e,r,t){for(var i=e[0].length,n=r;n<=t;n++)e[n][0]=e[n-1][1],e[n][i-1]=e[n-1][i-2]}function g(e){v(e,a,o),v(e,r,t),v(e,h,l)}function m(e,r,i,n,a,o,s,h,l,u,d,v,m){for(var w=0,p=1,b=a<f&&a>t;p<e.m;)w<e.m&&(c(e,r,i,n,a,w,s[l],e.h&&(b&&u||!b&&(d||(w&v)==m))),c(e,r,i,n,o,w,s[l],e.h&&(!b&&u||b&&(d||(w&v)==m))),w+=2),w>8&&(c(e,r,i,n,a,p,h[l]),c(e,r,i,n,o,p,h[l]),p+=2);g(n)}function w(e,i,n,f,s,u){m(e,i,n,f,r,a,s,u,0,0,1,0,8),m(e,i,n,f,8,h,s,u,1,0,1,0,8),m(e,i,n,f,3,9,s,u,2,1,0,3,0),m(e,i,n,f,10,16,s,u,0,0,0,3,2),m(e,i,n,f,t,11,s,u,1,0,0,3,2),m(e,i,n,f,o,l,s,u,2,1,0,3,0)}function p(e,t,i,n,o,f){var s=f.length,l=e.l;o+1==e.s&&(l=e.e-o*e.l);for(var u=6*e.e*n+o*e.l,d=0;d<6;d++){for(var c=0;c<l;c++){var v,g=f[d%s][c%s];v=0==g?r+(d>>>1):2==g?h+(d>>>1):a+d;var m=e.h?(2*c/3&2147483646|c%3&1)+(c%3>>>1):c>>>1;t[u+c]=i[v][m+1]}u+=e.e}}e._decompressRAF=function(a,h){var d=function(r){var t=e._binBE.readUshort,i={b:t(r,0),i:r[2],C:r[3],u:r[4],q:t(r,5),k:t(r,7),e:t(r,9),l:t(r,11),s:r[13],d:t(r,14)};if(18771!=i.b||i.i>1||i.q<6||i.q%6||i.e<768||i.e%24||768!=i.l||i.k<i.l||i.k%i.l||i.k-i.e>=i.l||i.s>16||i.s!=i.k/i.l||i.s!=Math.ceil(i.e/i.l)||i.d!=i.q/6||12!=i.u&&14!=i.u&&16!=i.u||16!=i.C&&0!=i.C)throw"Invalid data";if(0==i.i)throw"Not implemented. We need this file!";return i.h=16==i.C,i.m=0|(i.h?2*i.l/3:i.l>>>1),i.A=i.m+2,i.f=64,i.g=(1<<i.u)-1,i.n=4*i.u,i}(a),c=function(r,t){var i=new Array(t.s),n=4*t.s,a=16+n;12&n&&(a+=16-(12&n));for(var o=0,f=16;o<t.s;f+=4){var s=e._binBE.readUint(r,f);i[o]=r.slice(a,a+s),i[o].j=0,i[o].a=0,a+=s,o++}if(a!=r.length)throw"Invalid data";return i}(a,d),v=function(e){var r={c:new Int8Array(2<<e.u)};return function(e,r,t){var i=[0,18,67,276,t];e.o=0,e.w=(i[4]+0)/1+1|0,e.v=Math.ceil(Math.log2(e.w)),e.t=9,function(e,r){for(var t=-r[4],i=0;t<=r[4];i++,t++)e[i]=t<=-r[3]?-4:t<=-r[2]?-3:t<=-r[1]?-2:t<-r[0]?-1:t<=r[0]?0:t<r[1]?1:t<r[2]?2:t<r[3]?3:4}(e.c,i)}(r,0,e.g),r}(d),m=new Int16Array(d.e*d.q);null==h&&(h=d.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var b=[[0,3],[1,t],[i,11],[n,o],[f,16],[s,l]],y=[],_=0;_<18;_++)y[_]=new Uint16Array(d.A);for(var I=0;I<d.s;I++){var A=u(v),U=u(v);for(_=0;_<18;_++)for(var E=0;E<d.A;E++)y[_][E]=0;for(var B=0;B<d.d;B++){for(w(d,v,c[I],y,A,U),_=0;_<6;_++)for(E=0;E<d.A;E++)y[b[_][0]][E]=y[b[_][1]][E];for(p(d,m,y,B,I,h),_=r;_<18;_++)if(-1==[i,n,f,s].indexOf(_))for(E=0;E<d.A;E++)y[_][E]=0;g(y)}}return m}}()}(r)}()}},r={};function t(i){var n=r[i];if(void 0!==n)return n.exports;var a=r[i]={exports:{}};return e[i](a,a.exports,t),a.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{"use strict";var e=t(57),r=t.n(e);class i{#e=null;#r=0;#t=0;#i=!1;#n=null;imageProperties={currentRotation:0,currentScale:1};constructor(){}resetTransform(){this.#r=0,this.#t=0,this.imageProperties.currentScale=1,this.applyTransform()}applyTransform(e=!1){var r=`translate(${this.#r}px, ${this.#t}px) `;this.#e.classList.remove("rotate90"),this.#e.classList.remove("rotate270"),90===this.imageProperties.currentRotation&&e?(this.#e.classList.add("rotate90"),r="translateX(0%) translateY(-100%) "):270===this.imageProperties.currentRotation&&e&&(this.#e.classList.add("rotate270"),r="translateX(-100%) translateY(0%) "),this.#e.style.transform=r+` scale(${this.imageProperties.currentScale}) rotate(${this.imageProperties.currentRotation}deg)`}rotate(e,r=null){this.imageProperties.currentRotation=(this.imageProperties.currentRotation+e)%360,0!==r||1===this.imageProperties.currentScale?this.applyTransform(!0):this.resetTransform(!0)}zoomOnly(e,r=!0){e?this.imageProperties.currentScale*=1.2:this.imageProperties.currentScale/=1.2,r&&this.applyTransform()}setImage(e){this.#e=e,this.#i=!1,this.#n=null,this.#e.onmousedown=e=>{this.mousedown(e)},this.#e.onwheel=e=>{this.onwheel(e)},this.#e.ondblclick=()=>{this.zoomOnly(!0)},this.applyTransform()}mousedown(e){e.preventDefault(),this.#i=!0,this.#e.style.cursor="grabbing",this.#n={x:e.clientX-this.#r,y:e.clientY-this.#t}}mousemoved(e){this.#i&&(0!==e.buttons?(this.#r=e.clientX-this.#n.x,this.#t=e.clientY-this.#n.y,this.applyTransform()):this.#i=!1)}mousereleased(){this.#i&&(this.#i=!1,this.#e.style.cursor="grab")}onwheel(e){e.preventDefault();const r=e.wheelDelta?e.wheelDelta:-e.deltaY;this.zoomOnly(r>0,!1),this.applyTransform()}}class n{#e=null;#a=0;constructor(e,r){this.imageContainerId=e,this.imageContainer=document.querySelector("#"+e),this.toolbar=document.querySelector(r),this.toolbar.innerText="",this.zoomer=new i,this.addButton("btn-secondary rotateLeft","fa-solid fa-rotate-left","",(()=>this.rotateFix(270))),this.addButton("btn-secondary rotate180","fa-solid fa-arrows-rotate","",(()=>this.rotateFix(180))),this.addButton("btn-secondary rotateRight","fa-solid fa-rotate-right","",(()=>this.rotateFix(90))),this.addButton("btn-secondary","fa-solid fa-maximize","",(()=>{this.fitBest(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","fa-solid fa-arrows-left-right","",(()=>{this.fitWidth(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","","100%",(()=>{this.originalSize(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","fa-solid fa-magnifying-glass-plus","",(()=>{this.zoomer.zoomOnly(!0)})),this.addButton("btn-secondary","fa-solid fa-magnifying-glass-minus","",(()=>{this.zoomer.zoomOnly(!1)})),window.addEventListener("mousemove",(e=>this.zoomer.mousemoved(e))),window.addEventListener("mouseup",(e=>this.zoomer.mousereleased(e)))}get image(){return this.#e}set image(e){switch(this.#e=e,this.#a){case 1:this.fitWidth();break;case 2:this.originalSize();break;default:this.fitBest()}this.zoomer.setImage(this.#e)}createButton(e,r,t,i){const n=document.createElement("button");return e&&e.split(" ").forEach((e=>{n.classList.add(e)})),n.classList.add("btn","rotate-button"),r&&(n.innerHTML=`<i class="fas ${r}"></i>`),n.innerHTML+=` ${t}`,n.addEventListener("click",i),n}addButton(e,r,t,i){const n=this.createButton(e,r,t,i);this.toolbar.appendChild(n)}rotateFix(e){this.zoomer.rotate(e,this.#a)}fitBest(){this.#a=0,this.#e.style.width="auto",this.#e.style.height="auto",this.#e.style.maxWidth="100%",this.#e.style.maxHeight="100%",this.centerTheImage()}fitWidth(){this.#a=1,this.#e.style.width="100%",this.#e.style.height="auto",this.#e.style.maxWidth="none",this.#e.style.maxHeight="none",this.topLeftImage()}originalSize(){this.#a=2,this.#e.style.width="auto",this.#e.style.height="auto",this.#e.style.maxWidth="none",this.#e.style.maxHeight="none",this.topLeftImage()}topLeftImage(){this.imageContainer.style.display="",this.imageContainer.style.alignItems="",this.imageContainer.style.justifyContent=""}centerTheImage(){this.imageContainer.style.display="flex",this.imageContainer.style.alignItems="center",this.imageContainer.style.justifyContent="center"}}class a{constructor(e,r,t){this.numPages=e,this.currentPage=1,this.toolbarSelector=r,this.gotoCallback=t,this.toolbar=this.createToolbar()}createToolbar(){const e=document.querySelector(this.toolbarSelector);if(this.numPages&&this.numPages<2)return void(e.innerText=" Page 1/1");e.innerText="",this.firstButton=this.createButton("btn-secondary","fa-solid fa-backward-step","",this.goToPage.bind(this,1)),this.prevButton=this.createButton("btn-secondary","fa-solid fa-left-long","",this.goToPreviousPage.bind(this)),this.nextButton=this.createButton("btn-secondary","fa-solid fa-right-long","",this.goToNextPage.bind(this)),this.lastButton=this.createButton("btn-secondary","fa-solid fa-forward-step","",this.goToPage.bind(this,this.numPages));const r=document.createElement("input");r.classList.add("pageNumber"),r.type="number",r.min=1,r.max=this.numPages,r.value=1,r.style.width=this.numPages.toString().length+3+"ch",r.style.textAlign="right",r.addEventListener("change",this.goToPage.bind(this,null));const t=document.createElement("span");return t.classList.add("pageCount"),t.innerHTML=" / "+this.numPages.toString(),this.firstButton.disabled=!0,e.appendChild(this.firstButton),this.prevButton.disabled=!0,e.appendChild(this.prevButton),e.appendChild(r),e.appendChild(t),e.appendChild(this.nextButton),e.appendChild(this.lastButton),e}createButton(e,r,t,i){const n=document.createElement("button");return e&&e.split(" ").forEach((e=>{n.classList.add(e)})),n.classList.add("btn","navigation-button"),n.innerHTML=`<i class="fas ${r}"></i> ${t}`,n.addEventListener("click",i),n}goToPage(e){const r=document.querySelector(this.toolbarSelector+" .pageNumber");e?(this.currentPage=parseInt(e),r.value=this.currentPage):this.currentPage=parseInt(r.value),this.firstButton.disabled=!1,this.prevButton.disabled=!1,this.nextButton.disabled=!1,this.lastButton.disabled=!1,1==this.currentPage?(this.firstButton.disabled=!0,this.prevButton.disabled=!0):this.currentPage==this.numPages&&(this.nextButton.disabled=!0,this.lastButton.disabled=!0),console.log(`Navigating to page ${this.currentPage}`),this.gotoCallback()}goToPreviousPage(){this.currentPage>1&&this.goToPage(this.currentPage-1)}goToNextPage(){this.currentPage<this.numPages&&this.goToPage(this.currentPage+1)}}window.AptTec=window.AptTec||{},window.AptTec.ViewerSources=Object.freeze({Url:"Url",Blob:"Blob",ArrayBuffer:"ArrayBuffer"}),window.AptTec.Viewer=class{#o="";#f=null;#s=null;#h=null;#l=null;constructor(e,r,t,i,a){if(!e)throw new Error("Mandatory property 'type' is missing");if(!r)throw new Error("Mandatory property 'source' is missing");if(!t)throw new Error("Mandatory property 'imageContainerId' is missing");this.#o=e,this.#o===window.AptTec.ViewerSources.ArrayBuffer?this.#h=r:this.#f=r,this.imageContainerId=t,this.toolbarContainer=i,this.pageToolbarContainer=a,this.imageSelector=`#${this.imageContainerId} #tiffImage`,this.imageOperations=new n(this.imageContainerId,this.toolbarContainer),this.navigationToolbar=null}async show(e=1){this.#h&&this.loadImage(e),this.#o===window.AptTec.ViewerSources.Url&&await fetch(this.#f).then((e=>e.arrayBuffer())).then((r=>{this.#h=r,this.loadImage(e)}))}loadImage(e){const r=document.getElementById(this.imageContainerId);r.innerHTML="",r.innerHTML='<img id="tiffImage" alt="ViewerImage">',this.imageOperations.image=document.querySelector(this.imageSelector),this.#s&&URL.revokeObjectURL(this.#s),this.#s=this.#u(this.#h,e),this.imageOperations.image.src=this.#s}pagechanged(){console.log(`Page changed to ${this.navigationToolbar.currentPage}`),this.loadImage(this.navigationToolbar.currentPage)}#u(e,t){const i=t-1;this.navigationToolbar||(this.#l=r().decode(e),this.pageCount=this.#l.length,this.navigationToolbar=new a(this.pageCount,this.pageToolbarContainer,(()=>this.pagechanged())));var n=this.#l,o=0,f=n[i];this.#l[i].subIFD&&(n=n.concat(this.#l[i].subIFD));for(var s=0;s<n.length;s++){var h=n[s];if(!(null==h.t258||h.t258.length<3)){var l=h.t256*h.t257;l>o&&(o=l,f=h)}}r().decodeImage(e,f,this.#l);var u=f.width,d=f.height;const c=r().toRGBA8(f);var v=document.createElement("canvas");v.width=u,v.height=d;var g=v.getContext("2d"),m=new ImageData(new Uint8ClampedArray(c.buffer),u,d);return g.putImageData(m,0,0),v.toDataURL()}}})()})();
//# sourceMappingURL=AptTecImageViewer.bundle.js.map