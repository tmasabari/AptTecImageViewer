(()=>{var e={57:e=>{!function(){var r={};function t(){"undefined"==typeof process&&console.log.apply(console,arguments)}e.exports=r,function(e){var r,i,n,a,o,s,f,h,l,u,c,d,v,g,w,m;!function(){"use strict";var r=function(){function e(e){this.message="JPEG error: "+e}return e.prototype=new Error,e.prototype.name="JpegError",e.constructor=e,e}(),t=function(){var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,n=799,a=3406,o=2276,s=1567,f=3784,h=5793,l=2896;function u(e){null==e&&(e={}),null==e.w&&(e.w=-1),this.V=e.n,this.N=e.w}function c(e,r){for(var t,i,n,a=0,o=[],s=16;s>0&&!e[s-1];)s--;o.push({children:[],index:0});var f=o[0];for(t=0;t<s;t++){for(i=0;i<e[t];i++){for((f=o.pop()).children[f.index]=r[a];f.index>0;)f=o.pop();for(f.index++,o.push(f);o.length<=t;)o.push(n={children:[],index:0}),f.children[f.index]=n.children,f=n;a++}t+1<s&&(o.push(n={children:[],index:0}),f.children[f.index]=n.children,f=n)}return o[0].children}function d(e,r,t){return 64*((e.P+1)*r+t)}function v(t,n,a,o,s,f,h,l,u,c){null==c&&(c=!1);var v,g,w,p,b,_,y,I,U,A,B,E=a.m,D=a.Z,M=n,P=0,S=0,C=0,F=0,T=0,k=0;function x(){if(S>0)return S--,P>>S&1;if(255===(P=t[n++])){var e=t[n++];if(e){if(220===e&&c){var o=i(t,n+=2);if(n+=2,o>0&&o!==a.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",o)}else if(217===e){if(c){var s=8*T;if(s>0&&s<a.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",s)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new r("unexpected marker")}}return S=7,P>>>7}function L(e){for(var t=e;;){switch(typeof(t=t[x()])){case"number":return t;case"object":continue}throw new r("invalid huffman sequence")}}function H(e){for(var r=0;e>0;)r=r<<1|x(),e--;return r}function O(e){if(1===e)return 1===x()?1:-1;var r=H(e);return r>=1<<e-1?r:r+(-1<<e)+1}function R(e,r,t,i,n){var a=t%E;T=(t/E|0)*e.A+i;var o=a*e.h+n;r(e,d(e,T,o))}function N(e,r,t){T=t/e.P|0;var i=t%e.P;r(e,d(e,T,i))}var G=o.length;for(y=D?0===f?0===l?function(e,r){var t=L(e.J),i=0===t?0:O(t)<<u;e.D[r]=e.Q+=i}:function(e,r){e.D[r]|=x()<<u}:0===l?function(r,t){if(C>0)C--;else for(var i=f,n=h;i<=n;){var a=L(r.i),o=15&a,s=a>>4;if(0!==o){var l=e[i+=s];r.D[t+l]=O(o)*(1<<u),i++}else{if(s<15){C=H(s)+(1<<s)-1;break}i+=16}}}:function(t,i){for(var n,a,o=f,s=h,l=0;o<=s;){var c=i+e[o],d=t.D[c]<0?-1:1;switch(F){case 0:if(l=(a=L(t.i))>>4,0==(n=15&a))l<15?(C=H(l)+(1<<l),F=4):(l=16,F=1);else{if(1!==n)throw new r("invalid ACn encoding");v=O(n),F=l?2:3}continue;case 1:case 2:t.D[c]?t.D[c]+=d*(x()<<u):0==--l&&(F=2===F?3:0);break;case 3:t.D[c]?t.D[c]+=d*(x()<<u):(t.D[c]=v<<u,F=0);break;case 4:t.D[c]&&(t.D[c]+=d*(x()<<u))}o++}4===F&&0==--C&&(F=0)}:function(r,t){var i=L(r.J),n=0===i?0:O(i),a=1;for(r.D[t]=r.Q+=n;a<64;){var o=L(r.i),s=15&o,f=o>>4;if(0!==s){var h=e[a+=f];r.D[t+h]=O(s),a++}else{if(f<15)break;a+=16}}},U=1===G?o[0].P*o[0].c:E*a.R;k<=U;){var J=s?Math.min(U-k,s):U;if(J>0){for(w=0;w<G;w++)o[w].Q=0;if(C=0,1===G)for(g=o[0],_=0;_<J;_++)N(g,y,k),k++;else for(_=0;_<J;_++){for(w=0;w<G;w++)for(A=(g=o[w]).h,B=g.A,p=0;p<B;p++)for(b=0;b<A;b++)R(g,y,k,p,b);k++}}if(S=0,!(I=m(t,n)))break;if(I.u&&(n=I.offset),!(I.M>=65488&&I.M<=65495))break;n+=2}return n-M}function g(e,i,u){var c,d,v,g,w,m,p,b,_,y,I,U,A,B,E,D,M,P=e.$,S=e.D;if(!P)throw new r("missing required Quantization Table.");for(var C=0;C<64;C+=8)_=S[i+C],y=S[i+C+1],I=S[i+C+2],U=S[i+C+3],A=S[i+C+4],B=S[i+C+5],E=S[i+C+6],D=S[i+C+7],_*=P[C],0!=(y|I|U|A|B|E|D)?(y*=P[C+1],I*=P[C+2],U*=P[C+3],A*=P[C+4],B*=P[C+5],E*=P[C+6],D*=P[C+7],d=(c=(c=h*_+128>>8)+(d=h*A+128>>8)+1>>1)-d,M=(v=I)*f+(g=E)*s+128>>8,v=v*s-g*f+128>>8,p=(w=(w=l*(y-D)+128>>8)+(p=B<<4)+1>>1)-p,m=(b=(b=l*(y+D)+128>>8)+(m=U<<4)+1>>1)-m,g=(c=c+(g=M)+1>>1)-g,v=(d=d+v+1>>1)-v,M=w*o+b*a+2048>>12,w=w*a-b*o+2048>>12,b=M,M=m*n+p*t+2048>>12,m=m*t-p*n+2048>>12,p=M,u[C]=c+b,u[C+7]=c-b,u[C+1]=d+p,u[C+6]=d-p,u[C+2]=v+m,u[C+5]=v-m,u[C+3]=g+w,u[C+4]=g-w):(M=h*_+512>>10,u[C]=M,u[C+1]=M,u[C+2]=M,u[C+3]=M,u[C+4]=M,u[C+5]=M,u[C+6]=M,u[C+7]=M);for(var F=0;F<8;++F)_=u[F],0!=((y=u[F+8])|(I=u[F+16])|(U=u[F+24])|(A=u[F+32])|(B=u[F+40])|(E=u[F+48])|(D=u[F+56]))?(d=(c=4112+((c=h*_+2048>>12)+(d=h*A+2048>>12)+1>>1))-d,M=(v=I)*f+(g=E)*s+2048>>12,v=v*s-g*f+2048>>12,g=M,p=(w=(w=l*(y-D)+2048>>12)+(p=B)+1>>1)-p,m=(b=(b=l*(y+D)+2048>>12)+(m=U)+1>>1)-m,M=w*o+b*a+2048>>12,w=w*a-b*o+2048>>12,b=M,M=m*n+p*t+2048>>12,m=m*t-p*n+2048>>12,(_=(c=c+g+1>>1)+b)<16?_=0:_>=4080?_=255:_>>=4,(y=(d=d+v+1>>1)+(p=M))<16?y=0:y>=4080?y=255:y>>=4,(I=(v=d-v)+m)<16?I=0:I>=4080?I=255:I>>=4,(U=(g=c-g)+w)<16?U=0:U>=4080?U=255:U>>=4,(A=g-w)<16?A=0:A>=4080?A=255:A>>=4,(B=v-m)<16?B=0:B>=4080?B=255:B>>=4,(E=d-p)<16?E=0:E>=4080?E=255:E>>=4,(D=c-b)<16?D=0:D>=4080?D=255:D>>=4,S[i+F]=_,S[i+F+8]=y,S[i+F+16]=I,S[i+F+24]=U,S[i+F+32]=A,S[i+F+40]=B,S[i+F+48]=E,S[i+F+56]=D):(M=(M=h*_+8192>>14)<-2040?0:M>=2024?255:M+2056>>4,S[i+F]=M,S[i+F+8]=M,S[i+F+16]=M,S[i+F+24]=M,S[i+F+32]=M,S[i+F+40]=M,S[i+F+48]=M,S[i+F+56]=M)}function w(e,r){for(var t=r.P,i=r.c,n=new Int16Array(64),a=0;a<i;a++)for(var o=0;o<t;o++)g(r,d(r,a,o),n);return r.D}function m(e,r,t){null==t&&(t=r);var n=e.length-1,a=t<r?t:r;if(r>=n)return null;var o=i(e,r);if(o>=65472&&o<=65534)return{u:null,M:o,offset:r};for(var s=i(e,a);!(s>=65472&&s<=65534);){if(++a>=n)return null;s=i(e,a)}return{u:o.toString(16),M:s,offset:a}}return u.prototype={parse(t,n){null==n&&(n={});var a,o,s=n.F,f=0,h=null,l=null,u=0;function d(){var e=i(t,f),r=(f+=2)+e-2,n=m(t,r,f);n&&n.u&&(r=n.offset);var a=t.subarray(f,r);return f+=a.length,a}function g(e){for(var r=Math.ceil(e.o/8/e.X),t=Math.ceil(e.s/8/e.B),i=0;i<e.W.length;i++){J=e.W[i];var n=Math.ceil(Math.ceil(e.o/8)*J.h/e.X),a=Math.ceil(Math.ceil(e.s/8)*J.A/e.B),o=r*J.h,s=t*J.A*64*(o+1);J.D=new Int16Array(s),J.P=n,J.c=a}e.m=r,e.R=t}var p=[],b=[],_=[],y=i(t,f);if(f+=2,65496!==y)throw new r("SOI not found");y=i(t,f),f+=2;e:for(;65497!==y;){var I,U,A;switch(y){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var B=d();65504===y&&74===B[0]&&70===B[1]&&73===B[2]&&70===B[3]&&0===B[4]&&(h={version:{d:B[5],T:B[6]},K:B[7],j:B[8]<<8|B[9],H:B[10]<<8|B[11],S:B[12],I:B[13],C:B.subarray(14,14+3*B[12]*B[13])}),65518===y&&65===B[0]&&100===B[1]&&111===B[2]&&98===B[3]&&101===B[4]&&(l={version:B[5]<<8|B[6],k:B[7]<<8|B[8],q:B[9]<<8|B[10],a:B[11]});break;case 65499:for(var E=i(t,f)+(f+=2)-2;f<E;){var D=t[f++],M=new Uint16Array(64);if(D>>4==0)for(U=0;U<64;U++)M[e[U]]=t[f++];else{if(D>>4!=1)throw new r("DQT - invalid table spec");for(U=0;U<64;U++)M[e[U]]=i(t,f),f+=2}p[15&D]=M}break;case 65472:case 65473:case 65474:if(a)throw new r("Only single frame JPEGs supported");f+=2,(a={}).G=65473===y,a.Z=65474===y,a.precision=t[f++];var P,S=i(t,f),C=0,F=0;f+=2,a.s=s||S,a.o=i(t,f),f+=2,a.W=[],a._={};var T=t[f++];for(I=0;I<T;I++){P=t[f];var k=t[f+1]>>4,x=15&t[f+1];C<k&&(C=k),F<x&&(F=x);var L=t[f+2];A=a.W.push({h:k,A:x,L,$:null}),a._[P]=A-1,f+=3}a.X=C,a.B=F,g(a);break;case 65476:var H=i(t,f);for(f+=2,I=2;I<H;){var O=t[f++],R=new Uint8Array(16),N=0;for(U=0;U<16;U++,f++)N+=R[U]=t[f];var G=new Uint8Array(N);for(U=0;U<N;U++,f++)G[U]=t[f];I+=17+N,(O>>4==0?_:b)[15&O]=c(R,G)}break;case 65501:o=i(t,f+=2),f+=2;break;case 65498:var J,W=1==++u&&!s;f+=2;var j=t[f++],z=[];for(I=0;I<j;I++){var $=t[f++],q=a._[$];(J=a.W[q]).index=$;var V=t[f++];J.J=_[V>>4],J.i=b[15&V],z.push(J)}var X=t[f++],Y=t[f++],Q=t[f++];try{var Z=v(t,f,a,z,o,X,Y,Q>>4,15&Q,W);f+=Z}catch(e){if(e instanceof DNLMarkerError)return this.parse(t,{F:e.s});if(e instanceof EOIMarkerError)break e;throw e}break;case 65500:f+=4;break;case 65535:255!==t[f]&&f--;break;default:var K=m(t,f-2,f-3);if(K&&K.u){f=K.offset;break}if(f>=t.length-1)break e;throw new r("JpegImage.parse - unknown marker: "+y.toString(16))}y=i(t,f),f+=2}for(this.width=a.o,this.height=a.s,this.g=h,this.b=l,this.W=[],I=0;I<a.W.length;I++){var ee=p[(J=a.W[I]).L];ee&&(J.$=ee),this.W.push({index:J.index,e:w(0,J),l:J.h/a.X,t:J.A/a.B,P:J.P,c:J.c})}this.p=this.W.length},Y(e,r,t){null==t&&(t=!1);var i,n,a,o,s,f,h,l,u,c,d,v,g=this.width/e,w=this.height/r,m=0,p=this.W.length,b=e*r*p,_=new Uint8ClampedArray(b),y=new Uint32Array(e),I=4294967288;for(h=0;h<p;h++){if(n=(i=this.W[h]).l*g,a=i.t*w,m=h,d=i.e,o=i.P+1<<3,n!==v){for(s=0;s<e;s++)l=0|s*n,y[s]=(l&I)<<3|7&l;v=n}for(f=0;f<r;f++)for(c=o*((l=0|f*a)&I)|(7&l)<<3,s=0;s<e;s++)_[m]=d[c+y[s]],m+=p}var U=this.V;if(t||4!==p||U||(U=new Int32Array([-256,255,-256,255,-256,255,-256,255])),U)for(h=0;h<b;)for(l=0,u=0;l<p;l++,h++,u+=2)_[h]=(_[h]*U[u]>>8)+U[u+1];return _},get f(){return this.b?!!this.b.a:3===this.p?0!==this.N&&(82!==this.W[0].index||71!==this.W[1].index||66!==this.W[2].index):1===this.N},z:function(e){for(var r,t,i,n=0,a=e.length;n<a;n+=3)r=e[n],t=e[n+1],i=e[n+2],e[n]=r-179.456+1.402*i,e[n+1]=r+135.459-.344*t-.714*i,e[n+2]=r-226.816+1.772*t;return e},O:function(e){for(var r,t,i,n,a=0,o=0,s=e.length;o<s;o+=4)r=e[o],t=e[o+1],i=e[o+2],n=e[o+3],e[a++]=t*(-660635669420364e-19*t+.000437130475926232*i-54080610064599e-18*r+.00048449797120281*n-.154362151871126)-122.67195406894+i*(-.000957964378445773*i+.000817076911346625*r-.00477271405408747*n+1.53380253221734)+r*(.000961250184130688*r-.00266257332283933*n+.48357088451265)+n*(-.000336197177618394*n+.484791561490776),e[a++]=107.268039397724+t*(219927104525741e-19*t-.000640992018297945*i+.000659397001245577*r+.000426105652938837*n-.176491792462875)+i*(-.000778269941513683*i+.00130872261408275*r+.000770482631801132*n-.151051492775562)+r*(.00126935368114843*r-.00265090189010898*n+.25802910206845)+n*(-.000318913117588328*n-.213742400323665),e[a++]=t*(-.000570115196973677*t-263409051004589e-19*i+.0020741088115012*r-.00288260236853442*n+.814272968359295)-20.810012546947+i*(-153496057440975e-19*i-.000132689043961446*r+.000560833691242812*n-.195152027534049)+r*(.00174418132927582*r-.00255243321439347*n+.116935020465145)+n*(-.000343531996510555*n+.24165260232407);return e.subarray(0,a)},r:function(e){for(var r,t,i,n=0,a=e.length;n<a;n+=4)r=e[n],t=e[n+1],i=e[n+2],e[n]=434.456-r-1.402*i,e[n+1]=119.541-r+.344*t+.714*i,e[n+2]=481.816-r-1.772*t;return e},U:function(e){for(var r,t,i,n,a=0,o=0,s=e.length;o<s;o+=4)r=e[o],t=e[o+1],i=e[o+2],n=e[o+3],e[a++]=255+r*(-6747147073602441e-20*r+.0008379262121013727*t+.0002894718188643294*i+.003264231057537806*n-1.1185611867203937)+t*(26374107616089405e-21*t-8626949158638572e-20*i-.0002748769067499491*n-.02155688794978967)+i*(-3878099212869363e-20*i-.0003267808279485286*n+.0686742238595345)-n*(.0003361971776183937*n+.7430659151342254),e[a++]=255+r*(.00013596372813588848*r+.000924537132573585*t+.00010567359618683593*i+.0004791864687436512*n-.3109689587515875)+t*(-.00023545346108370344*t+.0002702845253534714*i+.0020200308977307156*n-.7488052167015494)+i*(6834815998235662e-20*i+.00015168452363460973*n-.09751927774728933)-n*(.0003189131175883281*n+.7364883807733168),e[a++]=255+r*(13598650411385307e-21*r+.00012423956175490851*t+.0004751985097583589*i-36729317476630422e-22*n-.05562186980264034)+t*(.00016141380598724676*t+.0009692239130725186*i+.0007782692450036253*n-.44015232367526463)+i*(5.068882914068769e-7*i+.0017778369011375071*n-.7591454649749609)-n*(.0003435319965105553*n+.7063770186160144);return e.subarray(0,a)},getData:function(e){var t=e.width,i=e.height,n=e.forceRGB,a=e.isSourcePDF;if(this.p>4)throw new r("Unsupported color mode");var o=this.Y(t,i,a);if(1===this.p&&n){for(var s=o.length,f=new Uint8ClampedArray(3*s),h=0,l=0;l<s;l++){var u=o[l];f[h++]=u,f[h++]=u,f[h++]=u}return f}if(3===this.p&&this.f)return this.z(o);if(4===this.p){if(this.f)return n?this.O(o):this.r(o);if(n)return this.U(o)}return o}},u}();function i(e,r){return e[r]<<8|e[r+1]}e.JpegDecoder=t}(),e.encodeImage=function(r,t,i,n){var a={t256:[t],t257:[i],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[i],t279:[t*i*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(n)for(var o in n)a[o]=n[o];var s=new Uint8Array(e.encode([a])),f=new Uint8Array(r),h=new Uint8Array(1e3+t*i*4);for(o=0;o<s.length;o++)h[o]=s[o];for(o=0;o<f.length;o++)h[1e3+o]=f[o];return h.buffer},e.encode=function(r){var t=new Uint8Array(2e4),i=4,n=e._binBE;t[0]=t[1]=77,n.writeUshort(t,2,42);var a=8;n.writeUint(t,i,a),i+=4;for(var o=0;o<r.length;o++){var s=e._writeIFD(n,e._types.basic,t,a,r[o]);a=s[1],o<r.length-1&&(0!=(3&a)&&(a+=4-(3&a)),n.writeUint(t,s[0],a))}return t.slice(0,a).buffer},e.decode=function(r,i){null==i&&(i={parseMN:!0,debug:!1});var n=new Uint8Array(r),a=0,o=e._binBE.readASCII(n,a,2);a+=2;var s="II"==o?e._binLE:e._binBE;s.readUshort(n,a),a+=2;var f=s.readUint(n,a);a+=4;for(var h=[];;){var l=s.readUshort(n,f),u=s.readUshort(n,f+4);if(0!=l&&(u<1||13<u)){t("error in TIFF");break}if(e._readIFD(s,n,f,h,0,i),0==(f=s.readUint(n,f+2+12*l)))break}return h},e.decodeImage=function(r,i,n){if(!i.data){var a=new Uint8Array(r),o=e._binBE.readASCII(a,0,2);if(null!=i.t256){i.isLE="II"==o,i.width=i.t256[0],i.height=i.t257[0];var s=i.t259?i.t259[0]:1,f=i.t266?i.t266[0]:1;i.t284&&2==i.t284[0]&&t("PlanarConfiguration 2 should not be used!"),7==s&&i.t258&&i.t258.length>3&&(i.t258=i.t258.slice(0,3));var h=i.t277?i.t277[0]:1,l=(i.t258?i.t258[0]:1)*h;1==s&&null!=i.t279&&i.t278&&32803==i.t262[0]&&(l=Math.round(8*i.t279[0]/(i.width*i.t278[0]))),i.t50885&&4==i.t50885[0]&&(l=3*i.t258[0]);var u=8*Math.ceil(i.width*l/8),c=i.t273;(null==c||i.t322)&&(c=i.t324);var d=i.t279;1==s&&1==c.length&&(d=[i.height*(u>>>3)]),(null==d||i.t322)&&(d=i.t325);var v=new Uint8Array(i.height*(u>>>3)),g=0;if(null!=i.t322){var w=i.t322[0],m=i.t323[0],p=Math.floor((i.width+w-1)/w),b=Math.floor((i.height+m-1)/m),_=new Uint8Array(0|Math.ceil(w*m*l/8));console.log("====",p,b);for(var y=0;y<b;y++)for(var I=0;I<p;I++){var U=y*p+I;_.fill(0),e.decode._decompress(i,n,a,c[U],d[U],s,_,0,f,w,m),6==s?v=_:e._copyTile(_,0|Math.ceil(w*l/8),m,v,0|Math.ceil(i.width*l/8),i.height,0|Math.ceil(I*w*l/8),y*m)}g=8*v.length}else{if(null==c)return;var A=i.t278?i.t278[0]:i.height;for(A=Math.min(A,i.height),U=0;U<c.length;U++)e.decode._decompress(i,n,a,c[U],d[U],s,v,0|Math.ceil(g/8),f,i.width,A),g+=u*A;g=Math.min(g,8*v.length)}i.data=new Uint8Array(v.buffer,0,0|Math.ceil(g/8))}}},e.decode._decompress=function(r,i,n,a,o,s,f,h,l,u,c){if(r.t271&&"Panasonic"==r.t271[0]&&r.t45&&6==r.t45[0]&&(s=34316),1==s)for(var d=0;d<o;d++)f[h+d]=n[a+d];else if(2==s)e.decode._decodeG2(n,a,o,f,h,u,l);else if(3==s)e.decode._decodeG3(n,a,o,f,h,u,l,!!r.t292&&1==(1&r.t292[0]));else if(4==s)e.decode._decodeG4(n,a,o,f,h,u,l);else if(5==s)e.decode._decodeLZW(n,a,o,f,h,8);else if(6==s)e.decode._decodeOldJPEG(r,n,a,o,f,h);else if(7==s||34892==s)e.decode._decodeNewJPEG(r,n,a,o,f,h);else if(8==s||32946==s){var v=new Uint8Array(n.buffer,a+2,o-6),g=e._inflateRaw(v);h+g.length<=f.length&&f.set(g,h)}else 9==s?e.decode._decodeVC5(n,a,o,f,h,r.t33422):32767==s?e.decode._decodeARW(r,n,a,o,f,h):32773==s?e.decode._decodePackBits(n,a,o,f,h):32809==s?e.decode._decodeThunder(n,a,o,f,h):34316==s?e.decode._decodePanasonic(r,n,a,o,f,h):34713==s?e.decode._decodeNikon(r,i,n,a,o,f,h):34676==s?e.decode._decodeLogLuv32(r,n,a,o,f,h):t("Unknown compression",s);var w=r.t258?Math.min(32,r.t258[0]):1,m=r.t277?r.t277[0]:1,p=w*m>>>3,b=Math.ceil(w*m*u/8);if(16==w&&!r.isLE&&null==r.t33422)for(var _=0;_<c;_++)for(var y=h+_*b,I=1;I<b;I+=2){var U=f[y+I];f[y+I]=f[y+I-1],f[y+I-1]=U}if(r.t317&&2==r.t317[0])for(_=0;_<c;_++){var A=h+_*b;if(16==w)for(d=p;d<b;d+=2){var B=(f[A+d+1]<<8|f[A+d])+(f[A+d-p+1]<<8|f[A+d-p]);f[A+d]=255&B,f[A+d+1]=B>>>8&255}else if(3==m)for(d=3;d<b;d+=3)f[A+d]=f[A+d]+f[A+d-3]&255,f[A+d+1]=f[A+d+1]+f[A+d-2]&255,f[A+d+2]=f[A+d+2]+f[A+d-1]&255;else for(d=p;d<b;d++)f[A+d]=f[A+d]+f[A+d-p]&255}},e.decode._decodePanasonic=function(e,r,t,i,n,a){var o,s,f,h,l,u,c,d,v=r.buffer,g=e.t2[0],w=e.t3[0],m=e.t10[0],p=e.t45[0],b=0,_=0,y=0,I=0,U=6==p?new Uint32Array(18):new Uint8Array(16),A=[0,0],B=[0,0],E=0,D=new Uint8Array(16384),M=new Uint16Array(n.buffer);function P(e){if(0==y){var r=new Uint8Array(v,t+_+8184,8200),i=new Uint8Array(v,t+_,8184);D.set(r),D.set(i,r.length),_+=16384}if(5!=p)return(D[I=(y=y-e&131071)>>3^16368]|D[I+1]<<8)>>(7&y)&~(-1<<e);for(o=0;o<16;o++)U[o]=D[y++],y&=16383}function S(e){return D[y+15-e]}function C(){A[0]=0,A[1]=0,B[0]=0,B[1]=0}if(7==p)throw p;if(6==p){var F=12==m,T=F?function(){U[0]=S(0)<<4|S(1)>>4,U[1]=4095&((15&S(1))<<8|S(2)),U[2]=S(3)>>6&3,U[3]=(63&S(3))<<2|S(4)>>6,U[4]=(63&S(4))<<2|S(5)>>6,U[5]=(63&S(5))<<2|S(6)>>6,U[6]=S(6)>>4&3,U[7]=(15&S(6))<<4|S(7)>>4,U[8]=(15&S(7))<<4|S(8)>>4,U[9]=(15&S(8))<<4|S(9)>>4,U[10]=S(9)>>2&3,U[11]=(3&S(9))<<6|S(10)>>2,U[12]=(3&S(10))<<6|S(11)>>2,U[13]=(3&S(11))<<6|S(12)>>2,U[14]=3&S(12),U[15]=S(13),U[16]=S(14),U[17]=S(15),y+=16,I=0}:function(){U[0]=S(0)<<6|S(1)>>2,U[1]=16383&((3&S(1))<<12|S(2)<<4|S(3)>>4),U[2]=S(3)>>2&3,U[3]=(3&S(3))<<8|S(4),U[4]=S(5)<<2|S(6)>>6,U[5]=(63&S(6))<<4|S(7)>>4,U[6]=S(7)>>2&3,U[7]=(3&S(7))<<8|S(8),U[8]=S(9)<<2&1020|S(10)>>6,U[9]=1023&(S(10)<<4|S(11)>>4),U[10]=S(11)>>2&3,U[11]=(3&S(11))<<8|S(12),U[12]=1023&(S(13)<<2&1020|S(14)>>6),U[13]=1023&(S(14)<<4|S(15)>>4),y+=16,I=0},k=F?14:11,x=F?128:512,L=F?2048:8192,H=F?16383:65535,O=F?4095:16383,R=g/k,N=16*R,G=F?18:14;for(u=0;u<w-15;u+=16){var J=Math.min(16,w-u),W=N*J;for(D=new Uint8Array(v,t+b,W),y=0,b+=W,d=0,c=0;d<J;d++,c=0){E=(u+d)*g;for(var j=0;j<R;j++)for(T(),C(),f=0,l=0,o=0;o<k;o++){if(h=1&o,o%3==2){var z=I<G?U[I++]:0;3==z&&(z=4),l=x<<z,f=1<<z}var $=I<G?U[I++]:0;A[h]?($*=f,l<L&&B[h]>l&&($+=B[h]-l),B[h]=$):(A[h]=$,$?B[h]=$:$=B[h]),M[E+c++]=$-15<=H?$-15&H:$+2147483633>>31&O}}}}else if(5==p){var q=12==m?10:9;for(u=0;u<w;u++)for(c=0;c<g;c+=q)P(0),12==m?(M[E++]=((15&U[1])<<8)+U[0],M[E++]=16*U[2]+(U[1]>>4),M[E++]=((15&U[4])<<8)+U[3],M[E++]=16*U[5]+(U[4]>>4),M[E++]=((15&U[7])<<8)+U[6],M[E++]=16*U[8]+(U[7]>>4),M[E++]=((15&U[10])<<8)+U[9],M[E++]=16*U[11]+(U[10]>>4),M[E++]=((15&U[13])<<8)+U[12],M[E++]=16*U[14]+(U[13]>>4)):14==m&&(M[E++]=U[0]+((63&U[1])<<8),M[E++]=(U[1]>>6)+4*U[2]+((15&U[3])<<10),M[E++]=(U[3]>>4)+16*U[4]+((3&U[5])<<12),M[E++]=((252&U[5])>>2)+(U[6]<<6),M[E++]=U[7]+((63&U[8])<<8),M[E++]=(U[8]>>6)+4*U[9]+((15&U[10])<<10),M[E++]=(U[10]>>4)+16*U[11]+((3&U[12])<<12),M[E++]=((252&U[12])>>2)+(U[13]<<6),M[E++]=U[14]+((63&U[15])<<8))}else{if(4!=p)throw p;for(u=0;u<w;u++)for(c=0;c<g;c++)h=1&(o=c%14),0==o&&C(),o%3==2&&(f=4>>3-P(2)),B[h]?0!=(s=P(8))&&(A[h]-=128<<f,(A[h]<0||4==f)&&(A[h]&=~(-1<<f)),A[h]+=s<<f):(B[h]=P(8),(B[h]||o>11)&&(A[h]=B[h]<<4|P(4))),M[E++]=A[1&c]}},e.decode._decodeVC5=function(){var r,t,i,n=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],a=[3,3,3,3,2,2,2,1,1,1];function o(e){var r=e[1],t=e[0][r>>>3]>>>7-(7&r)&1;return e[1]++,t}function s(e,t){if(null==r){r={};for(var i=0;i<n.length;i+=4)r[n[i+1]]=n.slice(i,i+4)}for(var a=o(e),s=r[a];null==s;)a=a<<1|o(e),s=r[a];var f=s[3];0!=f&&(f=0==o(e)?f:-f),t[0]=s[2],t[1]=f}function f(e,r){for(var t=0;t<r;t++)1==(1&e)&&e++,e>>>=1;return e}function h(e,r){return e>>r}function l(e,r,t,i,n,a){r[t]=h(h(11*e[n]-4*e[n+a]+e[n+a+a]+4,3)+e[i],1),r[t+a]=h(h(5*e[n]+4*e[n+a]-e[n+a+a]+4,3)-e[i],1)}function u(e,r,t,i,n,a){var o=e[n-a]-e[n+a],s=e[n],f=e[i];r[t]=h(h(o+4,3)+s+f,1),r[t+a]=h(h(4-o,3)+s-f,1)}function c(e,r,t,i,n,a){r[t]=h(h(5*e[n]+4*e[n-a]-e[n-a-a]+4,3)+e[i],1),r[t+a]=h(h(11*e[n]-4*e[n-a]+e[n-a-a]+4,3)-e[i],1)}function d(e){return i[e=e<0?0:e>4095?4095:e]>>>2}return function(r,n,o,h,v,g){h=new Uint16Array(h.buffer);var w,m,p,b,_,y,I,U,A=Date.now(),B=e._binBE,E=n+o;n+=4;for(var D=1==g[0];n<E;){var M=B.readShort(r,n),P=B.readUshort(r,n+2);if(n+=4,12==M)L=P;else if(20==M)w=P;else if(21==M)m=P;else if(48==M)p=P;else if(53==M)b=P;else if(35==M);else if(62==M)_=P;else if(101==M);else if(109==M)y=P;else if(84==M);else if(106==M);else if(107==M);else if(108==M);else if(102==M);else if(104==M)te=P;else if(105==M);else{var S=M<0?-M:M,C=65280&S,F=0;if(24576&S&&(8192&S?(F=65535&P,F+=(255&S)<<16):F=65535&P),24576==(24576&S)){if(null==I){I=[];for(var T=0;T<4;T++)I[T]=new Int16Array((w>>>1)*(m>>>1));for(U=new Int16Array((w>>>1)*(m>>>1)),t=new Int16Array(1024),T=0;T<1024;T++){var k=T-512,x=Math.abs(k),L=Math.floor(768*x*x*x/16581375)+x;t[T]=Math.sign(k)*L}for(i=new Uint16Array(4096),T=0;T<4096;T++){var H=T,O=65535*(Math.pow(113,H/4095)-1)/112;i[T]=Math.min(O,65535)}}var R=I[_],N=f(w,1+a[p]),G=f(m,1+a[p]);if(0==p)for(var J=0;J<G;J++)for(var W=0;W<N;W++){var j=n+2*(J*N+W);R[J*(w>>>1)+W]=r[j]<<8|r[j+1]}else{var z=[r,8*n],$=[],q=0,V=N*G,X=[0,0],Y=0;for(P=0;q<V;)for(s(z,X),Y=X[0],P=X[1];Y>0;)$[q++]=P,Y--;var Q=(p-1)%3,Z=1!=Q?N:0,K=0!=Q?G:0;for(J=0;J<G;J++){var ee=(J+K)*(w>>>1)+Z,re=J*N;for(W=0;W<N;W++)R[ee+W]=t[$[re+W]+512]*b}if(2==Q){var te=w>>>1,ie=2*N,ne=2*G;for(J=0;J<G;J++)for(W=0;W<ie;W++){T=2*J*te+W;var ae=G*te+(se=J*te+W);0==J?l(R,U,T,ae,se,te):J==G-1?c(R,U,T,ae,se,te):u(R,U,T,ae,se,te)}var oe=R;for(R=U,U=oe,J=0;J<ne;J++)for(W=0;W<N;W++){var se;T=J*te+2*W,ae=N+(se=J*te+W),0==W?l(R,U,T,ae,se,1):W==N-1?c(R,U,T,ae,se,1):u(R,U,T,ae,se,1)}oe=R,R=U,U=oe;for(var fe=[],he=2-~~((p-1)/3),le=0;le<3;le++)fe[le]=y>>14-2*le&3;var ue=fe[he];if(0!=ue)for(J=0;J<ne;J++)for(W=0;W<ie;W++)R[T=J*te+W]=R[T]<<ue}}if(9==p&&3==_){var ce=I[0],de=I[1],ve=I[2],ge=I[3];for(J=0;J<m;J+=2)for(W=0;W<w;W+=2){var we=J*w+W,me=ce[j=(J>>>1)*(w>>>1)+(W>>>1)],pe=de[j]-2048,be=ve[j]-2048,_e=ge[j]-2048,ye=(pe<<1)+me,Ie=(be<<1)+me,Ue=me+_e,Ae=me-_e;D?(h[we]=d(Ue),h[we+1]=d(Ie),h[we+w]=d(ye),h[we+w+1]=d(Ae)):(h[we]=d(ye),h[we+1]=d(Ue),h[we+w]=d(Ae),h[we+w+1]=d(Ie))}}n+=4*F}else if(16388==S)n+=4*F;else if(8192!=C&&8448!=C&&9216!=C)throw S.toString(16)}}console.log(Date.now()-A)}}(),e.decode._decodeLogLuv32=function(e,r,t,i,n,a){for(var o=e.width,s=4*o,f=0,h=new Uint8Array(s);f<i;){for(var l=0;l<s;){var u=r[t+f];if(f++,u<128){for(var c=0;c<u;c++)h[l+c]=r[t+f+c];l+=u,f+=u}else{for(u-=126,c=0;c<u;c++)h[l+c]=r[t+f];l+=u,f++}}for(var d=0;d<o;d++)n[a+0]=h[d],n[a+1]=h[d+o],n[a+2]=h[d+2*o],n[a+4]=h[d+3*o],a+=6}},e.decode._ljpeg_diff=function(r,t,i){var n,a,o=e.decode._getbithuff;return n=o(r,t,i[0],i),0==((a=o(r,t,n,0))&1<<n-1)&&(a-=(1<<n)-1),a},e.decode._decodeARW=function(r,t,i,n,a,o){var s=r.t256[0],f=r.t257[0],h=r.t258[0],l=r.isLE?e._binLE:e._binBE;if(s*f==n||s*f*1.5==n)if(s*f*1.5!=n){var u,c,d,v,g,w,m,p,b=new Uint16Array(16),_=new Uint8Array(s+1);for(M=0;M<f;M++){for(var y=0;y<s;y++)_[y]=t[i++];for(p=0,D=0;D<s-30;p+=16){for(c=2047&(u=l.readUint(_,p)),d=2047&u>>>11,v=15&u>>>22,g=15&u>>>26,w=0;w<4&&128<<w<=c-d;w++);for(m=30,I=0;I<16;I++)I==v?b[I]=c:I==g?b[I]=d:(b[I]=((l.readUshort(_,p+(m>>3))>>>(7&m)&127)<<w)+d,b[I]>2047&&(b[I]=2047),m+=7);for(I=0;I<16;I++,D+=2)L=b[I]<<1,e.decode._putsF(a,(M*s+D)*h,L<<16-h);D-=1&D?1:31}}}else for(var I=0;I<n;I+=3){var U=t[i+I+0],A=t[i+I+1],B=t[i+I+2];a[o+I]=A<<4|U>>>4,a[o+I+1]=U<<4|B>>>4,a[o+I+2]=B<<4|A>>>4}else{f+=8;var E,D,M,P=[i,0,0,0],S=new Uint16Array(32770),C=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],F=0,T=e.decode._ljpeg_diff;for(S[0]=15,E=I=0;I<18;I++)for(var k=32768>>>(C[I]>>>8),x=0;x<k;x++)S[++E]=C[I];for(D=s;D--;)for(M=0;M<f+1;M+=2)if(M==f&&(M=1),F+=T(t,P,S),M<f){var L=4095&F;e.decode._putsF(a,(M*s+D)*h,L<<16-h)}}},e.decode._decodeNikon=function(r,t,i,n,a,o,s){var f=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],h=r.t256[0],l=r.t257[0],u=r.t258[0],c=0,d=0,v=e.decode._make_decoder,g=e.decode._getbithuff,w=t[0].exifIFD.makerNote,m=w.t150?w.t150:w.t140,p=0,b=m[p++],_=m[p++];73!=b&&88!=_||(p+=2110),70==b&&(c=2),14==u&&(c+=3);for(var y=[[0,0],[0,0]],I=r.isLE?e._binLE:e._binBE,U=0;U<2;U++)for(var A=0;A<2;A++)y[U][A]=I.readShort(m,p),p+=2;var B,E,D,M,P,S=1<<u&32767,C=0,F=I.readShort(m,p);p+=2,F>1&&(C=Math.floor(S/(F-1))),68==b&&32==_&&C>0&&(d=I.readShort(m,562));var T=[0,0],k=v(f[c]),x=[n,0,0,0];for(B=0;B<l;B++)for(d&&B==d&&(k=v(f[c+1])),E=0;E<h;E++){U=g(i,x,k[0],k),0==((P=1+(g(i,x,(D=15&U)-(M=U>>>4),0)<<1)<<M>>>1)&1<<D-1)&&(P-=(1<<D)-(0==M?1:0)),E<2?T[E]=y[1&B][E]+=P:T[1&E]+=P;var L=Math.min(Math.max(T[1&E],0),(1<<u)-1),H=(B*h+E)*u;e.decode._putsF(o,H,L<<16-u)}},e.decode._putsF=function(e,r,t){t<<=8-(7&r);var i=r>>>3;e[i]|=t>>>16,e[i+1]|=t>>>8,e[i+2]|=t},e.decode._getbithuff=function(r,t,i,n){e.decode._get_byte;var a,o=t[0],s=t[1],f=t[2],h=t[3];if(0==i||f<0)return 0;for(;!h&&f<i&&-1!=(a=r[o++])&&!(h=0);)s=(s<<8)+a,f+=8;if(a=s<<32-f>>>32-i,n?(f-=n[a+1]>>>8,a=255&n[a+1]):f-=i,f<0)throw"e";return t[0]=o,t[1]=s,t[2]=f,t[3]=h,a},e.decode._make_decoder=function(e){var r,t,i,n,a,o=[];for(r=16;0!=r&&!e[r];r--);var s=17;for(o[0]=r,i=t=1;t<=r;t++)for(n=0;n<e[t];n++,++s)for(a=0;a<1<<r-t;a++)i<=1<<r&&(o[i++]=t<<8|e[s]);return o},e.decode._decodeNewJPEG=function(r,t,i,n,a,o){n=Math.min(n,t.length-i);var s=r.t347,f=s?s.length:0,h=new Uint8Array(f+n);if(s){for(var l=0,u=0;u<f-1&&(255!=s[u]||217!=s[u+1]);u++)h[l++]=s[u];var c=t[i],d=t[i+1];for(255==c&&216==d||(h[l++]=c,h[l++]=d),u=2;u<n;u++)h[l++]=t[i+u]}else for(u=0;u<n;u++)h[u]=t[i+u];if(32803==r.t262[0]||7==r.t259[0]&&34892==r.t262[0]){var v=r.t258[0],g=e.LosslessJpegDecode(h),w=g.length;if(16==v)if(r.isLE)for(u=0;u<w;u++)a[o+(u<<1)]=255&g[u],a[o+(u<<1)+1]=g[u]>>>8;else for(u=0;u<w;u++)a[o+(u<<1)]=g[u]>>>8,a[o+(u<<1)+1]=255&g[u];else if(14==v||12==v||10==v){var m=16-v;for(u=0;u<w;u++)e.decode._putsF(a,u*v,g[u]<<m)}else{if(8!=v)throw new Error("unsupported bit depth "+v);for(u=0;u<w;u++)a[o+u]=g[u]}}else{var p=new e.JpegDecoder;p.parse(h);var b=p.getData({width:p.width,height:p.height,forceRGB:!0,isSourcePDF:!1});for(u=0;u<b.length;u++)a[o+u]=b[u]}6==r.t262[0]&&(r.t262[0]=2)},e.decode._decodeOldJPEGInit=function(e,r,i,n){var a,o,s,f,h,l=216,u=0,c=0,d=!1,v=e.t513,g=v?v[0]:0,w=e.t514,m=w?w[0]:0,p=e.t324||e.t273||v,b=e.t530,_=0,y=0,I=e.t277?e.t277[0]:1,U=e.t515;if(p&&(c=p[0],d=p.length>1),!d){if(255==r[i]&&r[i+1]==l)return{jpegOffset:i};if(null!=v&&(255==r[i+g]&&r[i+g+1]==l?u=i+g:t("JPEGInterchangeFormat does not point to SOI"),null==w?t("JPEGInterchangeFormatLength field is missing"):(g>=c||g+m<=c)&&t("JPEGInterchangeFormatLength field value is invalid"),null!=u))return{jpegOffset:u}}if(null!=b&&(_=b[0],y=b[1]),null!=v&&null!=w)if(m>=2&&g+m<=c){for(a=255==r[i+g+m-2]&&r[i+g+m-1]==l?new Uint8Array(m-2):new Uint8Array(m),s=0;s<a.length;s++)a[s]=r[i+g+s];t("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else t("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==a){var A=0,B=[];B[A++]=255,B[A++]=l;var E=e.t519;if(null==E)throw new Error("JPEGQTables tag is missing");for(s=0;s<E.length;s++)for(B[A++]=255,B[A++]=219,B[A++]=0,B[A++]=67,B[A++]=s,f=0;f<64;f++)B[A++]=r[i+E[s]+f];for(h=0;h<2;h++){var D=e[0==h?"t520":"t521"];if(null==D)throw new Error((0==h?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(s=0;s<D.length;s++){B[A++]=255,B[A++]=196;var M=19;for(f=0;f<16;f++)M+=r[i+D[s]+f];for(B[A++]=M>>>8,B[A++]=255&M,B[A++]=s|h<<4,f=0;f<16;f++)B[A++]=r[i+D[s]+f];for(f=0;f<M;f++)B[A++]=r[i+D[s]+16+f]}}if(B[A++]=255,B[A++]=192,B[A++]=0,B[A++]=8+3*I,B[A++]=8,B[A++]=e.height>>>8&255,B[A++]=255&e.height,B[A++]=e.width>>>8&255,B[A++]=255&e.width,B[A++]=I,1==I)B[A++]=1,B[A++]=17,B[A++]=0;else for(s=0;s<3;s++)B[A++]=s+1,B[A++]=0!=s?17:(15&_)<<4|15&y,B[A++]=s;null!=U&&0!=U[0]&&(B[A++]=255,B[A++]=221,B[A++]=0,B[A++]=4,B[A++]=U[0]>>>8&255,B[A++]=255&U[0]),a=new Uint8Array(B)}var P=-1;for(s=0;s<a.length-1;){if(255==a[s]&&192==a[s+1]){P=s;break}s++}if(-1==P){var S=new Uint8Array(a.length+10+3*I);S.set(a);var C=a.length;if(P=a.length,(a=S)[C++]=255,a[C++]=192,a[C++]=0,a[C++]=8+3*I,a[C++]=8,a[C++]=e.height>>>8&255,a[C++]=255&e.height,a[C++]=e.width>>>8&255,a[C++]=255&e.width,a[C++]=I,1==I)a[C++]=1,a[C++]=17,a[C++]=0;else for(s=0;s<3;s++)a[C++]=s+1,a[C++]=0!=s?17:(15&_)<<4|15&y,a[C++]=s}if(255==r[c]&&218==r[c+1]){var F=r[c+2]<<8|r[c+3];for((o=new Uint8Array(F+2))[0]=r[c],o[1]=r[c+1],o[2]=r[c+2],o[3]=r[c+3],s=0;s<F-2;s++)o[s+4]=r[c+s+4]}else{var T=0;if((o=new Uint8Array(8+2*I))[T++]=255,o[T++]=218,o[T++]=0,o[T++]=6+2*I,o[T++]=I,1==I)o[T++]=1,o[T++]=0;else for(s=0;s<3;s++)o[T++]=s+1,o[T++]=s<<4|s;o[T++]=0,o[T++]=63,o[T++]=0}return{jpegOffset:i,tables:a,sosMarker:o,sofPosition:P}},e.decode._decodeOldJPEG=function(r,t,i,n,a,o){var s,f,h,l,u=e.decode._decodeOldJPEGInit(r,t,i,n);if(null!=u.jpegOffset)for(s=i+n-u.jpegOffset,h=new Uint8Array(s),v=0;v<s;v++)h[v]=t[u.jpegOffset+v];else{for(f=u.tables.length,(h=new Uint8Array(f+u.sosMarker.length+n+2)).set(u.tables),l=f,h[u.sofPosition+5]=r.height>>>8&255,h[u.sofPosition+6]=255&r.height,h[u.sofPosition+7]=r.width>>>8&255,h[u.sofPosition+8]=255&r.width,255==t[i]&&t[i+1]==SOS||(h.set(u.sosMarker,l),l+=sosMarker.length),v=0;v<n;v++)h[l++]=t[i+v];h[l++]=255,h[l++]=EOI}var c=new e.JpegDecoder;c.parse(h);for(var d=c.getData({width:c.width,height:c.height,forceRGB:!0,isSourcePDF:!1}),v=0;v<d.length;v++)a[o+v]=d[v];r.t262&&6==r.t262[0]&&(r.t262[0]=2)},e.decode._decodePackBits=function(e,r,t,i,n){for(var a=new Int8Array(e.buffer),o=new Int8Array(i.buffer),s=r+t;r<s;){var f=a[r];if(r++,f>=0&&f<128)for(var h=0;h<f+1;h++)o[n]=a[r],n++,r++;if(f>=-127&&f<0){for(h=0;h<1-f;h++)o[n]=a[r],n++;r++}}return n},e.decode._decodeThunder=function(e,r,t,i,n){for(var a=[0,1,0,-1],o=[0,1,2,3,0,-3,-2,-1],s=r+t,f=2*n,h=0;r<s;){var l=e[r],u=l>>>6,c=63&l;if(r++,3==u&&(h=15&c,i[f>>>1]|=h<<4*(1-f&1),f++),0==u)for(var d=0;d<c;d++)i[f>>>1]|=h<<4*(1-f&1),f++;if(2==u)for(d=0;d<2;d++)4!=(v=c>>>3*(1-d)&7)&&(h+=o[v],i[f>>>1]|=h<<4*(1-f&1),f++);if(1==u)for(d=0;d<3;d++){var v;2!=(v=c>>>2*(2-d)&3)&&(h+=a[v],i[f>>>1]|=h<<4*(1-f&1),f++)}}},e.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},e.decode._lens=function(){var e=function(e,r,t,i){for(var n=0;n<r.length;n++)e[r[n]]=t+n*i},r="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",t="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",i="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",n="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",a="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";r=r.split(","),t=t.split(","),i=i.split(","),n=n.split(","),a=a.split(",");var o={},s={};return e(o,r,0,1),e(o,i,64,64),e(o,a,1792,64),e(s,t,0,1),e(s,n,64,64),e(s,a,1792,64),[o,s]}(),e.decode._decodeG4=function(r,t,i,n,a,o,s){for(var f=e.decode,h=t<<3,l=0,u="",c=[],d=[],v=0;v<o;v++)d.push(0);d=f._makeDiff(d);for(var g=0,w=0,m=0,p=0,b=0,_=0,y="",I=0,U=8*Math.ceil(o/8);h>>>3<t+i;){m=f._findDiff(d,g+(0==g?0:1),1-b),p=f._findDiff(d,m,b);var A=0;if(1==s&&(A=r[h>>>3]>>>7-(7&h)&1),2==s&&(A=r[h>>>3]>>>(7&h)&1),h++,u+=A,"H"==y){if(null!=f._lens[b][u]){var B=f._lens[b][u];u="",l+=B,B<64&&(f._addNtimes(c,l,b),g+=l,b=1-b,l=0,0==--I&&(y=""))}}else"0001"==u&&(u="",f._addNtimes(c,p-g,b),g=p),"001"==u&&(u="",y="H",I=2),null!=f._dmap[u]&&(w=m+f._dmap[u],f._addNtimes(c,w-g,b),g=w,u="",b=1-b);c.length==o&&""==y&&(f._writeBits(c,n,8*a+_*U),b=0,_++,g=0,d=f._makeDiff(c),c=[])}},e.decode._findDiff=function(e,r,t){for(var i=0;i<e.length;i+=2)if(e[i]>=r&&e[i+1]==t)return e[i]},e.decode._makeDiff=function(e){var r=[];1==e[0]&&r.push(0,1);for(var t=1;t<e.length;t++)e[t-1]!=e[t]&&r.push(t,e[t]);return r.push(e.length,0,e.length,1),r},e.decode._decodeG2=function(r,t,i,n,a,o,s){for(var f=e.decode,h=t<<3,l=0,u="",c=[],d=0,v=0,g=8*Math.ceil(o/8);h>>>3<t+i;){var w=0;1==s&&(w=r[h>>>3]>>>7-(7&h)&1),2==s&&(w=r[h>>>3]>>>(7&h)&1),h++,u+=w,null!=(l=f._lens[d][u])&&(f._addNtimes(c,l,d),u="",l<64&&(d=1-d),c.length==o&&(f._writeBits(c,n,8*a+v*g),c=[],v++,d=0,0!=(7&h)&&(h+=8-(7&h)),l>=64&&(h+=8)))}},e.decode._decodeG3=function(r,t,i,n,a,o,s,f){for(var h=e.decode,l=t<<3,u=0,c="",d=[],v=[],g=0;g<o;g++)d.push(0);for(var w=0,m=0,p=0,b=0,_=0,y=-1,I="",U=0,A=!0,B=8*Math.ceil(o/8);l>>>3<t+i;){p=h._findDiff(v,w+(0==w?0:1),1-_),b=h._findDiff(v,p,_);var E=0;if(1==s&&(E=r[l>>>3]>>>7-(7&l)&1),2==s&&(E=r[l>>>3]>>>(7&l)&1),l++,c+=E,A){if(null!=h._lens[_][c]){var D=h._lens[_][c];c="",u+=D,D<64&&(h._addNtimes(d,u,_),_=1-_,u=0)}}else"H"==I?null!=h._lens[_][c]&&(D=h._lens[_][c],c="",u+=D,D<64&&(h._addNtimes(d,u,_),w+=u,_=1-_,u=0,0==--U&&(I=""))):("0001"==c&&(c="",h._addNtimes(d,b-w,_),w=b),"001"==c&&(c="",I="H",U=2),null!=h._dmap[c]&&(m=p+h._dmap[c],h._addNtimes(d,m-w,_),w=m,c="",_=1-_));c.endsWith("000000000001")&&(y>=0&&h._writeBits(d,n,8*a+y*B),f&&(1==s&&(A=1==(r[l>>>3]>>>7-(7&l)&1)),2==s&&(A=1==(r[l>>>3]>>>(7&l)&1)),l++),c="",_=0,y++,w=0,v=h._makeDiff(d),d=[])}d.length==o&&h._writeBits(d,n,8*a+y*B)},e.decode._addNtimes=function(e,r,t){for(var i=0;i<r;i++)e.push(t)},e.decode._writeBits=function(e,r,t){for(var i=0;i<e.length;i++)r[t+i>>>3]|=e[i]<<7-(t+i&7)},e.decode._decodeLZW=e.decode._decodeLZW=(o=0,s=0,f=0,h=0,l=function(){var e=r>>>3,t=(i[e]<<16|i[e+1]<<8|i[e+2])>>>24-(7&r)-s&(1<<s)-1;return r+=s,t},u=new Uint32Array(16384),c=0,d=function(e){s=e+1,o=h+1},v=function(e){for(var r=e<<2,t=u[r+2],i=a+t-1;65535!=r;)n[i--]=u[r],r=u[r+1];a+=t},g=function(e,r){var t=o<<2,i=e<<2;u[t]=u[3+(r<<2)],u[t+1]=i,u[t+2]=u[i+2]+1,u[t+3]=u[i+3],1+ ++o==1<<s&&12!=s&&s++},function(e,t,s,w,m,p){r=t<<3,i=e,n=w,a=m;var b=t+s<<3,_=0,y=0;for(function(e){if(e!=c){c=e,h=1+(f=1<<e);for(var r=0;r<h+1;r++)u[4*r]=u[4*r+3]=r,u[4*r+1]=65535,u[4*r+2]=1}}(p),d(p);r<b&&(_=l())!=h;){if(_==f){if(d(p),(_=l())==h)break;v(_)}else _<o?(v(_),g(y,_)):(g(y,y),v(o-1));y=_}return a}),e.tags={},e._types=((m=new Array(250)).fill(0),{basic:{main:m=m.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}),e._readIFD=function(r,i,n,a,o,s){var f=r.readUshort(i,n);n+=2;var h={};s.debug&&t("   ".repeat(o),a.length-1,">>>----------------");for(var l=0;l<f;l++){var u=r.readUshort(i,n);n+=2;var c=r.readUshort(i,n);n+=2;var d=r.readUint(i,n);n+=4;var v=r.readUint(i,n);n+=4;var g=[];if(1==c||7==c){var w=d<5?n-4:v;w+d>i.buffer.byteLength&&(d=i.buffer.byteLength-w),g=new Uint8Array(i.buffer,w,d)}if(2==c){var m=d<5?n-4:v,p=i[m],b=Math.max(0,Math.min(d-1,i.length-m));p<128||0==b?g.push(r.readASCII(i,m,b)):g=new Uint8Array(i.buffer,m,b)}if(3==c)for(var _=0;_<d;_++)g.push(r.readUshort(i,(d<3?n-4:v)+2*_));if(4==c||13==c)for(_=0;_<d;_++)g.push(r.readUint(i,(d<2?n-4:v)+4*_));if(5==c||10==c){var y=5==c?r.readUint:r.readInt;for(_=0;_<d;_++)g.push([y(i,v+8*_),y(i,v+8*_+4)])}if(8==c)for(_=0;_<d;_++)g.push(r.readShort(i,(d<3?n-4:v)+2*_));if(9==c)for(_=0;_<d;_++)g.push(r.readInt(i,(d<2?n-4:v)+4*_));if(11==c)for(_=0;_<d;_++)g.push(r.readFloat(i,v+4*_));if(12==c)for(_=0;_<d;_++)g.push(r.readDouble(i,v+8*_));if(0==d||0!=g.length){if(s.debug&&t("   ".repeat(o),u,c,e.tags[u],g),h["t"+u]=g,330==u&&h.t272&&"DSLR-A100"==h.t272[0]);else if(330==u||34665==u||34853==u||50740==u&&r.readUshort(i,r.readUint(g,0))<300||61440==u){var I=50740==u?[r.readUint(g,0)]:g,U=[];for(_=0;_<I.length;_++)e._readIFD(r,i,I[_],U,o+1,s);330==u&&(h.subIFD=U),34665==u&&(h.exifIFD=U[0]),34853==u&&(h.gpsiIFD=U[0]),50740==u&&(h.dngPrvt=U[0]),61440==u&&(h.fujiIFD=U[0])}if(37500==u&&s.parseMN){var A=g;if("Nikon"==r.readASCII(A,0,5))h.makerNote=e.decode(A.slice(10).buffer)[0];else if("OLYMP"==r.readASCII(A,0,5)||"OM SYSTEM"==r.readASCII(A,0,9)){var B=[8208,8224,8240,8256,8272],E=[];e._readIFD(r,A,77==A[1]?16:85==A[5]?12:8,E,o+1,s);var D=h.makerNote=E.pop();for(_=0;_<B.length;_++){var M="t"+B[_];null!=D[M]&&(e._readIFD(r,A,D[M][0],E,o+1,s),D[M]=E.pop())}D.t12288&&(e._readIFD(r,D.t12288,0,E,o+1,s),D.t12288=E.pop())}else r.readUshort(i,v)<300&&r.readUshort(i,v+4)<=12&&(E=[],e._readIFD(r,i,v,E,o+1,s),h.makerNote=E[0])}}else if(t(u,"unknown TIFF tag type: ",c,"num:",d),0==l)return}return a.push(h),s.debug&&t("   ".repeat(o),"<<<---------------"),n},e._writeIFD=function(r,t,i,n,a){var o=Object.keys(a),s=o.length;a.exifIFD&&s--,a.gpsiIFD&&s--,r.writeUshort(i,n,s);for(var f=(n+=2)+12*s+4,h=0;h<o.length;h++){var l=o[h];if("t34665"!=l&&"t34853"!=l){"exifIFD"==l&&(l="t34665"),"gpsiIFD"==l&&(l="t34853");var u=parseInt(l.slice(1)),c=t.main[u];if(null==c&&(c=t.rest[u]),null==c||0==c)throw new Error("unknown type of tag: "+u);var d=a[l];34665==u&&(d=[f],f=e._writeIFD(r,t,i,f,a.exifIFD)[1]),34853==u&&(d=[f],f=e._writeIFD(r,e._types.gps,i,f,a.gpsiIFD)[1]),2==c&&(d=d[0]+"\0");var v=d.length;r.writeUshort(i,n,u),n+=2,r.writeUshort(i,n,c),n+=2,r.writeUint(i,n,v);var g=[-1,1,1,2,4,8,0,1,0,4,8,0,8][c]*v,w=n+=4;if(g>4&&(r.writeUint(i,n,f),w=f),1==c||7==c)for(var m=0;m<v;m++)i[w+m]=d[m];else if(2==c)r.writeASCII(i,w,d);else if(3==c)for(m=0;m<v;m++)r.writeUshort(i,w+2*m,d[m]);else if(4==c)for(m=0;m<v;m++)r.writeUint(i,w+4*m,d[m]);else if(5==c||10==c){var p=5==c?r.writeUint:r.writeInt;for(m=0;m<v;m++){var b=d[m],_=b[0],y=b[1];if(null==_)throw"e";p(i,w+8*m,_),p(i,w+8*m+4,y)}}else if(9==c)for(m=0;m<v;m++)r.writeInt(i,w+4*m,d[m]);else{if(12!=c)throw c;for(m=0;m<v;m++)r.writeDouble(i,w+8*m,d[m])}g>4&&(f+=g+=1&g),n+=4}}return[n,f]},e.toRGBA8=function(e,r){function i(e){return e<.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}var n=e.width,a=e.height,o=n*a,s=e.data,f=new Uint8Array(4*o),h=e.t262?e.t262[0]:2,l=e.t258?Math.min(32,e.t258[0]):1;null==e.t262&&1==l&&(h=0);var u=e.t277?e.t277[0]:e.t258?e.t258.length:[1,1,3,1,1,4,3][h],c=e.t339?e.t339[0]:null;if(1==h&&32==l&&3!=c)throw"e";var d=Math.ceil(u*l*n/8);if(0==h){r=1/256;for(var v=0;v<a;v++){var g=v*d,w=v*n;if(1==l)for(var m=0;m<n;m++){var p=w+m<<2,b=s[g+(m>>3)]>>7-(7&m)&1;f[p]=f[p+1]=f[p+2]=255*(1-b),f[p+3]=255}if(4==l)for(m=0;m<n;m++)p=w+m<<2,b=s[g+(m>>1)]>>4-4*(1&m)&15,f[p]=f[p+1]=f[p+2]=17*(15-b),f[p+3]=255;if(8==l)for(m=0;m<n;m++)p=w+m<<2,b=s[g+m],f[p]=f[p+1]=f[p+2]=255-b,f[p+3]=255;if(16==l)for(m=0;m<n;m++)p=w+m<<2,b=s[(y=g+2*m)+1]<<8|s[y],f[p]=f[p+1]=f[p+2]=Math.min(255,255-~~(b*r)),f[p+3]=255}}else if(1==h){null==r&&(r=1/256);var _=0==(3&s.length)?new Float32Array(s.buffer):null;for(v=0;v<a;v++){if(g=v*d,w=v*n,1==l)for(m=0;m<n;m++)p=w+m<<2,b=s[g+(m>>3)]>>7-(7&m)&1,f[p]=f[p+1]=f[p+2]=255*b,f[p+3]=255;if(2==l)for(m=0;m<n;m++)p=w+m<<2,b=s[g+(m>>2)]>>6-2*(3&m)&3,f[p]=f[p+1]=f[p+2]=85*b,f[p+3]=255;if(8==l)for(m=0;m<n;m++)p=w+m<<2,b=s[g+m*u],f[p]=f[p+1]=f[p+2]=b,f[p+3]=255;if(16==l)for(m=0;m<n;m++)p=w+m<<2,b=s[(y=g+2*m)+1]<<8|s[y],f[p]=f[p+1]=f[p+2]=Math.min(255,~~(b*r)),f[p+3]=255;if(32==l)for(m=0;m<n;m++){var y;p=w+m<<2,b=_[y=(g>>>2)+m],f[p]=f[p+1]=f[p+2]=~~(.5+255*b),f[p+3]=255}}}else if(2==h)if(8==l){if(1==u)for(m=0;m<o;m++)f[4*m]=f[4*m+1]=f[4*m+2]=s[m],f[4*m+3]=255;if(3==u)for(m=0;m<o;m++){var I=3*m;f[p=m<<2]=s[I],f[p+1]=s[I+1],f[p+2]=s[I+2],f[p+3]=255}if(u>=4)for(m=0;m<o;m++)I=m*u,f[p=m<<2]=s[I],f[p+1]=s[I+1],f[p+2]=s[I+2],f[p+3]=s[I+3]}else if(16==l){if(4==u)for(m=0;m<o;m++)I=8*m+1,f[p=m<<2]=s[I],f[p+1]=s[I+2],f[p+2]=s[I+4],f[p+3]=s[I+6];if(3==u)for(m=0;m<o;m++)I=6*m+1,f[p=m<<2]=s[I],f[p+1]=s[I+2],f[p+2]=s[I+4],f[p+3]=255}else{if(32!=l)throw l;var U=new Float32Array(s.buffer),A=0;for(m=0;m<U.length;m++)A=Math.min(A,U[m]);if(A<0)for(m=0;m<s.length;m+=4){var B=s[m];s[m]=s[m+3],s[m+3]=B,B=s[m+1],s[m+1]=s[m+2],s[m+2]=B}var E=[];for(m=0;m<65536;m++)E.push(i(m/65535));for(m=0;m<U.length;m++){var D=Math.max(0,Math.min(1,U[m]));U[m]=E[~~(.5+65535*D)]}if(3==u)for(m=0;m<o;m++)I=3*m,f[p=m<<2]=~~(.5+255*U[I]),f[p+1]=~~(.5+255*U[I+1]),f[p+2]=~~(.5+255*U[I+2]),f[p+3]=255;else{if(4!=u)throw u;for(m=0;m<o;m++)I=4*m,f[p=m<<2]=~~(.5+255*U[I]),f[p+1]=~~(.5+255*U[I+1]),f[p+2]=~~(.5+255*U[I+2]),f[p+3]=~~(.5+255*U[I+3])}}else if(3==h){var M=e.t320,P=1<<l,S=8==l&&u>1&&e.t338&&0!=e.t338[0];for(v=0;v<a;v++)for(var C=0;C<n;C++){p=(m=v*n+C)<<2;var F=0,T=v*d;if(1==l)F=s[T+(C>>>3)]>>>7-(7&C)&1;else if(2==l)F=s[T+(C>>>2)]>>>6-2*(3&C)&3;else if(4==l)F=s[T+(C>>>1)]>>>4-4*(1&C)&15;else{if(8!=l)throw l;F=s[T+C*u]}f[p]=M[F]>>8,f[p+1]=M[P+F]>>8,f[p+2]=M[P+P+F]>>8,f[p+3]=S?s[T+C*u+1]:255}}else if(5==h){var k=u>4?1:0;for(m=0;m<o;m++){p=m<<2;var x=m*u;if(window.UDOC){var L=s[x],H=s[x+1],O=s[x+2],R=s[x+3],N=UDOC.C.cmykToRgb([L*(1/255),H*(1/255),O*(1/255),R*(1/255)]);f[p]=~~(.5+255*N[0]),f[p+1]=~~(.5+255*N[1]),f[p+2]=~~(.5+255*N[2])}else L=255-s[x],H=255-s[x+1],O=255-s[x+2],R=(255-s[x+3])*(1/255),f[p]=~~(L*R+.5),f[p+1]=~~(H*R+.5),f[p+2]=~~(O*R+.5);f[p+3]=255*(1-k)+s[x+4]*k}}else if(6==h&&e.t278){var G=e.t278[0];for(v=0;v<a;v+=G){m=v*n;for(var J=G*n,W=0;W<J;W++){p=4*(m+W),O=s[(x=3*m+4*(W>>>1))+(1&W)];var j=s[x+2]-128,z=s[x+3]-128,$=O+((z>>2)+(z>>3)+(z>>5)),q=O-((j>>2)+(j>>4)+(j>>5))-((z>>1)+(z>>3)+(z>>4)+(z>>5)),V=O+(j+(j>>1)+(j>>2)+(j>>6));f[p]=Math.max(0,Math.min(255,$)),f[p+1]=Math.max(0,Math.min(255,q)),f[p+2]=Math.max(0,Math.min(255,V)),f[p+3]=255}}}else if(32845==h)for(v=0;v<a;v++)for(C=0;C<n;C++){p=4*(v*n+C);var X=s[1+(x=6*(v*n+C))]<<8|s[x],Y=(X=Math.pow(2,(X+.5)/256-64),(s[x+3]+.5)/410),Q=(s[x+5]+.5)/410,Z=9*Y/(6*Y-16*Q+12),K=4*Q/(6*Y-16*Q+12),ee=Z*X/K,re=(1-Z-K)*X/K;$=2.69*ee-1.276*(O=X)-.414*re,q=-1.022*ee+1.978*O+.044*re,V=.061*ee-.224*O+1.163*re,f[p]=255*i(Math.min($,1)),f[p+1]=255*i(Math.min(q,1)),f[p+2]=255*i(Math.min(V,1)),f[p+3]=255}else t("Unknown Photometric interpretation: "+h);return f},e.replaceIMG=function(r){null==r&&(r=document.getElementsByTagName("img"));for(var t=["tif","tiff","dng","cr2","nef"],i=0;i<r.length;i++){var n=r[i],a=n.getAttribute("src");if(null!=a){var o=a.split(".").pop().toLowerCase();if(-1!=t.indexOf(o)){var s=new XMLHttpRequest;e._xhrs.push(s),e._imgs.push(n),s.open("GET",a),s.responseType="arraybuffer",s.onload=e._imgLoaded,s.send()}}}},e._xhrs=[],e._imgs=[],e._imgLoaded=function(r){var t=e._xhrs.indexOf(r.target),i=e._imgs[t];e._xhrs.splice(t,1),e._imgs.splice(t,1),i.setAttribute("src",e.bufferToURI(r.target.response))},e.bufferToURI=function(r){var t=e.decode(r),i=t,n=0,a=i[0];t[0].subIFD&&(i=i.concat(t[0].subIFD));for(var o=0;o<i.length;o++){var s=i[o];if(!(null==s.t258||s.t258.length<3)){var f=s.t256*s.t257;f>n&&(n=f,a=s)}}e.decodeImage(r,a,t);var h=e.toRGBA8(a),l=a.width,u=a.height,c=document.createElement("canvas");c.width=l,c.height=u;var d=c.getContext("2d"),v=new ImageData(new Uint8ClampedArray(h.buffer),l,u);return d.putImageData(v,0,0),c.toDataURL()},e._binBE={nextZero:function(e,r){for(;0!=e[r];)r++;return r},readUshort:function(e,r){return e[r]<<8|e[r+1]},readShort:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+1],i[1]=r[t+0],e._binBE.i16[0]},readInt:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+3],i[1]=r[t+2],i[2]=r[t+1],i[3]=r[t+0],e._binBE.i32[0]},readUint:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+3],i[1]=r[t+2],i[2]=r[t+1],i[3]=r[t+0],e._binBE.ui32[0]},readASCII:function(e,r,t){for(var i="",n=0;n<t;n++)i+=String.fromCharCode(e[r+n]);return i},readFloat:function(r,t){for(var i=e._binBE.ui8,n=0;n<4;n++)i[n]=r[t+3-n];return e._binBE.fl32[0]},readDouble:function(r,t){for(var i=e._binBE.ui8,n=0;n<8;n++)i[n]=r[t+7-n];return e._binBE.fl64[0]},writeUshort:function(e,r,t){e[r]=t>>8&255,e[r+1]=255&t},writeInt:function(r,t,i){var n=e._binBE.ui8;e._binBE.i32[0]=i,r[t+3]=n[0],r[t+2]=n[1],r[t+1]=n[2],r[t+0]=n[3]},writeUint:function(e,r,t){e[r]=t>>24&255,e[r+1]=t>>16&255,e[r+2]=t>>8&255,e[r+3]=t>>0&255},writeASCII:function(e,r,t){for(var i=0;i<t.length;i++)e[r+i]=t.charCodeAt(i)},writeDouble:function(r,t,i){e._binBE.fl64[0]=i;for(var n=0;n<8;n++)r[t+n]=e._binBE.ui8[7-n]}},e._binBE.ui8=new Uint8Array(8),e._binBE.i16=new Int16Array(e._binBE.ui8.buffer),e._binBE.i32=new Int32Array(e._binBE.ui8.buffer),e._binBE.ui32=new Uint32Array(e._binBE.ui8.buffer),e._binBE.fl32=new Float32Array(e._binBE.ui8.buffer),e._binBE.fl64=new Float64Array(e._binBE.ui8.buffer),e._binLE={nextZero:e._binBE.nextZero,readUshort:function(e,r){return e[r+1]<<8|e[r]},readShort:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],e._binBE.i16[0]},readInt:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],i[2]=r[t+2],i[3]=r[t+3],e._binBE.i32[0]},readUint:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],i[2]=r[t+2],i[3]=r[t+3],e._binBE.ui32[0]},readASCII:e._binBE.readASCII,readFloat:function(r,t){for(var i=e._binBE.ui8,n=0;n<4;n++)i[n]=r[t+n];return e._binBE.fl32[0]},readDouble:function(r,t){for(var i=e._binBE.ui8,n=0;n<8;n++)i[n]=r[t+n];return e._binBE.fl64[0]},writeUshort:function(e,r,t){e[r]=255&t,e[r+1]=t>>8&255},writeInt:function(r,t,i){var n=e._binBE.ui8;e._binBE.i32[0]=i,r[t+0]=n[0],r[t+1]=n[1],r[t+2]=n[2],r[t+3]=n[3]},writeUint:function(e,r,t){e[r]=t>>>0&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},writeASCII:e._binBE.writeASCII},e._copyTile=function(e,r,t,i,n,a,o,s){for(var f=Math.min(r,n-o),h=Math.min(t,a-s),l=0;l<h;l++)for(var u=(s+l)*n+o,c=l*r,d=0;d<f;d++)i[u+d]=e[c+d]},e._inflateRaw=((w={H:{}}).H.N=function(e,r){var t,i,n=Uint8Array,a=0,o=0,s=0,f=0,h=0,l=0,u=0,c=0,d=0;if(3==e[0]&&0==e[1])return r||new n(0);var v=w.H,g=v.b,m=v.e,p=v.R,b=v.n,_=v.A,y=v.Z,I=v.m,U=null==r;for(U&&(r=new n(e.length>>>2<<5));0==a;)if(a=g(e,d,1),o=g(e,d+1,2),d+=3,0!=o){if(U&&(r=w.H.W(r,c+(1<<17))),1==o&&(t=I.J,i=I.h,l=511,u=31),2==o){s=m(e,d,5)+257,f=m(e,d+5,5)+1,h=m(e,d+10,4)+4,d+=14;for(var A=1,B=0;B<38;B+=2)I.Q[B]=0,I.Q[B+1]=0;for(B=0;B<h;B++){var E=m(e,d+3*B,3);I.Q[1+(I.X[B]<<1)]=E,E>A&&(A=E)}d+=3*h,b(I.Q,A),_(I.Q,A,I.u),t=I.w,i=I.d,d=p(I.u,(1<<A)-1,s+f,e,d,I.v);var D=v.V(I.v,0,s,I.C);l=(1<<D)-1;var M=v.V(I.v,s,f,I.D);u=(1<<M)-1,b(I.C,D),_(I.C,D,t),b(I.D,M),_(I.D,M,i)}for(;;){var P=t[y(e,d)&l];d+=15&P;var S=P>>>4;if(S>>>8==0)r[c++]=S;else{if(256==S)break;var C=c+S-254;if(S>264){var F=I.q[S-257];C=c+(F>>>3)+m(e,d,7&F),d+=7&F}var T=i[y(e,d)&u];d+=15&T;var k=T>>>4,x=I.c[k],L=(x>>>4)+g(e,d,15&x);for(d+=15&x;c<C;)r[c]=r[c++-L],r[c]=r[c++-L],r[c]=r[c++-L],r[c]=r[c++-L];c=C}}}else{0!=(7&d)&&(d+=8-(7&d));var H=4+(d>>>3),O=e[H-4]|e[H-3]<<8;U&&(r=w.H.W(r,c+O)),r.set(new n(e.buffer,e.byteOffset+H,O),c),d=H+O<<3,c+=O}return r.length==c?r:r.slice(0,c)},w.H.W=function(e,r){var t=e.length;if(r<=t)return e;var i=new Uint8Array(t<<1);return i.set(e,0),i},w.H.R=function(e,r,t,i,n,a){for(var o=w.H.e,s=w.H.Z,f=0;f<t;){var h=e[s(i,n)&r];n+=15&h;var l=h>>>4;if(l<=15)a[f]=l,f++;else{var u=0,c=0;16==l?(c=3+o(i,n,2),n+=2,u=a[f-1]):17==l?(c=3+o(i,n,3),n+=3):18==l&&(c=11+o(i,n,7),n+=7);for(var d=f+c;f<d;)a[f]=u,f++}}return n},w.H.V=function(e,r,t,i){for(var n=0,a=0,o=i.length>>>1;a<t;){var s=e[a+r];i[a<<1]=0,i[1+(a<<1)]=s,s>n&&(n=s),a++}for(;a<o;)i[a<<1]=0,i[1+(a<<1)]=0,a++;return n},w.H.n=function(e,r){for(var t,i,n,a,o=w.H.m,s=e.length,f=o.j,h=0;h<=r;h++)f[h]=0;for(h=1;h<s;h+=2)f[e[h]]++;var l=o.K;for(t=0,f[0]=0,i=1;i<=r;i++)t=t+f[i-1]<<1,l[i]=t;for(n=0;n<s;n+=2)0!=(a=e[n+1])&&(e[n]=l[a],l[a]++)},w.H.A=function(e,r,t){for(var i=e.length,n=w.H.m.r,a=0;a<i;a+=2)if(0!=e[a+1])for(var o=a>>1,s=e[a+1],f=o<<4|s,h=r-s,l=e[a]<<h,u=l+(1<<h);l!=u;)t[n[l]>>>15-r]=f,l++},w.H.l=function(e,r){for(var t=w.H.m.r,i=15-r,n=0;n<e.length;n+=2){var a=e[n]<<r-e[n+1];e[n]=t[a]>>>i}},w.H.M=function(e,r,t){t<<=7&r;var i=r>>>3;e[i]|=t,e[i+1]|=t>>>8},w.H.I=function(e,r,t){t<<=7&r;var i=r>>>3;e[i]|=t,e[i+1]|=t>>>8,e[i+2]|=t>>>16},w.H.e=function(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<t)-1},w.H.b=function(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<t)-1},w.H.Z=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},w.H.i=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},w.H.m=function(){var e=Uint16Array,r=Uint32Array;return{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new e(65536),g:new e(32768)}}(),function(){for(var e=w.H.m,r=0;r<32768;r++){var t=r;t=(4278255360&(t=(4042322160&(t=(3435973836&(t=(2863311530&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8,e.r[r]=(t>>>16|t<<16)>>>17}function i(e,r,t){for(;0!=r--;)e.push(0,t)}for(r=0;r<32;r++)e.q[r]=e.S[r]<<3|e.T[r],e.c[r]=e.p[r]<<4|e.z[r];i(e._,144,8),i(e._,112,9),i(e._,24,7),i(e._,8,8),w.H.n(e._,9),w.H.A(e._,9,e.J),w.H.l(e._,9),i(e.$,32,5),w.H.n(e.$,5),w.H.A(e.$,5,e.h),w.H.l(e.$,5),i(e.Q,19,0),i(e.C,286,0),i(e.D,30,0),i(e.v,320,0)}(),w.H.N),e.LosslessJpegDecode=function(){var e,r;function t(){return e[r++]}function i(){return e[r++]<<8|e[r++]}function n(e){for(var r=t(),i=[0,0,0,255],n=[],o=0;o<16;o++)n[o]=t();for(o=0;o<16;o++)for(var s=0;s<n[o];s++)i[a(i,0,o+1,1)+3]=t();var f=new Uint8Array(256);for(e[r]=[new Uint8Array(i),f],o=0;o<256;o++){for(var h=8,l=o,u=0;255==i[u+3]&&0!=h;)u=i[u+(l>>--h&1)];f[o]=u}}function a(e,r,t,i){if(255!=e[r+3])return 0;if(0==t)return r;for(var n=0;n<2;n++){0==e[r+n]&&(e[r+n]=e.length,e.push(0,0,i,255));var o=a(e,e[r+n],t-1,i+1);if(0!=o)return o}return 0}function o(e){for(var r=e.b,t=e.f;r<25&&e.a<e.d;){var i=e.data[e.a++];255!=i||e.c||e.a++,t=t<<8|i,r+=8}if(r<0)throw"e";e.b=r,e.f=t}function s(e,r){return r.b<e&&o(r),r.f>>(r.b-=e)&65535>>16-e}function f(e,r){var t=e[0],i=0,n=255;r.b<16&&o(r);var a=r.f>>r.b-8&255;for(n=t[(i=e[1][a])+3],r.b-=t[i+2];255==n;)n=t[(i=t[i+(r.f>>--r.b&1)])+3];return n}function h(e,r){return e<32768>>16-r&&(e+=1-(1<<r)),e}function l(e,r){var t=f(e,r);return 0==t?0:16==t?-32768:h(s(t,r),t)}function u(e,r,t,i,n,a){for(var o=0,s=0;s<a;s++){for(var f=s*r,h=0;h<r;h+=n){o++;for(var u=0;u<n;u++)e[f+h+u]=l(i[u],t)}if(0!=t.e&&o%t.e==0&&0!=s){for(var c=t.a,d=t.data;255!=d[c]||!(208<=d[c+1]&&d[c+1]<=215);)c--;t.a=c+2,t.f=0,t.b=0}}}function c(e,r){return h(s(e,r),e)}function d(e,r,t,i,n,a,o,s){for(var f=t*o,h=n;h<a;h++)e[h]+=1<<s-1;for(var l=o;l<f;l+=o)for(h=n;h<a;h++)e[l+h]+=e[l+h-o];for(var u=1;u<i;u++){var c=u*f;for(h=n;h<a;h++)e[c+h]+=e[c+h-f];for(l=o;l<f;l+=o)for(h=n;h<a;h++){var d=c+l+h,v=d-f,g=e[d-o],w=0;if(0==r)w=0;else if(1==r)w=g;else if(2==r)w=e[v];else if(3==r)w=e[v-o];else if(4==r)w=g+(e[v]-e[v-o]);else if(5==r)w=g+(e[v]-e[v-o]>>>1);else if(6==r)w=e[v]+(g-e[v-o]>>>1);else{if(7!=r)throw r;w=g+e[v]>>>1}e[d]+=w}}}return function(a){if(e=a,r=0,65496!=i())throw"e";for(var o=[],s=0,h=0,l=0,v=[],g=[],w=[],m=0,p=0,b=0;;){var _=i();if(65535!=_){var y=i();if(65475==_){h=t(),p=i(),b=i(),m=t();for(var I=0;I<m;I++){var U=t(),A=t();if(0!=t())throw"e";o[U]=[I,A>>4,15&A]}}else if(65476==_)for(var B=r+y-2;r<B;)n(g);else{if(65498==_){for(r++,I=0;I<m;I++){var E=o[t()];w[E[0]]=g[t()>>>4],v[E[0]]=E.slice(1)}s=t(),r+=2;break}65501==_?l=i():r+=y-2}}else r--}var D=new(h>8?Uint16Array:Uint8Array)(p*b*m),M={b:0,f:0,c:8==s,a:r,data:e,d:e.length,e:l};if(M.c)!function(t,i,n,a,o){for(var s=e.length-r,h=0;h<s;h+=4){var l=e[r+h];e[r+h]=e[r+h+3],e[r+h+3]=l,l=e[r+h+1],e[r+h+1]=e[r+h+2],e[r+h+2]=l}for(var u=0;u<o;u++)for(var d=32768,v=32768,g=0;g<i;g+=2){var w=f(a,n),m=f(a,n);0!=w&&(d+=c(w,n)),0!=m&&(v+=c(m,n)),t[u*i+g]=65535&d,t[u*i+g+1]=65535&v}}(D,b*m,M,w[0],p);else{var P=[],S=0,C=0;for(I=0;I<m;I++){var F=v[I];(J=F[0])>S&&(S=J),(G=F[1])>C&&(C=G),P.push(J*G)}if(1!=S||1!=C){if(3!=m||1!=P[1]||1!=P[2])throw"e";if(2!=S||1!=C&&2!=C)throw"e";var T=[],k=0;for(I=0;I<m;I++){for(var x=0;x<P[I];x++)T.push(w[I]);k+=P[I]}var L=b/S,H=p/C,O=L*H;u(D,L*k,M,T,k,H),d(D,s,L,H,k-2,k,k,h);var R=new Uint16Array(O*P[0]);if(2==S&&2==C){for(I=0;I<O;I++)R[4*I]=D[6*I],R[4*I+1]=D[6*I+1],R[4*I+2]=D[6*I+2],R[4*I+3]=D[6*I+3];for(d(R,s,4*L,H,0,1,1,h),I=0;I<O;I++)D[6*I]=R[4*I],D[6*I+1]=R[4*I+1],D[6*I+2]=R[4*I+2],D[6*I+3]=R[4*I+3]}if(2==S&&1==C){for(I=0;I<O;I++)R[2*I]=D[4*I],R[2*I+1]=D[4*I+1];for(d(R,s,2*L,H,0,1,1,h),I=0;I<O;I++)D[4*I]=R[2*I],D[4*I+1]=R[2*I+1]}for(var N=D.slice(0),G=0;G<p;G++)if(2==C)for(var J=0;J<b;J++){var W=((G>>>1)*L+(J>>>1))*k,j=2*(1&G)+(1&J);D[z=(G*b+J)*m]=N[W+j],D[z+1]=N[W+4],D[z+2]=N[W+5]}else for(J=0;J<b;J++){var z;W=(G*L+(J>>>1))*k,j=1&J,D[z=(G*b+J)*m]=N[W+j],D[z+1]=N[W+2],D[z+2]=N[W+3]}}else if(u(D,b*m,M,w,m,p),0==l)d(D,s,b,p,0,m,m,h);else{var $=Math.floor(l/b);for(G=0;G<p;G+=$){var q=D.slice(G*b*m,(G+$)*b*m);d(q,s,b,$,0,m,m,h),D.set(q,G*b*m)}}}return D}}(),function(){var r=2,t=4,i=5,n=6,a=7,o=12,s=13,f=14,h=15,l=17;function u(e){for(var r=[[],[],[]],t=Math.max(2,e.w+32>>>6),i=0;i<3;i++)for(var n=0;n<41;n++)r[i][n]=[t,1];return r}function c(e,r){var t=0,i=8-e.a;if(e.j,e.a,r){if(r>=i)do{t<<=i,r-=i,t|=e[e.j]&(1<<i)-1,e.j++,i=8}while(r>=8);r&&(t<<=r,i-=r,t|=e[e.j]>>>i&(1<<r)-1),e.a=8-i}return t}function d(e,r,t,i,n,a,o,s){null==s&&(s=0);var f,h,l,u,d,v,g=a+1,w=g%2,m=0,p=i[n],b=i[n-1],_=i[n-2][g],y=b[g-1],I=b[g],U=b[g+1],A=p[g-1],B=p[g+1],E=Math.abs;if(w&&(l=E(U-I),u=E(_-I),d=E(y-I)),w){if(v=(v=l>d&&u<l?_+y:l<d&&u<d?_+U:U+y)+2*I>>>2,s)return void(p[g]=v);f=r.t*r.c[e.g+I-_]+r.c[e.g+y-I]}else v=I>y&&I>U||I<y&&I<U?B+A+2*I>>>2:A+B>>>1,f=r.t*r.c[e.g+I-y]+r.c[e.g+y-A];h=E(f);var D=function(e){for(var r=-1,t=0;!t;r++)t=e[e.j]>>>7-e.a&1,e.a++,e.a&=7,e.a||e.j++;return r}(t);if(D<e.n-r.v-1){var M=function(e,r){var t=0;if(r<e)for(;t<=14&&r<<++t<e;);return t}(o[h][0],o[h][1]);m=c(t,M)+(D<<M)}else m=c(t,r.v)+1;m=1&m?-1-(m>>>1):m>>>1,o[h][0]+=E(m),o[h][1]==e.f&&(o[h][0]>>>=1,o[h][1]>>>=1),o[h][1]++,v=f<0?v-m:v+m,e.i&&(v<0?v+=r.w:v>e.g&&(v-=r.w)),p[g]=v>=0?Math.min(v,e.g):0}function v(e,r,t){for(var i=e[0].length,n=r;n<=t;n++)e[n][0]=e[n-1][1],e[n][i-1]=e[n-1][i-2]}function g(e){v(e,a,o),v(e,r,t),v(e,h,l)}function w(e,r,i,n,a,o,f,h,l,u,c,v,w){for(var m=0,p=1,b=a<s&&a>t;p<e.m;)m<e.m&&(d(e,r,i,n,a,m,f[l],e.h&&(b&&u||!b&&(c||(m&v)==w))),d(e,r,i,n,o,m,f[l],e.h&&(!b&&u||b&&(c||(m&v)==w))),m+=2),m>8&&(d(e,r,i,n,a,p,h[l]),d(e,r,i,n,o,p,h[l]),p+=2);g(n)}function m(e,i,n,s,f,u){w(e,i,n,s,r,a,f,u,0,0,1,0,8),w(e,i,n,s,8,h,f,u,1,0,1,0,8),w(e,i,n,s,3,9,f,u,2,1,0,3,0),w(e,i,n,s,10,16,f,u,0,0,0,3,2),w(e,i,n,s,t,11,f,u,1,0,0,3,2),w(e,i,n,s,o,l,f,u,2,1,0,3,0)}function p(e,t,i,n,o,s){var f=s.length,l=e.l;o+1==e.s&&(l=e.e-o*e.l);for(var u=6*e.e*n+o*e.l,c=0;c<6;c++){for(var d=0;d<l;d++){var v,g=s[c%f][d%f];v=0==g?r+(c>>>1):2==g?h+(c>>>1):a+c;var w=e.h?(2*d/3&2147483646|d%3&1)+(d%3>>>1):d>>>1;t[u+d]=i[v][w+1]}u+=e.e}}e._decompressRAF=function(a,h){var c=function(r){var t=e._binBE.readUshort,i={b:t(r,0),i:r[2],C:r[3],u:r[4],q:t(r,5),k:t(r,7),e:t(r,9),l:t(r,11),s:r[13],d:t(r,14)};if(18771!=i.b||i.i>1||i.q<6||i.q%6||i.e<768||i.e%24||768!=i.l||i.k<i.l||i.k%i.l||i.k-i.e>=i.l||i.s>16||i.s!=i.k/i.l||i.s!=Math.ceil(i.e/i.l)||i.d!=i.q/6||12!=i.u&&14!=i.u&&16!=i.u||16!=i.C&&0!=i.C)throw"Invalid data";if(0==i.i)throw"Not implemented. We need this file!";return i.h=16==i.C,i.m=0|(i.h?2*i.l/3:i.l>>>1),i.A=i.m+2,i.f=64,i.g=(1<<i.u)-1,i.n=4*i.u,i}(a),d=function(r,t){var i=new Array(t.s),n=4*t.s,a=16+n;12&n&&(a+=16-(12&n));for(var o=0,s=16;o<t.s;s+=4){var f=e._binBE.readUint(r,s);i[o]=r.slice(a,a+f),i[o].j=0,i[o].a=0,a+=f,o++}if(a!=r.length)throw"Invalid data";return i}(a,c),v=function(e){var r={c:new Int8Array(2<<e.u)};return function(e,r,t){var i=[0,18,67,276,t];e.o=0,e.w=(i[4]+0)/1+1|0,e.v=Math.ceil(Math.log2(e.w)),e.t=9,function(e,r){for(var t=-r[4],i=0;t<=r[4];i++,t++)e[i]=t<=-r[3]?-4:t<=-r[2]?-3:t<=-r[1]?-2:t<-r[0]?-1:t<=r[0]?0:t<r[1]?1:t<r[2]?2:t<r[3]?3:4}(e.c,i)}(r,0,e.g),r}(c),w=new Int16Array(c.e*c.q);null==h&&(h=c.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var b=[[0,3],[1,t],[i,11],[n,o],[s,16],[f,l]],_=[],y=0;y<18;y++)_[y]=new Uint16Array(c.A);for(var I=0;I<c.s;I++){var U=u(v),A=u(v);for(y=0;y<18;y++)for(var B=0;B<c.A;B++)_[y][B]=0;for(var E=0;E<c.d;E++){for(m(c,v,d[I],_,U,A),y=0;y<6;y++)for(B=0;B<c.A;B++)_[b[y][0]][B]=_[b[y][1]][B];for(p(c,w,_,E,I,h),y=r;y<18;y++)if(-1==[i,n,s,f].indexOf(y))for(B=0;B<c.A;B++)_[y][B]=0;g(_)}}return w}}()}(r)}()}},r={};function t(i){var n=r[i];if(void 0!==n)return n.exports;var a=r[i]={exports:{}};return e[i](a,a.exports,t),a.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{"use strict";var e=t(57),r=t.n(e);class i{#e=null;#r=0;#t=0;#i=!1;#n=null;imageProperties={currentRotation:0,currentScale:1};constructor(){}resetTransform(){this.#r=0,this.#t=0,this.imageProperties.currentScale=1,this.applyTransform()}applyTransform(e=!1){var r=`translate(${this.#r}px, ${this.#t}px) `;this.#e.classList.remove("rotate90"),this.#e.classList.remove("rotate270"),90===this.imageProperties.currentRotation&&e?(this.#e.classList.add("rotate90"),r="translateX(0%) translateY(-100%) "):270===this.imageProperties.currentRotation&&e&&(this.#e.classList.add("rotate270"),r="translateX(-100%) translateY(0%) "),this.#e.style.transform=r+` scale(${this.imageProperties.currentScale}) rotate(${this.imageProperties.currentRotation}deg)`}rotate(e,r=null){this.imageProperties.currentRotation=(this.imageProperties.currentRotation+e)%360,0!==r||1===this.imageProperties.currentScale?this.applyTransform(!0):this.resetTransform(!0)}zoomOnly(e,r=!0){e?this.imageProperties.currentScale*=1.2:this.imageProperties.currentScale/=1.2,r&&this.applyTransform()}setImage(e){this.#e=e,this.#i=!1,this.#n=null,this.#e.onmousedown=e=>{this.mousedown(e)},this.#e.onwheel=e=>{this.onwheel(e)},this.#e.ondblclick=()=>{this.zoomOnly(!0)},this.applyTransform()}mousedown(e){e.preventDefault(),this.#i=!0,this.#e.style.cursor="grabbing",this.#n={x:e.clientX-this.#r,y:e.clientY-this.#t}}mousemoved(e){this.#i&&(0!==e.buttons?(this.#r=e.clientX-this.#n.x,this.#t=e.clientY-this.#n.y,this.applyTransform()):this.#i=!1)}mousereleased(){this.#i&&(this.#i=!1,this.#e.style.cursor="grab")}onwheel(e){e.preventDefault();const r=e.wheelDelta?e.wheelDelta:-e.deltaY;this.zoomOnly(r>0,!1),this.applyTransform()}}class n{#e=null;#a=0;constructor(e,r){this.imageContainerId=e,this.imageContainer=document.querySelector("#"+e),this.toolbar=document.querySelector(r),this.toolbar.innerText="",this.zoomer=new i,this.addButton("btn-secondary rotateLeft","fa-solid fa-rotate-left","",(()=>this.rotateFix(270))),this.addButton("btn-secondary rotate180","fa-solid fa-arrows-rotate","",(()=>this.rotateFix(180))),this.addButton("btn-secondary rotateRight","fa-solid fa-rotate-right","",(()=>this.rotateFix(90))),this.addButton("btn-secondary","fa-solid fa-maximize","",(()=>{this.fitBest(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","fa-solid fa-arrows-left-right","",(()=>{this.fitWidth(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","","100%",(()=>{this.originalSize(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","fa-solid fa-magnifying-glass-plus","",(()=>{this.zoomer.zoomOnly(!0)})),this.addButton("btn-secondary","fa-solid fa-magnifying-glass-minus","",(()=>{this.zoomer.zoomOnly(!1)})),window.addEventListener("mousemove",(e=>this.zoomer.mousemoved(e))),window.addEventListener("mouseup",(e=>this.zoomer.mousereleased(e)))}get image(){return this.#e}set image(e){switch(this.#e=e,this.#a){case 1:this.fitWidth();break;case 2:this.originalSize();break;default:this.fitBest()}this.zoomer.setImage(this.#e)}createButton(e,r,t,i){const n=document.createElement("button");return e&&e.split(" ").forEach((e=>{n.classList.add(e)})),n.classList.add("btn","rotate-button"),r&&(n.innerHTML=`<i class="fas ${r}"></i>`),n.innerHTML+=` ${t}`,n.addEventListener("click",i),n}addButton(e,r,t,i){const n=this.createButton(e,r,t,i);this.toolbar.appendChild(n)}rotateFix(e){this.zoomer.rotate(e,this.#a)}fitBest(){this.#a=0,this.#e.style.width="auto",this.#e.style.height="auto",this.#e.style.maxWidth="100%",this.#e.style.maxHeight="100%",this.centerTheImage()}fitWidth(){this.#a=1,this.#e.style.width="100%",this.#e.style.height="auto",this.#e.style.maxWidth="none",this.#e.style.maxHeight="none",this.topLeftImage()}originalSize(){this.#a=2,this.#e.style.width="auto",this.#e.style.height="auto",this.#e.style.maxWidth="none",this.#e.style.maxHeight="none",this.topLeftImage()}topLeftImage(){this.imageContainer.style.display="",this.imageContainer.style.alignItems="",this.imageContainer.style.justifyContent=""}centerTheImage(){this.imageContainer.style.display="flex",this.imageContainer.style.alignItems="center",this.imageContainer.style.justifyContent="center"}}class a{constructor(e,r,t){this.numPages=e,this.currentPage=1,this.toolbarSelector=r,this.gotoCallback=t,this.toolbar=this.createToolbar()}createToolbar(){const e=document.querySelector(this.toolbarSelector);if(this.numPages&&this.numPages<2)return void(e.innerText=" Page 1/1");e.innerText="",this.firstButton=this.createButton("btn-secondary","fa-solid fa-backward-step","",this.goToPage.bind(this,1)),this.prevButton=this.createButton("btn-secondary","fa-solid fa-left-long","",this.goToPreviousPage.bind(this)),this.nextButton=this.createButton("btn-secondary","fa-solid fa-right-long","",this.goToNextPage.bind(this)),this.lastButton=this.createButton("btn-secondary","fa-solid fa-forward-step","",this.goToPage.bind(this,this.numPages));const r=document.createElement("input");r.classList.add("pageNumber"),r.type="number",r.min=1,r.max=this.numPages,r.value=1,r.style.width=this.numPages.toString().length+3+"ch",r.style.textAlign="right",r.addEventListener("change",this.goToPage.bind(this,null));const t=document.createElement("span");return t.classList.add("pageCount"),t.innerHTML=" / "+this.numPages.toString(),this.firstButton.disabled=!0,e.appendChild(this.firstButton),this.prevButton.disabled=!0,e.appendChild(this.prevButton),e.appendChild(r),e.appendChild(t),e.appendChild(this.nextButton),e.appendChild(this.lastButton),e}createButton(e,r,t,i){const n=document.createElement("button");return e&&e.split(" ").forEach((e=>{n.classList.add(e)})),n.classList.add("btn","navigation-button"),n.innerHTML=`<i class="fas ${r}"></i> ${t}`,n.addEventListener("click",i),n}goToPage(e){const r=document.querySelector(this.toolbarSelector+" .pageNumber");e?(this.currentPage=parseInt(e),r.value=this.currentPage):this.currentPage=parseInt(r.value),this.firstButton.disabled=!1,this.prevButton.disabled=!1,this.nextButton.disabled=!1,this.lastButton.disabled=!1,1==this.currentPage?(this.firstButton.disabled=!0,this.prevButton.disabled=!0):this.currentPage==this.numPages&&(this.nextButton.disabled=!0,this.lastButton.disabled=!0),console.log(`Navigating to page ${this.currentPage}`),this.gotoCallback()}goToPreviousPage(){this.currentPage>1&&this.goToPage(this.currentPage-1)}goToNextPage(){this.currentPage<this.numPages&&this.goToPage(this.currentPage+1)}}window.AptTec=window.AptTec||{},window.AptTec.ViewerSources=Object.freeze({Url:"Url",Blob:"Blob",ArrayBuffer:"ArrayBuffer",DataURL:"DataURL"}),window.AptTec.Viewer=class{#o="";#s=null;#f=null;#h=null;#l=null;#u=null;#c=null;#d=null;constructor(e,r,t,i,a,o){if(!e)throw new Error("Mandatory argument 'viewerSource' is missing");if(!r)throw new Error("Mandatory argument 'source' is missing");if(!t)throw new Error("Mandatory argument 'fileFormat' is missing");if(!i)throw new Error("Mandatory argument 'imageContainerId' is missing");this.#c=t,this.#o=e,this.#s=r,this.#o===window.AptTec.ViewerSources.ArrayBuffer?(this.#h=r,this.#d=this.#o):this.#o===window.AptTec.ViewerSources.DataURL&&(this.#l=r,this.#d=this.#o),this.imageContainerId=i,this.toolbarContainer=a,this.pageToolbarContainer=o,this.imageSelector=`#${this.imageContainerId} #viewerImage`,this.imageOperations=new n(this.imageContainerId,this.toolbarContainer),this.navigationToolbar=null}async show(e=1){this.#d&&this.loadImage(e),this.#o===window.AptTec.ViewerSources.Url?await fetch(this.#s).then((e=>e.blob())).then((r=>this.loadfromBlob(r,e))):this.#o===window.AptTec.ViewerSources.Blob&&await this.loadfromBlob(this.#s,e)}async loadfromBlob(e,r){this.#c.includes("/tif")?await e.arrayBuffer().then((e=>{this.#d=window.AptTec.ViewerSources.ArrayBuffer,this.#h=e,this.loadImage(r)})):this.blobToDataURL(e,(function(e){this.#d=window.AptTec.ViewerSources.DataURL,this.#l=e,this.loadImage(r)}))}blobToDataURL(e,r){var t=new FileReader;t.onload=e=>{r(e.target.result)},t.readAsDataURL(e)}loadImage(e){const r=document.getElementById(this.imageContainerId);r.innerHTML="",r.innerHTML='<img id="viewerImage" alt="ViewerImage">',this.imageOperations.image=document.querySelector(this.imageSelector),this.#f&&URL.revokeObjectURL(this.#f),this.#d===window.AptTec.ViewerSources.DataURL?(this.#f=this.#l,this.pageCount=1):this.#f=this.#v(this.#h,e),this.navigationToolbar||(this.navigationToolbar=new a(this.pageCount,this.pageToolbarContainer,(()=>this.pagechanged()))),this.imageOperations.image.src=this.#f}pagechanged(){console.log(`Page changed to ${this.navigationToolbar.currentPage}`),this.loadImage(this.navigationToolbar.currentPage)}#v(e,t){const i=t-1;this.#u||(this.#u=r().decode(e),this.pageCount=this.#u.length);var n=this.#u,a=0,o=n[i];this.#u[i].subIFD&&(n=n.concat(this.#u[i].subIFD));for(var s=0;s<n.length;s++){var f=n[s];if(!(null==f.t258||f.t258.length<3)){var h=f.t256*f.t257;h>a&&(a=h,o=f)}}r().decodeImage(e,o,this.#u);var l=o.width,u=o.height;const c=r().toRGBA8(o);var d=document.createElement("canvas");d.width=l,d.height=u;var v=d.getContext("2d"),g=new ImageData(new Uint8ClampedArray(c.buffer),l,u);return v.putImageData(g,0,0),d.toDataURL()}}})()})();
//# sourceMappingURL=AptTecImageViewer.bundle.js.map