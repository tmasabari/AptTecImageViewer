(()=>{var e={57:e=>{!function(){var r={};function t(){"undefined"==typeof process&&console.log.apply(console,arguments)}e.exports=r,function(e){var r,i,n,a,o,s,f,l,h,u,d,c,v,g,w,m;!function(){"use strict";var r=function(){function e(e){this.message="JPEG error: "+e}return e.prototype=new Error,e.prototype.name="JpegError",e.constructor=e,e}(),t=function(){var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,n=799,a=3406,o=2276,s=1567,f=3784,l=5793,h=2896;function u(e){null==e&&(e={}),null==e.w&&(e.w=-1),this.V=e.n,this.N=e.w}function d(e,r){for(var t,i,n,a=0,o=[],s=16;s>0&&!e[s-1];)s--;o.push({children:[],index:0});var f=o[0];for(t=0;t<s;t++){for(i=0;i<e[t];i++){for((f=o.pop()).children[f.index]=r[a];f.index>0;)f=o.pop();for(f.index++,o.push(f);o.length<=t;)o.push(n={children:[],index:0}),f.children[f.index]=n.children,f=n;a++}t+1<s&&(o.push(n={children:[],index:0}),f.children[f.index]=n.children,f=n)}return o[0].children}function c(e,r,t){return 64*((e.P+1)*r+t)}function v(t,n,a,o,s,f,l,h,u,d){null==d&&(d=!1);var v,g,w,p,b,y,_,I,A,U,B,E=a.m,D=a.Z,T=n,C=0,M=0,P=0,S=0,F=0,L=0;function x(){if(M>0)return M--,C>>M&1;if(255===(C=t[n++])){var e=t[n++];if(e){if(220===e&&d){var o=i(t,n+=2);if(n+=2,o>0&&o!==a.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",o)}else if(217===e){if(d){var s=8*F;if(s>0&&s<a.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",s)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new r("unexpected marker")}}return M=7,C>>>7}function k(e){for(var t=e;;){switch(typeof(t=t[x()])){case"number":return t;case"object":continue}throw new r("invalid huffman sequence")}}function O(e){for(var r=0;e>0;)r=r<<1|x(),e--;return r}function R(e){if(1===e)return 1===x()?1:-1;var r=O(e);return r>=1<<e-1?r:r+(-1<<e)+1}function H(e,r,t,i,n){var a=t%E;F=(t/E|0)*e.A+i;var o=a*e.h+n;r(e,c(e,F,o))}function N(e,r,t){F=t/e.P|0;var i=t%e.P;r(e,c(e,F,i))}var G=o.length;for(_=D?0===f?0===h?function(e,r){var t=k(e.J),i=0===t?0:R(t)<<u;e.D[r]=e.Q+=i}:function(e,r){e.D[r]|=x()<<u}:0===h?function(r,t){if(P>0)P--;else for(var i=f,n=l;i<=n;){var a=k(r.i),o=15&a,s=a>>4;if(0!==o){var h=e[i+=s];r.D[t+h]=R(o)*(1<<u),i++}else{if(s<15){P=O(s)+(1<<s)-1;break}i+=16}}}:function(t,i){for(var n,a,o=f,s=l,h=0;o<=s;){var d=i+e[o],c=t.D[d]<0?-1:1;switch(S){case 0:if(h=(a=k(t.i))>>4,0==(n=15&a))h<15?(P=O(h)+(1<<h),S=4):(h=16,S=1);else{if(1!==n)throw new r("invalid ACn encoding");v=R(n),S=h?2:3}continue;case 1:case 2:t.D[d]?t.D[d]+=c*(x()<<u):0==--h&&(S=2===S?3:0);break;case 3:t.D[d]?t.D[d]+=c*(x()<<u):(t.D[d]=v<<u,S=0);break;case 4:t.D[d]&&(t.D[d]+=c*(x()<<u))}o++}4===S&&0==--P&&(S=0)}:function(r,t){var i=k(r.J),n=0===i?0:R(i),a=1;for(r.D[t]=r.Q+=n;a<64;){var o=k(r.i),s=15&o,f=o>>4;if(0!==s){var l=e[a+=f];r.D[t+l]=R(s),a++}else{if(f<15)break;a+=16}}},A=1===G?o[0].P*o[0].c:E*a.R;L<=A;){var W=s?Math.min(A-L,s):A;if(W>0){for(w=0;w<G;w++)o[w].Q=0;if(P=0,1===G)for(g=o[0],y=0;y<W;y++)N(g,_,L),L++;else for(y=0;y<W;y++){for(w=0;w<G;w++)for(U=(g=o[w]).h,B=g.A,p=0;p<B;p++)for(b=0;b<U;b++)H(g,_,L,p,b);L++}}if(M=0,!(I=m(t,n)))break;if(I.u&&(n=I.offset),!(I.M>=65488&&I.M<=65495))break;n+=2}return n-T}function g(e,i,u){var d,c,v,g,w,m,p,b,y,_,I,A,U,B,E,D,T,C=e.$,M=e.D;if(!C)throw new r("missing required Quantization Table.");for(var P=0;P<64;P+=8)y=M[i+P],_=M[i+P+1],I=M[i+P+2],A=M[i+P+3],U=M[i+P+4],B=M[i+P+5],E=M[i+P+6],D=M[i+P+7],y*=C[P],0!=(_|I|A|U|B|E|D)?(_*=C[P+1],I*=C[P+2],A*=C[P+3],U*=C[P+4],B*=C[P+5],E*=C[P+6],D*=C[P+7],c=(d=(d=l*y+128>>8)+(c=l*U+128>>8)+1>>1)-c,T=(v=I)*f+(g=E)*s+128>>8,v=v*s-g*f+128>>8,p=(w=(w=h*(_-D)+128>>8)+(p=B<<4)+1>>1)-p,m=(b=(b=h*(_+D)+128>>8)+(m=A<<4)+1>>1)-m,g=(d=d+(g=T)+1>>1)-g,v=(c=c+v+1>>1)-v,T=w*o+b*a+2048>>12,w=w*a-b*o+2048>>12,b=T,T=m*n+p*t+2048>>12,m=m*t-p*n+2048>>12,p=T,u[P]=d+b,u[P+7]=d-b,u[P+1]=c+p,u[P+6]=c-p,u[P+2]=v+m,u[P+5]=v-m,u[P+3]=g+w,u[P+4]=g-w):(T=l*y+512>>10,u[P]=T,u[P+1]=T,u[P+2]=T,u[P+3]=T,u[P+4]=T,u[P+5]=T,u[P+6]=T,u[P+7]=T);for(var S=0;S<8;++S)y=u[S],0!=((_=u[S+8])|(I=u[S+16])|(A=u[S+24])|(U=u[S+32])|(B=u[S+40])|(E=u[S+48])|(D=u[S+56]))?(c=(d=4112+((d=l*y+2048>>12)+(c=l*U+2048>>12)+1>>1))-c,T=(v=I)*f+(g=E)*s+2048>>12,v=v*s-g*f+2048>>12,g=T,p=(w=(w=h*(_-D)+2048>>12)+(p=B)+1>>1)-p,m=(b=(b=h*(_+D)+2048>>12)+(m=A)+1>>1)-m,T=w*o+b*a+2048>>12,w=w*a-b*o+2048>>12,b=T,T=m*n+p*t+2048>>12,m=m*t-p*n+2048>>12,(y=(d=d+g+1>>1)+b)<16?y=0:y>=4080?y=255:y>>=4,(_=(c=c+v+1>>1)+(p=T))<16?_=0:_>=4080?_=255:_>>=4,(I=(v=c-v)+m)<16?I=0:I>=4080?I=255:I>>=4,(A=(g=d-g)+w)<16?A=0:A>=4080?A=255:A>>=4,(U=g-w)<16?U=0:U>=4080?U=255:U>>=4,(B=v-m)<16?B=0:B>=4080?B=255:B>>=4,(E=c-p)<16?E=0:E>=4080?E=255:E>>=4,(D=d-b)<16?D=0:D>=4080?D=255:D>>=4,M[i+S]=y,M[i+S+8]=_,M[i+S+16]=I,M[i+S+24]=A,M[i+S+32]=U,M[i+S+40]=B,M[i+S+48]=E,M[i+S+56]=D):(T=(T=l*y+8192>>14)<-2040?0:T>=2024?255:T+2056>>4,M[i+S]=T,M[i+S+8]=T,M[i+S+16]=T,M[i+S+24]=T,M[i+S+32]=T,M[i+S+40]=T,M[i+S+48]=T,M[i+S+56]=T)}function w(e,r){for(var t=r.P,i=r.c,n=new Int16Array(64),a=0;a<i;a++)for(var o=0;o<t;o++)g(r,c(r,a,o),n);return r.D}function m(e,r,t){null==t&&(t=r);var n=e.length-1,a=t<r?t:r;if(r>=n)return null;var o=i(e,r);if(o>=65472&&o<=65534)return{u:null,M:o,offset:r};for(var s=i(e,a);!(s>=65472&&s<=65534);){if(++a>=n)return null;s=i(e,a)}return{u:o.toString(16),M:s,offset:a}}return u.prototype={parse(t,n){null==n&&(n={});var a,o,s=n.F,f=0,l=null,h=null,u=0;function c(){var e=i(t,f),r=(f+=2)+e-2,n=m(t,r,f);n&&n.u&&(r=n.offset);var a=t.subarray(f,r);return f+=a.length,a}function g(e){for(var r=Math.ceil(e.o/8/e.X),t=Math.ceil(e.s/8/e.B),i=0;i<e.W.length;i++){W=e.W[i];var n=Math.ceil(Math.ceil(e.o/8)*W.h/e.X),a=Math.ceil(Math.ceil(e.s/8)*W.A/e.B),o=r*W.h,s=t*W.A*64*(o+1);W.D=new Int16Array(s),W.P=n,W.c=a}e.m=r,e.R=t}var p=[],b=[],y=[],_=i(t,f);if(f+=2,65496!==_)throw new r("SOI not found");_=i(t,f),f+=2;e:for(;65497!==_;){var I,A,U;switch(_){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var B=c();65504===_&&74===B[0]&&70===B[1]&&73===B[2]&&70===B[3]&&0===B[4]&&(l={version:{d:B[5],T:B[6]},K:B[7],j:B[8]<<8|B[9],H:B[10]<<8|B[11],S:B[12],I:B[13],C:B.subarray(14,14+3*B[12]*B[13])}),65518===_&&65===B[0]&&100===B[1]&&111===B[2]&&98===B[3]&&101===B[4]&&(h={version:B[5]<<8|B[6],k:B[7]<<8|B[8],q:B[9]<<8|B[10],a:B[11]});break;case 65499:for(var E=i(t,f)+(f+=2)-2;f<E;){var D=t[f++],T=new Uint16Array(64);if(D>>4==0)for(A=0;A<64;A++)T[e[A]]=t[f++];else{if(D>>4!=1)throw new r("DQT - invalid table spec");for(A=0;A<64;A++)T[e[A]]=i(t,f),f+=2}p[15&D]=T}break;case 65472:case 65473:case 65474:if(a)throw new r("Only single frame JPEGs supported");f+=2,(a={}).G=65473===_,a.Z=65474===_,a.precision=t[f++];var C,M=i(t,f),P=0,S=0;f+=2,a.s=s||M,a.o=i(t,f),f+=2,a.W=[],a._={};var F=t[f++];for(I=0;I<F;I++){C=t[f];var L=t[f+1]>>4,x=15&t[f+1];P<L&&(P=L),S<x&&(S=x);var k=t[f+2];U=a.W.push({h:L,A:x,L:k,$:null}),a._[C]=U-1,f+=3}a.X=P,a.B=S,g(a);break;case 65476:var O=i(t,f);for(f+=2,I=2;I<O;){var R=t[f++],H=new Uint8Array(16),N=0;for(A=0;A<16;A++,f++)N+=H[A]=t[f];var G=new Uint8Array(N);for(A=0;A<N;A++,f++)G[A]=t[f];I+=17+N,(R>>4==0?y:b)[15&R]=d(H,G)}break;case 65501:o=i(t,f+=2),f+=2;break;case 65498:var W,J=1==++u&&!s;f+=2;var j=t[f++],z=[];for(I=0;I<j;I++){var V=t[f++],q=a._[V];(W=a.W[q]).index=V;var $=t[f++];W.J=y[$>>4],W.i=b[15&$],z.push(W)}var X=t[f++],Y=t[f++],Q=t[f++];try{var Z=v(t,f,a,z,o,X,Y,Q>>4,15&Q,J);f+=Z}catch(e){if(e instanceof DNLMarkerError)return this.parse(t,{F:e.s});if(e instanceof EOIMarkerError)break e;throw e}break;case 65500:f+=4;break;case 65535:255!==t[f]&&f--;break;default:var K=m(t,f-2,f-3);if(K&&K.u){f=K.offset;break}if(f>=t.length-1)break e;throw new r("JpegImage.parse - unknown marker: "+_.toString(16))}_=i(t,f),f+=2}for(this.width=a.o,this.height=a.s,this.g=l,this.b=h,this.W=[],I=0;I<a.W.length;I++){var ee=p[(W=a.W[I]).L];ee&&(W.$=ee),this.W.push({index:W.index,e:w(0,W),l:W.h/a.X,t:W.A/a.B,P:W.P,c:W.c})}this.p=this.W.length},Y(e,r,t){null==t&&(t=!1);var i,n,a,o,s,f,l,h,u,d,c,v,g=this.width/e,w=this.height/r,m=0,p=this.W.length,b=e*r*p,y=new Uint8ClampedArray(b),_=new Uint32Array(e),I=4294967288;for(l=0;l<p;l++){if(n=(i=this.W[l]).l*g,a=i.t*w,m=l,c=i.e,o=i.P+1<<3,n!==v){for(s=0;s<e;s++)h=0|s*n,_[s]=(h&I)<<3|7&h;v=n}for(f=0;f<r;f++)for(d=o*((h=0|f*a)&I)|(7&h)<<3,s=0;s<e;s++)y[m]=c[d+_[s]],m+=p}var A=this.V;if(t||4!==p||A||(A=new Int32Array([-256,255,-256,255,-256,255,-256,255])),A)for(l=0;l<b;)for(h=0,u=0;h<p;h++,l++,u+=2)y[l]=(y[l]*A[u]>>8)+A[u+1];return y},get f(){return this.b?!!this.b.a:3===this.p?0!==this.N&&(82!==this.W[0].index||71!==this.W[1].index||66!==this.W[2].index):1===this.N},z:function(e){for(var r,t,i,n=0,a=e.length;n<a;n+=3)r=e[n],t=e[n+1],i=e[n+2],e[n]=r-179.456+1.402*i,e[n+1]=r+135.459-.344*t-.714*i,e[n+2]=r-226.816+1.772*t;return e},O:function(e){for(var r,t,i,n,a=0,o=0,s=e.length;o<s;o+=4)r=e[o],t=e[o+1],i=e[o+2],n=e[o+3],e[a++]=t*(-660635669420364e-19*t+.000437130475926232*i-54080610064599e-18*r+.00048449797120281*n-.154362151871126)-122.67195406894+i*(-.000957964378445773*i+.000817076911346625*r-.00477271405408747*n+1.53380253221734)+r*(.000961250184130688*r-.00266257332283933*n+.48357088451265)+n*(-.000336197177618394*n+.484791561490776),e[a++]=107.268039397724+t*(219927104525741e-19*t-.000640992018297945*i+.000659397001245577*r+.000426105652938837*n-.176491792462875)+i*(-.000778269941513683*i+.00130872261408275*r+.000770482631801132*n-.151051492775562)+r*(.00126935368114843*r-.00265090189010898*n+.25802910206845)+n*(-.000318913117588328*n-.213742400323665),e[a++]=t*(-.000570115196973677*t-263409051004589e-19*i+.0020741088115012*r-.00288260236853442*n+.814272968359295)-20.810012546947+i*(-153496057440975e-19*i-.000132689043961446*r+.000560833691242812*n-.195152027534049)+r*(.00174418132927582*r-.00255243321439347*n+.116935020465145)+n*(-.000343531996510555*n+.24165260232407);return e.subarray(0,a)},r:function(e){for(var r,t,i,n=0,a=e.length;n<a;n+=4)r=e[n],t=e[n+1],i=e[n+2],e[n]=434.456-r-1.402*i,e[n+1]=119.541-r+.344*t+.714*i,e[n+2]=481.816-r-1.772*t;return e},U:function(e){for(var r,t,i,n,a=0,o=0,s=e.length;o<s;o+=4)r=e[o],t=e[o+1],i=e[o+2],n=e[o+3],e[a++]=255+r*(-6747147073602441e-20*r+.0008379262121013727*t+.0002894718188643294*i+.003264231057537806*n-1.1185611867203937)+t*(26374107616089405e-21*t-8626949158638572e-20*i-.0002748769067499491*n-.02155688794978967)+i*(-3878099212869363e-20*i-.0003267808279485286*n+.0686742238595345)-n*(.0003361971776183937*n+.7430659151342254),e[a++]=255+r*(.00013596372813588848*r+.000924537132573585*t+.00010567359618683593*i+.0004791864687436512*n-.3109689587515875)+t*(-.00023545346108370344*t+.0002702845253534714*i+.0020200308977307156*n-.7488052167015494)+i*(6834815998235662e-20*i+.00015168452363460973*n-.09751927774728933)-n*(.0003189131175883281*n+.7364883807733168),e[a++]=255+r*(13598650411385307e-21*r+.00012423956175490851*t+.0004751985097583589*i-36729317476630422e-22*n-.05562186980264034)+t*(.00016141380598724676*t+.0009692239130725186*i+.0007782692450036253*n-.44015232367526463)+i*(5.068882914068769e-7*i+.0017778369011375071*n-.7591454649749609)-n*(.0003435319965105553*n+.7063770186160144);return e.subarray(0,a)},getData:function(e){var t=e.width,i=e.height,n=e.forceRGB,a=e.isSourcePDF;if(this.p>4)throw new r("Unsupported color mode");var o=this.Y(t,i,a);if(1===this.p&&n){for(var s=o.length,f=new Uint8ClampedArray(3*s),l=0,h=0;h<s;h++){var u=o[h];f[l++]=u,f[l++]=u,f[l++]=u}return f}if(3===this.p&&this.f)return this.z(o);if(4===this.p){if(this.f)return n?this.O(o):this.r(o);if(n)return this.U(o)}return o}},u}();function i(e,r){return e[r]<<8|e[r+1]}e.JpegDecoder=t}(),e.encodeImage=function(r,t,i,n){var a={t256:[t],t257:[i],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[i],t279:[t*i*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(n)for(var o in n)a[o]=n[o];var s=new Uint8Array(e.encode([a])),f=new Uint8Array(r),l=new Uint8Array(1e3+t*i*4);for(o=0;o<s.length;o++)l[o]=s[o];for(o=0;o<f.length;o++)l[1e3+o]=f[o];return l.buffer},e.encode=function(r){var t=new Uint8Array(2e4),i=4,n=e._binBE;t[0]=t[1]=77,n.writeUshort(t,2,42);var a=8;n.writeUint(t,i,a),i+=4;for(var o=0;o<r.length;o++){var s=e._writeIFD(n,e._types.basic,t,a,r[o]);a=s[1],o<r.length-1&&(0!=(3&a)&&(a+=4-(3&a)),n.writeUint(t,s[0],a))}return t.slice(0,a).buffer},e.decode=function(r,i){null==i&&(i={parseMN:!0,debug:!1});var n=new Uint8Array(r),a=0,o=e._binBE.readASCII(n,a,2);a+=2;var s="II"==o?e._binLE:e._binBE;s.readUshort(n,a),a+=2;var f=s.readUint(n,a);a+=4;for(var l=[];;){var h=s.readUshort(n,f),u=s.readUshort(n,f+4);if(0!=h&&(u<1||13<u)){t("error in TIFF");break}if(e._readIFD(s,n,f,l,0,i),0==(f=s.readUint(n,f+2+12*h)))break}return l},e.decodeImage=function(r,i,n){if(!i.data){var a=new Uint8Array(r),o=e._binBE.readASCII(a,0,2);if(null!=i.t256){i.isLE="II"==o,i.width=i.t256[0],i.height=i.t257[0];var s=i.t259?i.t259[0]:1,f=i.t266?i.t266[0]:1;i.t284&&2==i.t284[0]&&t("PlanarConfiguration 2 should not be used!"),7==s&&i.t258&&i.t258.length>3&&(i.t258=i.t258.slice(0,3));var l=i.t277?i.t277[0]:1,h=(i.t258?i.t258[0]:1)*l;1==s&&null!=i.t279&&i.t278&&32803==i.t262[0]&&(h=Math.round(8*i.t279[0]/(i.width*i.t278[0]))),i.t50885&&4==i.t50885[0]&&(h=3*i.t258[0]);var u=8*Math.ceil(i.width*h/8),d=i.t273;(null==d||i.t322)&&(d=i.t324);var c=i.t279;1==s&&1==d.length&&(c=[i.height*(u>>>3)]),(null==c||i.t322)&&(c=i.t325);var v=new Uint8Array(i.height*(u>>>3)),g=0;if(null!=i.t322){var w=i.t322[0],m=i.t323[0],p=Math.floor((i.width+w-1)/w),b=Math.floor((i.height+m-1)/m),y=new Uint8Array(0|Math.ceil(w*m*h/8));console.log("====",p,b);for(var _=0;_<b;_++)for(var I=0;I<p;I++){var A=_*p+I;y.fill(0),e.decode._decompress(i,n,a,d[A],c[A],s,y,0,f,w,m),6==s?v=y:e._copyTile(y,0|Math.ceil(w*h/8),m,v,0|Math.ceil(i.width*h/8),i.height,0|Math.ceil(I*w*h/8),_*m)}g=8*v.length}else{if(null==d)return;var U=i.t278?i.t278[0]:i.height;for(U=Math.min(U,i.height),A=0;A<d.length;A++)e.decode._decompress(i,n,a,d[A],c[A],s,v,0|Math.ceil(g/8),f,i.width,U),g+=u*U;g=Math.min(g,8*v.length)}i.data=new Uint8Array(v.buffer,0,0|Math.ceil(g/8))}}},e.decode._decompress=function(r,i,n,a,o,s,f,l,h,u,d){if(r.t271&&"Panasonic"==r.t271[0]&&r.t45&&6==r.t45[0]&&(s=34316),1==s)for(var c=0;c<o;c++)f[l+c]=n[a+c];else if(2==s)e.decode._decodeG2(n,a,o,f,l,u,h);else if(3==s)e.decode._decodeG3(n,a,o,f,l,u,h,!!r.t292&&1==(1&r.t292[0]));else if(4==s)e.decode._decodeG4(n,a,o,f,l,u,h);else if(5==s)e.decode._decodeLZW(n,a,o,f,l,8);else if(6==s)e.decode._decodeOldJPEG(r,n,a,o,f,l);else if(7==s||34892==s)e.decode._decodeNewJPEG(r,n,a,o,f,l);else if(8==s||32946==s){var v=new Uint8Array(n.buffer,a+2,o-6),g=e._inflateRaw(v);l+g.length<=f.length&&f.set(g,l)}else 9==s?e.decode._decodeVC5(n,a,o,f,l,r.t33422):32767==s?e.decode._decodeARW(r,n,a,o,f,l):32773==s?e.decode._decodePackBits(n,a,o,f,l):32809==s?e.decode._decodeThunder(n,a,o,f,l):34316==s?e.decode._decodePanasonic(r,n,a,o,f,l):34713==s?e.decode._decodeNikon(r,i,n,a,o,f,l):34676==s?e.decode._decodeLogLuv32(r,n,a,o,f,l):t("Unknown compression",s);var w=r.t258?Math.min(32,r.t258[0]):1,m=r.t277?r.t277[0]:1,p=w*m>>>3,b=Math.ceil(w*m*u/8);if(16==w&&!r.isLE&&null==r.t33422)for(var y=0;y<d;y++)for(var _=l+y*b,I=1;I<b;I+=2){var A=f[_+I];f[_+I]=f[_+I-1],f[_+I-1]=A}if(r.t317&&2==r.t317[0])for(y=0;y<d;y++){var U=l+y*b;if(16==w)for(c=p;c<b;c+=2){var B=(f[U+c+1]<<8|f[U+c])+(f[U+c-p+1]<<8|f[U+c-p]);f[U+c]=255&B,f[U+c+1]=B>>>8&255}else if(3==m)for(c=3;c<b;c+=3)f[U+c]=f[U+c]+f[U+c-3]&255,f[U+c+1]=f[U+c+1]+f[U+c-2]&255,f[U+c+2]=f[U+c+2]+f[U+c-1]&255;else for(c=p;c<b;c++)f[U+c]=f[U+c]+f[U+c-p]&255}},e.decode._decodePanasonic=function(e,r,t,i,n,a){var o,s,f,l,h,u,d,c,v=r.buffer,g=e.t2[0],w=e.t3[0],m=e.t10[0],p=e.t45[0],b=0,y=0,_=0,I=0,A=6==p?new Uint32Array(18):new Uint8Array(16),U=[0,0],B=[0,0],E=0,D=new Uint8Array(16384),T=new Uint16Array(n.buffer);function C(e){if(0==_){var r=new Uint8Array(v,t+y+8184,8200),i=new Uint8Array(v,t+y,8184);D.set(r),D.set(i,r.length),y+=16384}if(5!=p)return(D[I=(_=_-e&131071)>>3^16368]|D[I+1]<<8)>>(7&_)&~(-1<<e);for(o=0;o<16;o++)A[o]=D[_++],_&=16383}function M(e){return D[_+15-e]}function P(){U[0]=0,U[1]=0,B[0]=0,B[1]=0}if(7==p)throw p;if(6==p){var S=12==m,F=S?function(){A[0]=M(0)<<4|M(1)>>4,A[1]=4095&((15&M(1))<<8|M(2)),A[2]=M(3)>>6&3,A[3]=(63&M(3))<<2|M(4)>>6,A[4]=(63&M(4))<<2|M(5)>>6,A[5]=(63&M(5))<<2|M(6)>>6,A[6]=M(6)>>4&3,A[7]=(15&M(6))<<4|M(7)>>4,A[8]=(15&M(7))<<4|M(8)>>4,A[9]=(15&M(8))<<4|M(9)>>4,A[10]=M(9)>>2&3,A[11]=(3&M(9))<<6|M(10)>>2,A[12]=(3&M(10))<<6|M(11)>>2,A[13]=(3&M(11))<<6|M(12)>>2,A[14]=3&M(12),A[15]=M(13),A[16]=M(14),A[17]=M(15),_+=16,I=0}:function(){A[0]=M(0)<<6|M(1)>>2,A[1]=16383&((3&M(1))<<12|M(2)<<4|M(3)>>4),A[2]=M(3)>>2&3,A[3]=(3&M(3))<<8|M(4),A[4]=M(5)<<2|M(6)>>6,A[5]=(63&M(6))<<4|M(7)>>4,A[6]=M(7)>>2&3,A[7]=(3&M(7))<<8|M(8),A[8]=M(9)<<2&1020|M(10)>>6,A[9]=1023&(M(10)<<4|M(11)>>4),A[10]=M(11)>>2&3,A[11]=(3&M(11))<<8|M(12),A[12]=1023&(M(13)<<2&1020|M(14)>>6),A[13]=1023&(M(14)<<4|M(15)>>4),_+=16,I=0},L=S?14:11,x=S?128:512,k=S?2048:8192,O=S?16383:65535,R=S?4095:16383,H=g/L,N=16*H,G=S?18:14;for(u=0;u<w-15;u+=16){var W=Math.min(16,w-u),J=N*W;for(D=new Uint8Array(v,t+b,J),_=0,b+=J,c=0,d=0;c<W;c++,d=0){E=(u+c)*g;for(var j=0;j<H;j++)for(F(),P(),f=0,h=0,o=0;o<L;o++){if(l=1&o,o%3==2){var z=I<G?A[I++]:0;3==z&&(z=4),h=x<<z,f=1<<z}var V=I<G?A[I++]:0;U[l]?(V*=f,h<k&&B[l]>h&&(V+=B[l]-h),B[l]=V):(U[l]=V,V?B[l]=V:V=B[l]),T[E+d++]=V-15<=O?V-15&O:V+2147483633>>31&R}}}}else if(5==p){var q=12==m?10:9;for(u=0;u<w;u++)for(d=0;d<g;d+=q)C(0),12==m?(T[E++]=((15&A[1])<<8)+A[0],T[E++]=16*A[2]+(A[1]>>4),T[E++]=((15&A[4])<<8)+A[3],T[E++]=16*A[5]+(A[4]>>4),T[E++]=((15&A[7])<<8)+A[6],T[E++]=16*A[8]+(A[7]>>4),T[E++]=((15&A[10])<<8)+A[9],T[E++]=16*A[11]+(A[10]>>4),T[E++]=((15&A[13])<<8)+A[12],T[E++]=16*A[14]+(A[13]>>4)):14==m&&(T[E++]=A[0]+((63&A[1])<<8),T[E++]=(A[1]>>6)+4*A[2]+((15&A[3])<<10),T[E++]=(A[3]>>4)+16*A[4]+((3&A[5])<<12),T[E++]=((252&A[5])>>2)+(A[6]<<6),T[E++]=A[7]+((63&A[8])<<8),T[E++]=(A[8]>>6)+4*A[9]+((15&A[10])<<10),T[E++]=(A[10]>>4)+16*A[11]+((3&A[12])<<12),T[E++]=((252&A[12])>>2)+(A[13]<<6),T[E++]=A[14]+((63&A[15])<<8))}else{if(4!=p)throw p;for(u=0;u<w;u++)for(d=0;d<g;d++)l=1&(o=d%14),0==o&&P(),o%3==2&&(f=4>>3-C(2)),B[l]?0!=(s=C(8))&&(U[l]-=128<<f,(U[l]<0||4==f)&&(U[l]&=~(-1<<f)),U[l]+=s<<f):(B[l]=C(8),(B[l]||o>11)&&(U[l]=B[l]<<4|C(4))),T[E++]=U[1&d]}},e.decode._decodeVC5=function(){var r,t,i,n=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],a=[3,3,3,3,2,2,2,1,1,1];function o(e){var r=e[1],t=e[0][r>>>3]>>>7-(7&r)&1;return e[1]++,t}function s(e,t){if(null==r){r={};for(var i=0;i<n.length;i+=4)r[n[i+1]]=n.slice(i,i+4)}for(var a=o(e),s=r[a];null==s;)a=a<<1|o(e),s=r[a];var f=s[3];0!=f&&(f=0==o(e)?f:-f),t[0]=s[2],t[1]=f}function f(e,r){for(var t=0;t<r;t++)1==(1&e)&&e++,e>>>=1;return e}function l(e,r){return e>>r}function h(e,r,t,i,n,a){r[t]=l(l(11*e[n]-4*e[n+a]+e[n+a+a]+4,3)+e[i],1),r[t+a]=l(l(5*e[n]+4*e[n+a]-e[n+a+a]+4,3)-e[i],1)}function u(e,r,t,i,n,a){var o=e[n-a]-e[n+a],s=e[n],f=e[i];r[t]=l(l(o+4,3)+s+f,1),r[t+a]=l(l(4-o,3)+s-f,1)}function d(e,r,t,i,n,a){r[t]=l(l(5*e[n]+4*e[n-a]-e[n-a-a]+4,3)+e[i],1),r[t+a]=l(l(11*e[n]-4*e[n-a]+e[n-a-a]+4,3)-e[i],1)}function c(e){return i[e=e<0?0:e>4095?4095:e]>>>2}return function(r,n,o,l,v,g){l=new Uint16Array(l.buffer);var w,m,p,b,y,_,I,A,U=Date.now(),B=e._binBE,E=n+o;n+=4;for(var D=1==g[0];n<E;){var T=B.readShort(r,n),C=B.readUshort(r,n+2);if(n+=4,12==T)k=C;else if(20==T)w=C;else if(21==T)m=C;else if(48==T)p=C;else if(53==T)b=C;else if(35==T);else if(62==T)y=C;else if(101==T);else if(109==T)_=C;else if(84==T);else if(106==T);else if(107==T);else if(108==T);else if(102==T);else if(104==T)te=C;else if(105==T);else{var M=T<0?-T:T,P=65280&M,S=0;if(24576&M&&(8192&M?(S=65535&C,S+=(255&M)<<16):S=65535&C),24576==(24576&M)){if(null==I){I=[];for(var F=0;F<4;F++)I[F]=new Int16Array((w>>>1)*(m>>>1));for(A=new Int16Array((w>>>1)*(m>>>1)),t=new Int16Array(1024),F=0;F<1024;F++){var L=F-512,x=Math.abs(L),k=Math.floor(768*x*x*x/16581375)+x;t[F]=Math.sign(L)*k}for(i=new Uint16Array(4096),F=0;F<4096;F++){var O=F,R=65535*(Math.pow(113,O/4095)-1)/112;i[F]=Math.min(R,65535)}}var H=I[y],N=f(w,1+a[p]),G=f(m,1+a[p]);if(0==p)for(var W=0;W<G;W++)for(var J=0;J<N;J++){var j=n+2*(W*N+J);H[W*(w>>>1)+J]=r[j]<<8|r[j+1]}else{var z=[r,8*n],V=[],q=0,$=N*G,X=[0,0],Y=0;for(C=0;q<$;)for(s(z,X),Y=X[0],C=X[1];Y>0;)V[q++]=C,Y--;var Q=(p-1)%3,Z=1!=Q?N:0,K=0!=Q?G:0;for(W=0;W<G;W++){var ee=(W+K)*(w>>>1)+Z,re=W*N;for(J=0;J<N;J++)H[ee+J]=t[V[re+J]+512]*b}if(2==Q){var te=w>>>1,ie=2*N,ne=2*G;for(W=0;W<G;W++)for(J=0;J<ie;J++){F=2*W*te+J;var ae=G*te+(se=W*te+J);0==W?h(H,A,F,ae,se,te):W==G-1?d(H,A,F,ae,se,te):u(H,A,F,ae,se,te)}var oe=H;for(H=A,A=oe,W=0;W<ne;W++)for(J=0;J<N;J++){var se;F=W*te+2*J,ae=N+(se=W*te+J),0==J?h(H,A,F,ae,se,1):J==N-1?d(H,A,F,ae,se,1):u(H,A,F,ae,se,1)}oe=H,H=A,A=oe;for(var fe=[],le=2-~~((p-1)/3),he=0;he<3;he++)fe[he]=_>>14-2*he&3;var ue=fe[le];if(0!=ue)for(W=0;W<ne;W++)for(J=0;J<ie;J++)H[F=W*te+J]=H[F]<<ue}}if(9==p&&3==y){var de=I[0],ce=I[1],ve=I[2],ge=I[3];for(W=0;W<m;W+=2)for(J=0;J<w;J+=2){var we=W*w+J,me=de[j=(W>>>1)*(w>>>1)+(J>>>1)],pe=ce[j]-2048,be=ve[j]-2048,ye=ge[j]-2048,_e=(pe<<1)+me,Ie=(be<<1)+me,Ae=me+ye,Ue=me-ye;D?(l[we]=c(Ae),l[we+1]=c(Ie),l[we+w]=c(_e),l[we+w+1]=c(Ue)):(l[we]=c(_e),l[we+1]=c(Ae),l[we+w]=c(Ue),l[we+w+1]=c(Ie))}}n+=4*S}else if(16388==M)n+=4*S;else if(8192!=P&&8448!=P&&9216!=P)throw M.toString(16)}}console.log(Date.now()-U)}}(),e.decode._decodeLogLuv32=function(e,r,t,i,n,a){for(var o=e.width,s=4*o,f=0,l=new Uint8Array(s);f<i;){for(var h=0;h<s;){var u=r[t+f];if(f++,u<128){for(var d=0;d<u;d++)l[h+d]=r[t+f+d];h+=u,f+=u}else{for(u-=126,d=0;d<u;d++)l[h+d]=r[t+f];h+=u,f++}}for(var c=0;c<o;c++)n[a+0]=l[c],n[a+1]=l[c+o],n[a+2]=l[c+2*o],n[a+4]=l[c+3*o],a+=6}},e.decode._ljpeg_diff=function(r,t,i){var n,a,o=e.decode._getbithuff;return n=o(r,t,i[0],i),0==((a=o(r,t,n,0))&1<<n-1)&&(a-=(1<<n)-1),a},e.decode._decodeARW=function(r,t,i,n,a,o){var s=r.t256[0],f=r.t257[0],l=r.t258[0],h=r.isLE?e._binLE:e._binBE;if(s*f==n||s*f*1.5==n)if(s*f*1.5!=n){var u,d,c,v,g,w,m,p,b=new Uint16Array(16),y=new Uint8Array(s+1);for(T=0;T<f;T++){for(var _=0;_<s;_++)y[_]=t[i++];for(p=0,D=0;D<s-30;p+=16){for(d=2047&(u=h.readUint(y,p)),c=2047&u>>>11,v=15&u>>>22,g=15&u>>>26,w=0;w<4&&128<<w<=d-c;w++);for(m=30,I=0;I<16;I++)I==v?b[I]=d:I==g?b[I]=c:(b[I]=((h.readUshort(y,p+(m>>3))>>>(7&m)&127)<<w)+c,b[I]>2047&&(b[I]=2047),m+=7);for(I=0;I<16;I++,D+=2)k=b[I]<<1,e.decode._putsF(a,(T*s+D)*l,k<<16-l);D-=1&D?1:31}}}else for(var I=0;I<n;I+=3){var A=t[i+I+0],U=t[i+I+1],B=t[i+I+2];a[o+I]=U<<4|A>>>4,a[o+I+1]=A<<4|B>>>4,a[o+I+2]=B<<4|U>>>4}else{f+=8;var E,D,T,C=[i,0,0,0],M=new Uint16Array(32770),P=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],S=0,F=e.decode._ljpeg_diff;for(M[0]=15,E=I=0;I<18;I++)for(var L=32768>>>(P[I]>>>8),x=0;x<L;x++)M[++E]=P[I];for(D=s;D--;)for(T=0;T<f+1;T+=2)if(T==f&&(T=1),S+=F(t,C,M),T<f){var k=4095&S;e.decode._putsF(a,(T*s+D)*l,k<<16-l)}}},e.decode._decodeNikon=function(r,t,i,n,a,o,s){var f=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],l=r.t256[0],h=r.t257[0],u=r.t258[0],d=0,c=0,v=e.decode._make_decoder,g=e.decode._getbithuff,w=t[0].exifIFD.makerNote,m=w.t150?w.t150:w.t140,p=0,b=m[p++],y=m[p++];73!=b&&88!=y||(p+=2110),70==b&&(d=2),14==u&&(d+=3);for(var _=[[0,0],[0,0]],I=r.isLE?e._binLE:e._binBE,A=0;A<2;A++)for(var U=0;U<2;U++)_[A][U]=I.readShort(m,p),p+=2;var B,E,D,T,C,M=1<<u&32767,P=0,S=I.readShort(m,p);p+=2,S>1&&(P=Math.floor(M/(S-1))),68==b&&32==y&&P>0&&(c=I.readShort(m,562));var F=[0,0],L=v(f[d]),x=[n,0,0,0];for(B=0;B<h;B++)for(c&&B==c&&(L=v(f[d+1])),E=0;E<l;E++){A=g(i,x,L[0],L),0==((C=1+(g(i,x,(D=15&A)-(T=A>>>4),0)<<1)<<T>>>1)&1<<D-1)&&(C-=(1<<D)-(0==T?1:0)),E<2?F[E]=_[1&B][E]+=C:F[1&E]+=C;var k=Math.min(Math.max(F[1&E],0),(1<<u)-1),O=(B*l+E)*u;e.decode._putsF(o,O,k<<16-u)}},e.decode._putsF=function(e,r,t){t<<=8-(7&r);var i=r>>>3;e[i]|=t>>>16,e[i+1]|=t>>>8,e[i+2]|=t},e.decode._getbithuff=function(r,t,i,n){e.decode._get_byte;var a,o=t[0],s=t[1],f=t[2],l=t[3];if(0==i||f<0)return 0;for(;!l&&f<i&&-1!=(a=r[o++])&&!(l=0);)s=(s<<8)+a,f+=8;if(a=s<<32-f>>>32-i,n?(f-=n[a+1]>>>8,a=255&n[a+1]):f-=i,f<0)throw"e";return t[0]=o,t[1]=s,t[2]=f,t[3]=l,a},e.decode._make_decoder=function(e){var r,t,i,n,a,o=[];for(r=16;0!=r&&!e[r];r--);var s=17;for(o[0]=r,i=t=1;t<=r;t++)for(n=0;n<e[t];n++,++s)for(a=0;a<1<<r-t;a++)i<=1<<r&&(o[i++]=t<<8|e[s]);return o},e.decode._decodeNewJPEG=function(r,t,i,n,a,o){n=Math.min(n,t.length-i);var s=r.t347,f=s?s.length:0,l=new Uint8Array(f+n);if(s){for(var h=0,u=0;u<f-1&&(255!=s[u]||217!=s[u+1]);u++)l[h++]=s[u];var d=t[i],c=t[i+1];for(255==d&&216==c||(l[h++]=d,l[h++]=c),u=2;u<n;u++)l[h++]=t[i+u]}else for(u=0;u<n;u++)l[u]=t[i+u];if(32803==r.t262[0]||7==r.t259[0]&&34892==r.t262[0]){var v=r.t258[0],g=e.LosslessJpegDecode(l),w=g.length;if(16==v)if(r.isLE)for(u=0;u<w;u++)a[o+(u<<1)]=255&g[u],a[o+(u<<1)+1]=g[u]>>>8;else for(u=0;u<w;u++)a[o+(u<<1)]=g[u]>>>8,a[o+(u<<1)+1]=255&g[u];else if(14==v||12==v||10==v){var m=16-v;for(u=0;u<w;u++)e.decode._putsF(a,u*v,g[u]<<m)}else{if(8!=v)throw new Error("unsupported bit depth "+v);for(u=0;u<w;u++)a[o+u]=g[u]}}else{var p=new e.JpegDecoder;p.parse(l);var b=p.getData({width:p.width,height:p.height,forceRGB:!0,isSourcePDF:!1});for(u=0;u<b.length;u++)a[o+u]=b[u]}6==r.t262[0]&&(r.t262[0]=2)},e.decode._decodeOldJPEGInit=function(e,r,i,n){var a,o,s,f,l,h=216,u=0,d=0,c=!1,v=e.t513,g=v?v[0]:0,w=e.t514,m=w?w[0]:0,p=e.t324||e.t273||v,b=e.t530,y=0,_=0,I=e.t277?e.t277[0]:1,A=e.t515;if(p&&(d=p[0],c=p.length>1),!c){if(255==r[i]&&r[i+1]==h)return{jpegOffset:i};if(null!=v&&(255==r[i+g]&&r[i+g+1]==h?u=i+g:t("JPEGInterchangeFormat does not point to SOI"),null==w?t("JPEGInterchangeFormatLength field is missing"):(g>=d||g+m<=d)&&t("JPEGInterchangeFormatLength field value is invalid"),null!=u))return{jpegOffset:u}}if(null!=b&&(y=b[0],_=b[1]),null!=v&&null!=w)if(m>=2&&g+m<=d){for(a=255==r[i+g+m-2]&&r[i+g+m-1]==h?new Uint8Array(m-2):new Uint8Array(m),s=0;s<a.length;s++)a[s]=r[i+g+s];t("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else t("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==a){var U=0,B=[];B[U++]=255,B[U++]=h;var E=e.t519;if(null==E)throw new Error("JPEGQTables tag is missing");for(s=0;s<E.length;s++)for(B[U++]=255,B[U++]=219,B[U++]=0,B[U++]=67,B[U++]=s,f=0;f<64;f++)B[U++]=r[i+E[s]+f];for(l=0;l<2;l++){var D=e[0==l?"t520":"t521"];if(null==D)throw new Error((0==l?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(s=0;s<D.length;s++){B[U++]=255,B[U++]=196;var T=19;for(f=0;f<16;f++)T+=r[i+D[s]+f];for(B[U++]=T>>>8,B[U++]=255&T,B[U++]=s|l<<4,f=0;f<16;f++)B[U++]=r[i+D[s]+f];for(f=0;f<T;f++)B[U++]=r[i+D[s]+16+f]}}if(B[U++]=255,B[U++]=192,B[U++]=0,B[U++]=8+3*I,B[U++]=8,B[U++]=e.height>>>8&255,B[U++]=255&e.height,B[U++]=e.width>>>8&255,B[U++]=255&e.width,B[U++]=I,1==I)B[U++]=1,B[U++]=17,B[U++]=0;else for(s=0;s<3;s++)B[U++]=s+1,B[U++]=0!=s?17:(15&y)<<4|15&_,B[U++]=s;null!=A&&0!=A[0]&&(B[U++]=255,B[U++]=221,B[U++]=0,B[U++]=4,B[U++]=A[0]>>>8&255,B[U++]=255&A[0]),a=new Uint8Array(B)}var C=-1;for(s=0;s<a.length-1;){if(255==a[s]&&192==a[s+1]){C=s;break}s++}if(-1==C){var M=new Uint8Array(a.length+10+3*I);M.set(a);var P=a.length;if(C=a.length,(a=M)[P++]=255,a[P++]=192,a[P++]=0,a[P++]=8+3*I,a[P++]=8,a[P++]=e.height>>>8&255,a[P++]=255&e.height,a[P++]=e.width>>>8&255,a[P++]=255&e.width,a[P++]=I,1==I)a[P++]=1,a[P++]=17,a[P++]=0;else for(s=0;s<3;s++)a[P++]=s+1,a[P++]=0!=s?17:(15&y)<<4|15&_,a[P++]=s}if(255==r[d]&&218==r[d+1]){var S=r[d+2]<<8|r[d+3];for((o=new Uint8Array(S+2))[0]=r[d],o[1]=r[d+1],o[2]=r[d+2],o[3]=r[d+3],s=0;s<S-2;s++)o[s+4]=r[d+s+4]}else{var F=0;if((o=new Uint8Array(8+2*I))[F++]=255,o[F++]=218,o[F++]=0,o[F++]=6+2*I,o[F++]=I,1==I)o[F++]=1,o[F++]=0;else for(s=0;s<3;s++)o[F++]=s+1,o[F++]=s<<4|s;o[F++]=0,o[F++]=63,o[F++]=0}return{jpegOffset:i,tables:a,sosMarker:o,sofPosition:C}},e.decode._decodeOldJPEG=function(r,t,i,n,a,o){var s,f,l,h,u=e.decode._decodeOldJPEGInit(r,t,i,n);if(null!=u.jpegOffset)for(s=i+n-u.jpegOffset,l=new Uint8Array(s),v=0;v<s;v++)l[v]=t[u.jpegOffset+v];else{for(f=u.tables.length,(l=new Uint8Array(f+u.sosMarker.length+n+2)).set(u.tables),h=f,l[u.sofPosition+5]=r.height>>>8&255,l[u.sofPosition+6]=255&r.height,l[u.sofPosition+7]=r.width>>>8&255,l[u.sofPosition+8]=255&r.width,255==t[i]&&t[i+1]==SOS||(l.set(u.sosMarker,h),h+=sosMarker.length),v=0;v<n;v++)l[h++]=t[i+v];l[h++]=255,l[h++]=EOI}var d=new e.JpegDecoder;d.parse(l);for(var c=d.getData({width:d.width,height:d.height,forceRGB:!0,isSourcePDF:!1}),v=0;v<c.length;v++)a[o+v]=c[v];r.t262&&6==r.t262[0]&&(r.t262[0]=2)},e.decode._decodePackBits=function(e,r,t,i,n){for(var a=new Int8Array(e.buffer),o=new Int8Array(i.buffer),s=r+t;r<s;){var f=a[r];if(r++,f>=0&&f<128)for(var l=0;l<f+1;l++)o[n]=a[r],n++,r++;if(f>=-127&&f<0){for(l=0;l<1-f;l++)o[n]=a[r],n++;r++}}return n},e.decode._decodeThunder=function(e,r,t,i,n){for(var a=[0,1,0,-1],o=[0,1,2,3,0,-3,-2,-1],s=r+t,f=2*n,l=0;r<s;){var h=e[r],u=h>>>6,d=63&h;if(r++,3==u&&(l=15&d,i[f>>>1]|=l<<4*(1-f&1),f++),0==u)for(var c=0;c<d;c++)i[f>>>1]|=l<<4*(1-f&1),f++;if(2==u)for(c=0;c<2;c++)4!=(v=d>>>3*(1-c)&7)&&(l+=o[v],i[f>>>1]|=l<<4*(1-f&1),f++);if(1==u)for(c=0;c<3;c++){var v;2!=(v=d>>>2*(2-c)&3)&&(l+=a[v],i[f>>>1]|=l<<4*(1-f&1),f++)}}},e.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},e.decode._lens=function(){var e=function(e,r,t,i){for(var n=0;n<r.length;n++)e[r[n]]=t+n*i},r="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",t="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",i="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",n="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",a="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";r=r.split(","),t=t.split(","),i=i.split(","),n=n.split(","),a=a.split(",");var o={},s={};return e(o,r,0,1),e(o,i,64,64),e(o,a,1792,64),e(s,t,0,1),e(s,n,64,64),e(s,a,1792,64),[o,s]}(),e.decode._decodeG4=function(r,t,i,n,a,o,s){for(var f=e.decode,l=t<<3,h=0,u="",d=[],c=[],v=0;v<o;v++)c.push(0);c=f._makeDiff(c);for(var g=0,w=0,m=0,p=0,b=0,y=0,_="",I=0,A=8*Math.ceil(o/8);l>>>3<t+i;){m=f._findDiff(c,g+(0==g?0:1),1-b),p=f._findDiff(c,m,b);var U=0;if(1==s&&(U=r[l>>>3]>>>7-(7&l)&1),2==s&&(U=r[l>>>3]>>>(7&l)&1),l++,u+=U,"H"==_){if(null!=f._lens[b][u]){var B=f._lens[b][u];u="",h+=B,B<64&&(f._addNtimes(d,h,b),g+=h,b=1-b,h=0,0==--I&&(_=""))}}else"0001"==u&&(u="",f._addNtimes(d,p-g,b),g=p),"001"==u&&(u="",_="H",I=2),null!=f._dmap[u]&&(w=m+f._dmap[u],f._addNtimes(d,w-g,b),g=w,u="",b=1-b);d.length==o&&""==_&&(f._writeBits(d,n,8*a+y*A),b=0,y++,g=0,c=f._makeDiff(d),d=[])}},e.decode._findDiff=function(e,r,t){for(var i=0;i<e.length;i+=2)if(e[i]>=r&&e[i+1]==t)return e[i]},e.decode._makeDiff=function(e){var r=[];1==e[0]&&r.push(0,1);for(var t=1;t<e.length;t++)e[t-1]!=e[t]&&r.push(t,e[t]);return r.push(e.length,0,e.length,1),r},e.decode._decodeG2=function(r,t,i,n,a,o,s){for(var f=e.decode,l=t<<3,h=0,u="",d=[],c=0,v=0,g=8*Math.ceil(o/8);l>>>3<t+i;){var w=0;1==s&&(w=r[l>>>3]>>>7-(7&l)&1),2==s&&(w=r[l>>>3]>>>(7&l)&1),l++,u+=w,null!=(h=f._lens[c][u])&&(f._addNtimes(d,h,c),u="",h<64&&(c=1-c),d.length==o&&(f._writeBits(d,n,8*a+v*g),d=[],v++,c=0,0!=(7&l)&&(l+=8-(7&l)),h>=64&&(l+=8)))}},e.decode._decodeG3=function(r,t,i,n,a,o,s,f){for(var l=e.decode,h=t<<3,u=0,d="",c=[],v=[],g=0;g<o;g++)c.push(0);for(var w=0,m=0,p=0,b=0,y=0,_=-1,I="",A=0,U=!0,B=8*Math.ceil(o/8);h>>>3<t+i;){p=l._findDiff(v,w+(0==w?0:1),1-y),b=l._findDiff(v,p,y);var E=0;if(1==s&&(E=r[h>>>3]>>>7-(7&h)&1),2==s&&(E=r[h>>>3]>>>(7&h)&1),h++,d+=E,U){if(null!=l._lens[y][d]){var D=l._lens[y][d];d="",u+=D,D<64&&(l._addNtimes(c,u,y),y=1-y,u=0)}}else"H"==I?null!=l._lens[y][d]&&(D=l._lens[y][d],d="",u+=D,D<64&&(l._addNtimes(c,u,y),w+=u,y=1-y,u=0,0==--A&&(I=""))):("0001"==d&&(d="",l._addNtimes(c,b-w,y),w=b),"001"==d&&(d="",I="H",A=2),null!=l._dmap[d]&&(m=p+l._dmap[d],l._addNtimes(c,m-w,y),w=m,d="",y=1-y));d.endsWith("000000000001")&&(_>=0&&l._writeBits(c,n,8*a+_*B),f&&(1==s&&(U=1==(r[h>>>3]>>>7-(7&h)&1)),2==s&&(U=1==(r[h>>>3]>>>(7&h)&1)),h++),d="",y=0,_++,w=0,v=l._makeDiff(c),c=[])}c.length==o&&l._writeBits(c,n,8*a+_*B)},e.decode._addNtimes=function(e,r,t){for(var i=0;i<r;i++)e.push(t)},e.decode._writeBits=function(e,r,t){for(var i=0;i<e.length;i++)r[t+i>>>3]|=e[i]<<7-(t+i&7)},e.decode._decodeLZW=e.decode._decodeLZW=(o=0,s=0,f=0,l=0,h=function(){var e=r>>>3,t=(i[e]<<16|i[e+1]<<8|i[e+2])>>>24-(7&r)-s&(1<<s)-1;return r+=s,t},u=new Uint32Array(16384),d=0,c=function(e){s=e+1,o=l+1},v=function(e){for(var r=e<<2,t=u[r+2],i=a+t-1;65535!=r;)n[i--]=u[r],r=u[r+1];a+=t},g=function(e,r){var t=o<<2,i=e<<2;u[t]=u[3+(r<<2)],u[t+1]=i,u[t+2]=u[i+2]+1,u[t+3]=u[i+3],1+ ++o==1<<s&&12!=s&&s++},function(e,t,s,w,m,p){r=t<<3,i=e,n=w,a=m;var b=t+s<<3,y=0,_=0;for(function(e){if(e!=d){d=e,l=1+(f=1<<e);for(var r=0;r<l+1;r++)u[4*r]=u[4*r+3]=r,u[4*r+1]=65535,u[4*r+2]=1}}(p),c(p);r<b&&(y=h())!=l;){if(y==f){if(c(p),(y=h())==l)break;v(y)}else y<o?(v(y),g(_,y)):(g(_,_),v(o-1));_=y}return a}),e.tags={},e._types=((m=new Array(250)).fill(0),{basic:{main:m=m.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}),e._readIFD=function(r,i,n,a,o,s){var f=r.readUshort(i,n);n+=2;var l={};s.debug&&t("   ".repeat(o),a.length-1,">>>----------------");for(var h=0;h<f;h++){var u=r.readUshort(i,n);n+=2;var d=r.readUshort(i,n);n+=2;var c=r.readUint(i,n);n+=4;var v=r.readUint(i,n);n+=4;var g=[];if(1==d||7==d){var w=c<5?n-4:v;w+c>i.buffer.byteLength&&(c=i.buffer.byteLength-w),g=new Uint8Array(i.buffer,w,c)}if(2==d){var m=c<5?n-4:v,p=i[m],b=Math.max(0,Math.min(c-1,i.length-m));p<128||0==b?g.push(r.readASCII(i,m,b)):g=new Uint8Array(i.buffer,m,b)}if(3==d)for(var y=0;y<c;y++)g.push(r.readUshort(i,(c<3?n-4:v)+2*y));if(4==d||13==d)for(y=0;y<c;y++)g.push(r.readUint(i,(c<2?n-4:v)+4*y));if(5==d||10==d){var _=5==d?r.readUint:r.readInt;for(y=0;y<c;y++)g.push([_(i,v+8*y),_(i,v+8*y+4)])}if(8==d)for(y=0;y<c;y++)g.push(r.readShort(i,(c<3?n-4:v)+2*y));if(9==d)for(y=0;y<c;y++)g.push(r.readInt(i,(c<2?n-4:v)+4*y));if(11==d)for(y=0;y<c;y++)g.push(r.readFloat(i,v+4*y));if(12==d)for(y=0;y<c;y++)g.push(r.readDouble(i,v+8*y));if(0==c||0!=g.length){if(s.debug&&t("   ".repeat(o),u,d,e.tags[u],g),l["t"+u]=g,330==u&&l.t272&&"DSLR-A100"==l.t272[0]);else if(330==u||34665==u||34853==u||50740==u&&r.readUshort(i,r.readUint(g,0))<300||61440==u){var I=50740==u?[r.readUint(g,0)]:g,A=[];for(y=0;y<I.length;y++)e._readIFD(r,i,I[y],A,o+1,s);330==u&&(l.subIFD=A),34665==u&&(l.exifIFD=A[0]),34853==u&&(l.gpsiIFD=A[0]),50740==u&&(l.dngPrvt=A[0]),61440==u&&(l.fujiIFD=A[0])}if(37500==u&&s.parseMN){var U=g;if("Nikon"==r.readASCII(U,0,5))l.makerNote=e.decode(U.slice(10).buffer)[0];else if("OLYMP"==r.readASCII(U,0,5)||"OM SYSTEM"==r.readASCII(U,0,9)){var B=[8208,8224,8240,8256,8272],E=[];e._readIFD(r,U,77==U[1]?16:85==U[5]?12:8,E,o+1,s);var D=l.makerNote=E.pop();for(y=0;y<B.length;y++){var T="t"+B[y];null!=D[T]&&(e._readIFD(r,U,D[T][0],E,o+1,s),D[T]=E.pop())}D.t12288&&(e._readIFD(r,D.t12288,0,E,o+1,s),D.t12288=E.pop())}else r.readUshort(i,v)<300&&r.readUshort(i,v+4)<=12&&(E=[],e._readIFD(r,i,v,E,o+1,s),l.makerNote=E[0])}}else if(t(u,"unknown TIFF tag type: ",d,"num:",c),0==h)return}return a.push(l),s.debug&&t("   ".repeat(o),"<<<---------------"),n},e._writeIFD=function(r,t,i,n,a){var o=Object.keys(a),s=o.length;a.exifIFD&&s--,a.gpsiIFD&&s--,r.writeUshort(i,n,s);for(var f=(n+=2)+12*s+4,l=0;l<o.length;l++){var h=o[l];if("t34665"!=h&&"t34853"!=h){"exifIFD"==h&&(h="t34665"),"gpsiIFD"==h&&(h="t34853");var u=parseInt(h.slice(1)),d=t.main[u];if(null==d&&(d=t.rest[u]),null==d||0==d)throw new Error("unknown type of tag: "+u);var c=a[h];34665==u&&(c=[f],f=e._writeIFD(r,t,i,f,a.exifIFD)[1]),34853==u&&(c=[f],f=e._writeIFD(r,e._types.gps,i,f,a.gpsiIFD)[1]),2==d&&(c=c[0]+"\0");var v=c.length;r.writeUshort(i,n,u),n+=2,r.writeUshort(i,n,d),n+=2,r.writeUint(i,n,v);var g=[-1,1,1,2,4,8,0,1,0,4,8,0,8][d]*v,w=n+=4;if(g>4&&(r.writeUint(i,n,f),w=f),1==d||7==d)for(var m=0;m<v;m++)i[w+m]=c[m];else if(2==d)r.writeASCII(i,w,c);else if(3==d)for(m=0;m<v;m++)r.writeUshort(i,w+2*m,c[m]);else if(4==d)for(m=0;m<v;m++)r.writeUint(i,w+4*m,c[m]);else if(5==d||10==d){var p=5==d?r.writeUint:r.writeInt;for(m=0;m<v;m++){var b=c[m],y=b[0],_=b[1];if(null==y)throw"e";p(i,w+8*m,y),p(i,w+8*m+4,_)}}else if(9==d)for(m=0;m<v;m++)r.writeInt(i,w+4*m,c[m]);else{if(12!=d)throw d;for(m=0;m<v;m++)r.writeDouble(i,w+8*m,c[m])}g>4&&(f+=g+=1&g),n+=4}}return[n,f]},e.toRGBA8=function(e,r){function i(e){return e<.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}var n=e.width,a=e.height,o=n*a,s=e.data,f=new Uint8Array(4*o),l=e.t262?e.t262[0]:2,h=e.t258?Math.min(32,e.t258[0]):1;null==e.t262&&1==h&&(l=0);var u=e.t277?e.t277[0]:e.t258?e.t258.length:[1,1,3,1,1,4,3][l],d=e.t339?e.t339[0]:null;if(1==l&&32==h&&3!=d)throw"e";var c=Math.ceil(u*h*n/8);if(0==l){r=1/256;for(var v=0;v<a;v++){var g=v*c,w=v*n;if(1==h)for(var m=0;m<n;m++){var p=w+m<<2,b=s[g+(m>>3)]>>7-(7&m)&1;f[p]=f[p+1]=f[p+2]=255*(1-b),f[p+3]=255}if(4==h)for(m=0;m<n;m++)p=w+m<<2,b=s[g+(m>>1)]>>4-4*(1&m)&15,f[p]=f[p+1]=f[p+2]=17*(15-b),f[p+3]=255;if(8==h)for(m=0;m<n;m++)p=w+m<<2,b=s[g+m],f[p]=f[p+1]=f[p+2]=255-b,f[p+3]=255;if(16==h)for(m=0;m<n;m++)p=w+m<<2,b=s[(_=g+2*m)+1]<<8|s[_],f[p]=f[p+1]=f[p+2]=Math.min(255,255-~~(b*r)),f[p+3]=255}}else if(1==l){null==r&&(r=1/256);var y=0==(3&s.length)?new Float32Array(s.buffer):null;for(v=0;v<a;v++){if(g=v*c,w=v*n,1==h)for(m=0;m<n;m++)p=w+m<<2,b=s[g+(m>>3)]>>7-(7&m)&1,f[p]=f[p+1]=f[p+2]=255*b,f[p+3]=255;if(2==h)for(m=0;m<n;m++)p=w+m<<2,b=s[g+(m>>2)]>>6-2*(3&m)&3,f[p]=f[p+1]=f[p+2]=85*b,f[p+3]=255;if(8==h)for(m=0;m<n;m++)p=w+m<<2,b=s[g+m*u],f[p]=f[p+1]=f[p+2]=b,f[p+3]=255;if(16==h)for(m=0;m<n;m++)p=w+m<<2,b=s[(_=g+2*m)+1]<<8|s[_],f[p]=f[p+1]=f[p+2]=Math.min(255,~~(b*r)),f[p+3]=255;if(32==h)for(m=0;m<n;m++){var _;p=w+m<<2,b=y[_=(g>>>2)+m],f[p]=f[p+1]=f[p+2]=~~(.5+255*b),f[p+3]=255}}}else if(2==l)if(8==h){if(1==u)for(m=0;m<o;m++)f[4*m]=f[4*m+1]=f[4*m+2]=s[m],f[4*m+3]=255;if(3==u)for(m=0;m<o;m++){var I=3*m;f[p=m<<2]=s[I],f[p+1]=s[I+1],f[p+2]=s[I+2],f[p+3]=255}if(u>=4)for(m=0;m<o;m++)I=m*u,f[p=m<<2]=s[I],f[p+1]=s[I+1],f[p+2]=s[I+2],f[p+3]=s[I+3]}else if(16==h){if(4==u)for(m=0;m<o;m++)I=8*m+1,f[p=m<<2]=s[I],f[p+1]=s[I+2],f[p+2]=s[I+4],f[p+3]=s[I+6];if(3==u)for(m=0;m<o;m++)I=6*m+1,f[p=m<<2]=s[I],f[p+1]=s[I+2],f[p+2]=s[I+4],f[p+3]=255}else{if(32!=h)throw h;var A=new Float32Array(s.buffer),U=0;for(m=0;m<A.length;m++)U=Math.min(U,A[m]);if(U<0)for(m=0;m<s.length;m+=4){var B=s[m];s[m]=s[m+3],s[m+3]=B,B=s[m+1],s[m+1]=s[m+2],s[m+2]=B}var E=[];for(m=0;m<65536;m++)E.push(i(m/65535));for(m=0;m<A.length;m++){var D=Math.max(0,Math.min(1,A[m]));A[m]=E[~~(.5+65535*D)]}if(3==u)for(m=0;m<o;m++)I=3*m,f[p=m<<2]=~~(.5+255*A[I]),f[p+1]=~~(.5+255*A[I+1]),f[p+2]=~~(.5+255*A[I+2]),f[p+3]=255;else{if(4!=u)throw u;for(m=0;m<o;m++)I=4*m,f[p=m<<2]=~~(.5+255*A[I]),f[p+1]=~~(.5+255*A[I+1]),f[p+2]=~~(.5+255*A[I+2]),f[p+3]=~~(.5+255*A[I+3])}}else if(3==l){var T=e.t320,C=1<<h,M=8==h&&u>1&&e.t338&&0!=e.t338[0];for(v=0;v<a;v++)for(var P=0;P<n;P++){p=(m=v*n+P)<<2;var S=0,F=v*c;if(1==h)S=s[F+(P>>>3)]>>>7-(7&P)&1;else if(2==h)S=s[F+(P>>>2)]>>>6-2*(3&P)&3;else if(4==h)S=s[F+(P>>>1)]>>>4-4*(1&P)&15;else{if(8!=h)throw h;S=s[F+P*u]}f[p]=T[S]>>8,f[p+1]=T[C+S]>>8,f[p+2]=T[C+C+S]>>8,f[p+3]=M?s[F+P*u+1]:255}}else if(5==l){var L=u>4?1:0;for(m=0;m<o;m++){p=m<<2;var x=m*u;if(window.UDOC){var k=s[x],O=s[x+1],R=s[x+2],H=s[x+3],N=UDOC.C.cmykToRgb([k*(1/255),O*(1/255),R*(1/255),H*(1/255)]);f[p]=~~(.5+255*N[0]),f[p+1]=~~(.5+255*N[1]),f[p+2]=~~(.5+255*N[2])}else k=255-s[x],O=255-s[x+1],R=255-s[x+2],H=(255-s[x+3])*(1/255),f[p]=~~(k*H+.5),f[p+1]=~~(O*H+.5),f[p+2]=~~(R*H+.5);f[p+3]=255*(1-L)+s[x+4]*L}}else if(6==l&&e.t278){var G=e.t278[0];for(v=0;v<a;v+=G){m=v*n;for(var W=G*n,J=0;J<W;J++){p=4*(m+J),R=s[(x=3*m+4*(J>>>1))+(1&J)];var j=s[x+2]-128,z=s[x+3]-128,V=R+((z>>2)+(z>>3)+(z>>5)),q=R-((j>>2)+(j>>4)+(j>>5))-((z>>1)+(z>>3)+(z>>4)+(z>>5)),$=R+(j+(j>>1)+(j>>2)+(j>>6));f[p]=Math.max(0,Math.min(255,V)),f[p+1]=Math.max(0,Math.min(255,q)),f[p+2]=Math.max(0,Math.min(255,$)),f[p+3]=255}}}else if(32845==l)for(v=0;v<a;v++)for(P=0;P<n;P++){p=4*(v*n+P);var X=s[1+(x=6*(v*n+P))]<<8|s[x],Y=(X=Math.pow(2,(X+.5)/256-64),(s[x+3]+.5)/410),Q=(s[x+5]+.5)/410,Z=9*Y/(6*Y-16*Q+12),K=4*Q/(6*Y-16*Q+12),ee=Z*X/K,re=(1-Z-K)*X/K;V=2.69*ee-1.276*(R=X)-.414*re,q=-1.022*ee+1.978*R+.044*re,$=.061*ee-.224*R+1.163*re,f[p]=255*i(Math.min(V,1)),f[p+1]=255*i(Math.min(q,1)),f[p+2]=255*i(Math.min($,1)),f[p+3]=255}else t("Unknown Photometric interpretation: "+l);return f},e.replaceIMG=function(r){null==r&&(r=document.getElementsByTagName("img"));for(var t=["tif","tiff","dng","cr2","nef"],i=0;i<r.length;i++){var n=r[i],a=n.getAttribute("src");if(null!=a){var o=a.split(".").pop().toLowerCase();if(-1!=t.indexOf(o)){var s=new XMLHttpRequest;e._xhrs.push(s),e._imgs.push(n),s.open("GET",a),s.responseType="arraybuffer",s.onload=e._imgLoaded,s.send()}}}},e._xhrs=[],e._imgs=[],e._imgLoaded=function(r){var t=e._xhrs.indexOf(r.target),i=e._imgs[t];e._xhrs.splice(t,1),e._imgs.splice(t,1),i.setAttribute("src",e.bufferToURI(r.target.response))},e.bufferToURI=function(r){var t=e.decode(r),i=t,n=0,a=i[0];t[0].subIFD&&(i=i.concat(t[0].subIFD));for(var o=0;o<i.length;o++){var s=i[o];if(!(null==s.t258||s.t258.length<3)){var f=s.t256*s.t257;f>n&&(n=f,a=s)}}e.decodeImage(r,a,t);var l=e.toRGBA8(a),h=a.width,u=a.height,d=document.createElement("canvas");d.width=h,d.height=u;var c=d.getContext("2d"),v=new ImageData(new Uint8ClampedArray(l.buffer),h,u);return c.putImageData(v,0,0),d.toDataURL()},e._binBE={nextZero:function(e,r){for(;0!=e[r];)r++;return r},readUshort:function(e,r){return e[r]<<8|e[r+1]},readShort:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+1],i[1]=r[t+0],e._binBE.i16[0]},readInt:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+3],i[1]=r[t+2],i[2]=r[t+1],i[3]=r[t+0],e._binBE.i32[0]},readUint:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+3],i[1]=r[t+2],i[2]=r[t+1],i[3]=r[t+0],e._binBE.ui32[0]},readASCII:function(e,r,t){for(var i="",n=0;n<t;n++)i+=String.fromCharCode(e[r+n]);return i},readFloat:function(r,t){for(var i=e._binBE.ui8,n=0;n<4;n++)i[n]=r[t+3-n];return e._binBE.fl32[0]},readDouble:function(r,t){for(var i=e._binBE.ui8,n=0;n<8;n++)i[n]=r[t+7-n];return e._binBE.fl64[0]},writeUshort:function(e,r,t){e[r]=t>>8&255,e[r+1]=255&t},writeInt:function(r,t,i){var n=e._binBE.ui8;e._binBE.i32[0]=i,r[t+3]=n[0],r[t+2]=n[1],r[t+1]=n[2],r[t+0]=n[3]},writeUint:function(e,r,t){e[r]=t>>24&255,e[r+1]=t>>16&255,e[r+2]=t>>8&255,e[r+3]=t>>0&255},writeASCII:function(e,r,t){for(var i=0;i<t.length;i++)e[r+i]=t.charCodeAt(i)},writeDouble:function(r,t,i){e._binBE.fl64[0]=i;for(var n=0;n<8;n++)r[t+n]=e._binBE.ui8[7-n]}},e._binBE.ui8=new Uint8Array(8),e._binBE.i16=new Int16Array(e._binBE.ui8.buffer),e._binBE.i32=new Int32Array(e._binBE.ui8.buffer),e._binBE.ui32=new Uint32Array(e._binBE.ui8.buffer),e._binBE.fl32=new Float32Array(e._binBE.ui8.buffer),e._binBE.fl64=new Float64Array(e._binBE.ui8.buffer),e._binLE={nextZero:e._binBE.nextZero,readUshort:function(e,r){return e[r+1]<<8|e[r]},readShort:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],e._binBE.i16[0]},readInt:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],i[2]=r[t+2],i[3]=r[t+3],e._binBE.i32[0]},readUint:function(r,t){var i=e._binBE.ui8;return i[0]=r[t+0],i[1]=r[t+1],i[2]=r[t+2],i[3]=r[t+3],e._binBE.ui32[0]},readASCII:e._binBE.readASCII,readFloat:function(r,t){for(var i=e._binBE.ui8,n=0;n<4;n++)i[n]=r[t+n];return e._binBE.fl32[0]},readDouble:function(r,t){for(var i=e._binBE.ui8,n=0;n<8;n++)i[n]=r[t+n];return e._binBE.fl64[0]},writeUshort:function(e,r,t){e[r]=255&t,e[r+1]=t>>8&255},writeInt:function(r,t,i){var n=e._binBE.ui8;e._binBE.i32[0]=i,r[t+0]=n[0],r[t+1]=n[1],r[t+2]=n[2],r[t+3]=n[3]},writeUint:function(e,r,t){e[r]=t>>>0&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},writeASCII:e._binBE.writeASCII},e._copyTile=function(e,r,t,i,n,a,o,s){for(var f=Math.min(r,n-o),l=Math.min(t,a-s),h=0;h<l;h++)for(var u=(s+h)*n+o,d=h*r,c=0;c<f;c++)i[u+c]=e[d+c]},e._inflateRaw=((w={H:{}}).H.N=function(e,r){var t,i,n=Uint8Array,a=0,o=0,s=0,f=0,l=0,h=0,u=0,d=0,c=0;if(3==e[0]&&0==e[1])return r||new n(0);var v=w.H,g=v.b,m=v.e,p=v.R,b=v.n,y=v.A,_=v.Z,I=v.m,A=null==r;for(A&&(r=new n(e.length>>>2<<5));0==a;)if(a=g(e,c,1),o=g(e,c+1,2),c+=3,0!=o){if(A&&(r=w.H.W(r,d+(1<<17))),1==o&&(t=I.J,i=I.h,h=511,u=31),2==o){s=m(e,c,5)+257,f=m(e,c+5,5)+1,l=m(e,c+10,4)+4,c+=14;for(var U=1,B=0;B<38;B+=2)I.Q[B]=0,I.Q[B+1]=0;for(B=0;B<l;B++){var E=m(e,c+3*B,3);I.Q[1+(I.X[B]<<1)]=E,E>U&&(U=E)}c+=3*l,b(I.Q,U),y(I.Q,U,I.u),t=I.w,i=I.d,c=p(I.u,(1<<U)-1,s+f,e,c,I.v);var D=v.V(I.v,0,s,I.C);h=(1<<D)-1;var T=v.V(I.v,s,f,I.D);u=(1<<T)-1,b(I.C,D),y(I.C,D,t),b(I.D,T),y(I.D,T,i)}for(;;){var C=t[_(e,c)&h];c+=15&C;var M=C>>>4;if(M>>>8==0)r[d++]=M;else{if(256==M)break;var P=d+M-254;if(M>264){var S=I.q[M-257];P=d+(S>>>3)+m(e,c,7&S),c+=7&S}var F=i[_(e,c)&u];c+=15&F;var L=F>>>4,x=I.c[L],k=(x>>>4)+g(e,c,15&x);for(c+=15&x;d<P;)r[d]=r[d++-k],r[d]=r[d++-k],r[d]=r[d++-k],r[d]=r[d++-k];d=P}}}else{0!=(7&c)&&(c+=8-(7&c));var O=4+(c>>>3),R=e[O-4]|e[O-3]<<8;A&&(r=w.H.W(r,d+R)),r.set(new n(e.buffer,e.byteOffset+O,R),d),c=O+R<<3,d+=R}return r.length==d?r:r.slice(0,d)},w.H.W=function(e,r){var t=e.length;if(r<=t)return e;var i=new Uint8Array(t<<1);return i.set(e,0),i},w.H.R=function(e,r,t,i,n,a){for(var o=w.H.e,s=w.H.Z,f=0;f<t;){var l=e[s(i,n)&r];n+=15&l;var h=l>>>4;if(h<=15)a[f]=h,f++;else{var u=0,d=0;16==h?(d=3+o(i,n,2),n+=2,u=a[f-1]):17==h?(d=3+o(i,n,3),n+=3):18==h&&(d=11+o(i,n,7),n+=7);for(var c=f+d;f<c;)a[f]=u,f++}}return n},w.H.V=function(e,r,t,i){for(var n=0,a=0,o=i.length>>>1;a<t;){var s=e[a+r];i[a<<1]=0,i[1+(a<<1)]=s,s>n&&(n=s),a++}for(;a<o;)i[a<<1]=0,i[1+(a<<1)]=0,a++;return n},w.H.n=function(e,r){for(var t,i,n,a,o=w.H.m,s=e.length,f=o.j,l=0;l<=r;l++)f[l]=0;for(l=1;l<s;l+=2)f[e[l]]++;var h=o.K;for(t=0,f[0]=0,i=1;i<=r;i++)t=t+f[i-1]<<1,h[i]=t;for(n=0;n<s;n+=2)0!=(a=e[n+1])&&(e[n]=h[a],h[a]++)},w.H.A=function(e,r,t){for(var i=e.length,n=w.H.m.r,a=0;a<i;a+=2)if(0!=e[a+1])for(var o=a>>1,s=e[a+1],f=o<<4|s,l=r-s,h=e[a]<<l,u=h+(1<<l);h!=u;)t[n[h]>>>15-r]=f,h++},w.H.l=function(e,r){for(var t=w.H.m.r,i=15-r,n=0;n<e.length;n+=2){var a=e[n]<<r-e[n+1];e[n]=t[a]>>>i}},w.H.M=function(e,r,t){t<<=7&r;var i=r>>>3;e[i]|=t,e[i+1]|=t>>>8},w.H.I=function(e,r,t){t<<=7&r;var i=r>>>3;e[i]|=t,e[i+1]|=t>>>8,e[i+2]|=t>>>16},w.H.e=function(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<t)-1},w.H.b=function(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<t)-1},w.H.Z=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},w.H.i=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},w.H.m=function(){var e=Uint16Array,r=Uint32Array;return{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new e(65536),g:new e(32768)}}(),function(){for(var e=w.H.m,r=0;r<32768;r++){var t=r;t=(4278255360&(t=(4042322160&(t=(3435973836&(t=(2863311530&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8,e.r[r]=(t>>>16|t<<16)>>>17}function i(e,r,t){for(;0!=r--;)e.push(0,t)}for(r=0;r<32;r++)e.q[r]=e.S[r]<<3|e.T[r],e.c[r]=e.p[r]<<4|e.z[r];i(e._,144,8),i(e._,112,9),i(e._,24,7),i(e._,8,8),w.H.n(e._,9),w.H.A(e._,9,e.J),w.H.l(e._,9),i(e.$,32,5),w.H.n(e.$,5),w.H.A(e.$,5,e.h),w.H.l(e.$,5),i(e.Q,19,0),i(e.C,286,0),i(e.D,30,0),i(e.v,320,0)}(),w.H.N),e.LosslessJpegDecode=function(){var e,r;function t(){return e[r++]}function i(){return e[r++]<<8|e[r++]}function n(e){for(var r=t(),i=[0,0,0,255],n=[],o=0;o<16;o++)n[o]=t();for(o=0;o<16;o++)for(var s=0;s<n[o];s++)i[a(i,0,o+1,1)+3]=t();var f=new Uint8Array(256);for(e[r]=[new Uint8Array(i),f],o=0;o<256;o++){for(var l=8,h=o,u=0;255==i[u+3]&&0!=l;)u=i[u+(h>>--l&1)];f[o]=u}}function a(e,r,t,i){if(255!=e[r+3])return 0;if(0==t)return r;for(var n=0;n<2;n++){0==e[r+n]&&(e[r+n]=e.length,e.push(0,0,i,255));var o=a(e,e[r+n],t-1,i+1);if(0!=o)return o}return 0}function o(e){for(var r=e.b,t=e.f;r<25&&e.a<e.d;){var i=e.data[e.a++];255!=i||e.c||e.a++,t=t<<8|i,r+=8}if(r<0)throw"e";e.b=r,e.f=t}function s(e,r){return r.b<e&&o(r),r.f>>(r.b-=e)&65535>>16-e}function f(e,r){var t=e[0],i=0,n=255;r.b<16&&o(r);var a=r.f>>r.b-8&255;for(n=t[(i=e[1][a])+3],r.b-=t[i+2];255==n;)n=t[(i=t[i+(r.f>>--r.b&1)])+3];return n}function l(e,r){return e<32768>>16-r&&(e+=1-(1<<r)),e}function h(e,r){var t=f(e,r);return 0==t?0:16==t?-32768:l(s(t,r),t)}function u(e,r,t,i,n,a){for(var o=0,s=0;s<a;s++){for(var f=s*r,l=0;l<r;l+=n){o++;for(var u=0;u<n;u++)e[f+l+u]=h(i[u],t)}if(0!=t.e&&o%t.e==0&&0!=s){for(var d=t.a,c=t.data;255!=c[d]||!(208<=c[d+1]&&c[d+1]<=215);)d--;t.a=d+2,t.f=0,t.b=0}}}function d(e,r){return l(s(e,r),e)}function c(e,r,t,i,n,a,o,s){for(var f=t*o,l=n;l<a;l++)e[l]+=1<<s-1;for(var h=o;h<f;h+=o)for(l=n;l<a;l++)e[h+l]+=e[h+l-o];for(var u=1;u<i;u++){var d=u*f;for(l=n;l<a;l++)e[d+l]+=e[d+l-f];for(h=o;h<f;h+=o)for(l=n;l<a;l++){var c=d+h+l,v=c-f,g=e[c-o],w=0;if(0==r)w=0;else if(1==r)w=g;else if(2==r)w=e[v];else if(3==r)w=e[v-o];else if(4==r)w=g+(e[v]-e[v-o]);else if(5==r)w=g+(e[v]-e[v-o]>>>1);else if(6==r)w=e[v]+(g-e[v-o]>>>1);else{if(7!=r)throw r;w=g+e[v]>>>1}e[c]+=w}}}return function(a){if(e=a,r=0,65496!=i())throw"e";for(var o=[],s=0,l=0,h=0,v=[],g=[],w=[],m=0,p=0,b=0;;){var y=i();if(65535!=y){var _=i();if(65475==y){l=t(),p=i(),b=i(),m=t();for(var I=0;I<m;I++){var A=t(),U=t();if(0!=t())throw"e";o[A]=[I,U>>4,15&U]}}else if(65476==y)for(var B=r+_-2;r<B;)n(g);else{if(65498==y){for(r++,I=0;I<m;I++){var E=o[t()];w[E[0]]=g[t()>>>4],v[E[0]]=E.slice(1)}s=t(),r+=2;break}65501==y?h=i():r+=_-2}}else r--}var D=new(l>8?Uint16Array:Uint8Array)(p*b*m),T={b:0,f:0,c:8==s,a:r,data:e,d:e.length,e:h};if(T.c)!function(t,i,n,a,o){for(var s=e.length-r,l=0;l<s;l+=4){var h=e[r+l];e[r+l]=e[r+l+3],e[r+l+3]=h,h=e[r+l+1],e[r+l+1]=e[r+l+2],e[r+l+2]=h}for(var u=0;u<o;u++)for(var c=32768,v=32768,g=0;g<i;g+=2){var w=f(a,n),m=f(a,n);0!=w&&(c+=d(w,n)),0!=m&&(v+=d(m,n)),t[u*i+g]=65535&c,t[u*i+g+1]=65535&v}}(D,b*m,T,w[0],p);else{var C=[],M=0,P=0;for(I=0;I<m;I++){var S=v[I];(W=S[0])>M&&(M=W),(G=S[1])>P&&(P=G),C.push(W*G)}if(1!=M||1!=P){if(3!=m||1!=C[1]||1!=C[2])throw"e";if(2!=M||1!=P&&2!=P)throw"e";var F=[],L=0;for(I=0;I<m;I++){for(var x=0;x<C[I];x++)F.push(w[I]);L+=C[I]}var k=b/M,O=p/P,R=k*O;u(D,k*L,T,F,L,O),c(D,s,k,O,L-2,L,L,l);var H=new Uint16Array(R*C[0]);if(2==M&&2==P){for(I=0;I<R;I++)H[4*I]=D[6*I],H[4*I+1]=D[6*I+1],H[4*I+2]=D[6*I+2],H[4*I+3]=D[6*I+3];for(c(H,s,4*k,O,0,1,1,l),I=0;I<R;I++)D[6*I]=H[4*I],D[6*I+1]=H[4*I+1],D[6*I+2]=H[4*I+2],D[6*I+3]=H[4*I+3]}if(2==M&&1==P){for(I=0;I<R;I++)H[2*I]=D[4*I],H[2*I+1]=D[4*I+1];for(c(H,s,2*k,O,0,1,1,l),I=0;I<R;I++)D[4*I]=H[2*I],D[4*I+1]=H[2*I+1]}for(var N=D.slice(0),G=0;G<p;G++)if(2==P)for(var W=0;W<b;W++){var J=((G>>>1)*k+(W>>>1))*L,j=2*(1&G)+(1&W);D[z=(G*b+W)*m]=N[J+j],D[z+1]=N[J+4],D[z+2]=N[J+5]}else for(W=0;W<b;W++){var z;J=(G*k+(W>>>1))*L,j=1&W,D[z=(G*b+W)*m]=N[J+j],D[z+1]=N[J+2],D[z+2]=N[J+3]}}else if(u(D,b*m,T,w,m,p),0==h)c(D,s,b,p,0,m,m,l);else{var V=Math.floor(h/b);for(G=0;G<p;G+=V){var q=D.slice(G*b*m,(G+V)*b*m);c(q,s,b,V,0,m,m,l),D.set(q,G*b*m)}}}return D}}(),function(){var r=2,t=4,i=5,n=6,a=7,o=12,s=13,f=14,l=15,h=17;function u(e){for(var r=[[],[],[]],t=Math.max(2,e.w+32>>>6),i=0;i<3;i++)for(var n=0;n<41;n++)r[i][n]=[t,1];return r}function d(e,r){var t=0,i=8-e.a;if(e.j,e.a,r){if(r>=i)do{t<<=i,r-=i,t|=e[e.j]&(1<<i)-1,e.j++,i=8}while(r>=8);r&&(t<<=r,i-=r,t|=e[e.j]>>>i&(1<<r)-1),e.a=8-i}return t}function c(e,r,t,i,n,a,o,s){null==s&&(s=0);var f,l,h,u,c,v,g=a+1,w=g%2,m=0,p=i[n],b=i[n-1],y=i[n-2][g],_=b[g-1],I=b[g],A=b[g+1],U=p[g-1],B=p[g+1],E=Math.abs;if(w&&(h=E(A-I),u=E(y-I),c=E(_-I)),w){if(v=(v=h>c&&u<h?y+_:h<c&&u<c?y+A:A+_)+2*I>>>2,s)return void(p[g]=v);f=r.t*r.c[e.g+I-y]+r.c[e.g+_-I]}else v=I>_&&I>A||I<_&&I<A?B+U+2*I>>>2:U+B>>>1,f=r.t*r.c[e.g+I-_]+r.c[e.g+_-U];l=E(f);var D=function(e){for(var r=-1,t=0;!t;r++)t=e[e.j]>>>7-e.a&1,e.a++,e.a&=7,e.a||e.j++;return r}(t);if(D<e.n-r.v-1){var T=function(e,r){var t=0;if(r<e)for(;t<=14&&r<<++t<e;);return t}(o[l][0],o[l][1]);m=d(t,T)+(D<<T)}else m=d(t,r.v)+1;m=1&m?-1-(m>>>1):m>>>1,o[l][0]+=E(m),o[l][1]==e.f&&(o[l][0]>>>=1,o[l][1]>>>=1),o[l][1]++,v=f<0?v-m:v+m,e.i&&(v<0?v+=r.w:v>e.g&&(v-=r.w)),p[g]=v>=0?Math.min(v,e.g):0}function v(e,r,t){for(var i=e[0].length,n=r;n<=t;n++)e[n][0]=e[n-1][1],e[n][i-1]=e[n-1][i-2]}function g(e){v(e,a,o),v(e,r,t),v(e,l,h)}function w(e,r,i,n,a,o,f,l,h,u,d,v,w){for(var m=0,p=1,b=a<s&&a>t;p<e.m;)m<e.m&&(c(e,r,i,n,a,m,f[h],e.h&&(b&&u||!b&&(d||(m&v)==w))),c(e,r,i,n,o,m,f[h],e.h&&(!b&&u||b&&(d||(m&v)==w))),m+=2),m>8&&(c(e,r,i,n,a,p,l[h]),c(e,r,i,n,o,p,l[h]),p+=2);g(n)}function m(e,i,n,s,f,u){w(e,i,n,s,r,a,f,u,0,0,1,0,8),w(e,i,n,s,8,l,f,u,1,0,1,0,8),w(e,i,n,s,3,9,f,u,2,1,0,3,0),w(e,i,n,s,10,16,f,u,0,0,0,3,2),w(e,i,n,s,t,11,f,u,1,0,0,3,2),w(e,i,n,s,o,h,f,u,2,1,0,3,0)}function p(e,t,i,n,o,s){var f=s.length,h=e.l;o+1==e.s&&(h=e.e-o*e.l);for(var u=6*e.e*n+o*e.l,d=0;d<6;d++){for(var c=0;c<h;c++){var v,g=s[d%f][c%f];v=0==g?r+(d>>>1):2==g?l+(d>>>1):a+d;var w=e.h?(2*c/3&2147483646|c%3&1)+(c%3>>>1):c>>>1;t[u+c]=i[v][w+1]}u+=e.e}}e._decompressRAF=function(a,l){var d=function(r){var t=e._binBE.readUshort,i={b:t(r,0),i:r[2],C:r[3],u:r[4],q:t(r,5),k:t(r,7),e:t(r,9),l:t(r,11),s:r[13],d:t(r,14)};if(18771!=i.b||i.i>1||i.q<6||i.q%6||i.e<768||i.e%24||768!=i.l||i.k<i.l||i.k%i.l||i.k-i.e>=i.l||i.s>16||i.s!=i.k/i.l||i.s!=Math.ceil(i.e/i.l)||i.d!=i.q/6||12!=i.u&&14!=i.u&&16!=i.u||16!=i.C&&0!=i.C)throw"Invalid data";if(0==i.i)throw"Not implemented. We need this file!";return i.h=16==i.C,i.m=0|(i.h?2*i.l/3:i.l>>>1),i.A=i.m+2,i.f=64,i.g=(1<<i.u)-1,i.n=4*i.u,i}(a),c=function(r,t){var i=new Array(t.s),n=4*t.s,a=16+n;12&n&&(a+=16-(12&n));for(var o=0,s=16;o<t.s;s+=4){var f=e._binBE.readUint(r,s);i[o]=r.slice(a,a+f),i[o].j=0,i[o].a=0,a+=f,o++}if(a!=r.length)throw"Invalid data";return i}(a,d),v=function(e){var r={c:new Int8Array(2<<e.u)};return function(e,r,t){var i=[0,18,67,276,t];e.o=0,e.w=(i[4]+0)/1+1|0,e.v=Math.ceil(Math.log2(e.w)),e.t=9,function(e,r){for(var t=-r[4],i=0;t<=r[4];i++,t++)e[i]=t<=-r[3]?-4:t<=-r[2]?-3:t<=-r[1]?-2:t<-r[0]?-1:t<=r[0]?0:t<r[1]?1:t<r[2]?2:t<r[3]?3:4}(e.c,i)}(r,0,e.g),r}(d),w=new Int16Array(d.e*d.q);null==l&&(l=d.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var b=[[0,3],[1,t],[i,11],[n,o],[s,16],[f,h]],y=[],_=0;_<18;_++)y[_]=new Uint16Array(d.A);for(var I=0;I<d.s;I++){var A=u(v),U=u(v);for(_=0;_<18;_++)for(var B=0;B<d.A;B++)y[_][B]=0;for(var E=0;E<d.d;E++){for(m(d,v,c[I],y,A,U),_=0;_<6;_++)for(B=0;B<d.A;B++)y[b[_][0]][B]=y[b[_][1]][B];for(p(d,w,y,E,I,l),_=r;_<18;_++)if(-1==[i,n,s,f].indexOf(_))for(B=0;B<d.A;B++)y[_][B]=0;g(y)}}return w}}()}(r)}()}},r={};function t(i){var n=r[i];if(void 0!==n)return n.exports;var a=r[i]={exports:{}};return e[i](a,a.exports,t),a.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{"use strict";var e=t(57),r=t.n(e);class i{#e=null;#r=0;#t=0;#i=!1;#n=null;imageProperties={currentRotation:0,currentScale:1};constructor(){}resetTransform(){this.#r=0,this.#t=0,this.imageProperties.currentScale=1,this.applyTransform()}applyTransform(e=!1){var r=`translate(${this.#r}px, ${this.#t}px) `;this.#e.classList.remove("rotate90"),this.#e.classList.remove("rotate270"),90===this.imageProperties.currentRotation&&e?(this.#e.classList.add("rotate90"),r="translateX(0%) translateY(-100%) "):270===this.imageProperties.currentRotation&&e&&(this.#e.classList.add("rotate270"),r="translateX(-100%) translateY(0%) "),this.#e.style.transform=r+` scale(${this.imageProperties.currentScale}) rotate(${this.imageProperties.currentRotation}deg)`}rotate(e,r=null){this.imageProperties.currentRotation=(this.imageProperties.currentRotation+e)%360,0!==r||1===this.imageProperties.currentScale?this.applyTransform(!0):this.resetTransform(!0)}zoomOnly(e,r=!0){e?this.imageProperties.currentScale*=1.2:this.imageProperties.currentScale/=1.2,r&&this.applyTransform()}setImage(e){this.#e=e,this.#i=!1,this.#n=null,this.#e.onmousedown=e=>{this.mousedown(e)},this.#e.onwheel=e=>{this.onwheel(e)},this.#e.ondblclick=()=>{this.zoomOnly(!0)},this.applyTransform()}mousedown(e){e.preventDefault(),this.#i=!0,this.#e.style.cursor="grabbing",this.#n={x:e.clientX-this.#r,y:e.clientY-this.#t}}mousemoved(e){this.#i&&(0!==e.buttons?(this.#r=e.clientX-this.#n.x,this.#t=e.clientY-this.#n.y,this.applyTransform()):this.#i=!1)}mousereleased(){this.#i&&(this.#i=!1,this.#e.style.cursor="grab")}onwheel(e){e.preventDefault();const r=e.wheelDelta?e.wheelDelta:-e.deltaY;this.zoomOnly(r>0,!1),this.applyTransform()}}class n{#e=null;#a=0;constructor(e,r){this.imageContainerId=e,this.imageContainer=document.querySelector("#"+e),this.toolbar=document.querySelector(r),this.toolbar.innerText="",this.zoomer=new i,this.addButton("btn-secondary rotateLeft","fa-solid fa-rotate-left","",(()=>this.rotateFix(270))),this.addButton("btn-secondary rotate180","fa-solid fa-arrows-rotate","",(()=>this.rotateFix(180))),this.addButton("btn-secondary rotateRight","fa-solid fa-rotate-right","",(()=>this.rotateFix(90))),this.addButton("btn-secondary","fa-solid fa-maximize","",(()=>{this.fitBest(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","fa-solid fa-arrows-left-right","",(()=>{this.fitWidth(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","","100%",(()=>{this.originalSize(),this.zoomer.resetTransform()})),this.addButton("btn-secondary","fa-solid fa-magnifying-glass-plus","",(()=>{this.zoomer.zoomOnly(!0)})),this.addButton("btn-secondary","fa-solid fa-magnifying-glass-minus","",(()=>{this.zoomer.zoomOnly(!1)})),window.addEventListener("mousemove",(e=>this.zoomer.mousemoved(e))),window.addEventListener("mouseup",(e=>this.zoomer.mousereleased(e)))}get image(){return this.#e}set image(e){switch(this.#e=e,this.#a){case 1:this.fitWidth();break;case 2:this.originalSize();break;default:this.fitBest()}this.zoomer.setImage(this.#e)}createButton(e,r,t,i){const n=document.createElement("button");return e&&e.split(" ").forEach((e=>{n.classList.add(e)})),n.classList.add("btn","rotate-button"),r&&(n.innerHTML=`<i class="fas ${r}"></i>`),n.innerHTML+=` ${t}`,n.addEventListener("click",i),n}addButton(e,r,t,i){const n=this.createButton(e,r,t,i);this.toolbar.appendChild(n)}rotateFix(e){this.zoomer.rotate(e,this.#a)}fitBest(){this.#a=0,this.#e.style.width="auto",this.#e.style.height="auto",this.#e.style.maxWidth="100%",this.#e.style.maxHeight="100%",this.centerTheImage()}fitWidth(){this.#a=1,this.#e.style.width="100%",this.#e.style.height="auto",this.#e.style.maxWidth="none",this.#e.style.maxHeight="none",this.topLeftImage()}originalSize(){this.#a=2,this.#e.style.width="auto",this.#e.style.height="auto",this.#e.style.maxWidth="none",this.#e.style.maxHeight="none",this.topLeftImage()}topLeftImage(){this.imageContainer.style.display="",this.imageContainer.style.alignItems="",this.imageContainer.style.justifyContent=""}centerTheImage(){this.imageContainer.style.display="flex",this.imageContainer.style.alignItems="center",this.imageContainer.style.justifyContent="center"}}class a{constructor(e,r,t){this.numPages=e,this.currentPage=1,this.toolbarSelector=r,this.gotoCallback=t,this.toolbar=this.createToolbar()}createToolbar(){const e=document.querySelector(this.toolbarSelector);if(this.numPages&&this.numPages<2)return void(e.innerText=" Page 1/1");e.innerText="",this.firstButton=this.createButton("btn-secondary","fa-solid fa-backward-step","",this.goToPage.bind(this,1)),this.prevButton=this.createButton("btn-secondary","fa-solid fa-left-long","",this.goToPreviousPage.bind(this)),this.nextButton=this.createButton("btn-secondary","fa-solid fa-right-long","",this.goToNextPage.bind(this)),this.lastButton=this.createButton("btn-secondary","fa-solid fa-forward-step","",this.goToPage.bind(this,this.numPages));const r=document.createElement("input");r.classList.add("pageNumber"),r.type="number",r.min=1,r.max=this.numPages,r.value=1,r.style.width=this.numPages.toString().length+3+"ch",r.style.textAlign="right",r.addEventListener("change",this.goToPage.bind(this,null));const t=document.createElement("span");return t.classList.add("pageCount"),t.innerHTML=" / "+this.numPages.toString(),this.firstButton.disabled=!0,e.appendChild(this.firstButton),this.prevButton.disabled=!0,e.appendChild(this.prevButton),e.appendChild(r),e.appendChild(t),e.appendChild(this.nextButton),e.appendChild(this.lastButton),e}createButton(e,r,t,i){const n=document.createElement("button");return e&&e.split(" ").forEach((e=>{n.classList.add(e)})),n.classList.add("btn","navigation-button"),n.innerHTML=`<i class="fas ${r}"></i> ${t}`,n.addEventListener("click",i),n}goToPage(e){const r=document.querySelector(this.toolbarSelector+" .pageNumber");e?(this.currentPage=parseInt(e),r.value=this.currentPage):this.currentPage=parseInt(r.value),this.firstButton.disabled=!1,this.prevButton.disabled=!1,this.nextButton.disabled=!1,this.lastButton.disabled=!1,1==this.currentPage?(this.firstButton.disabled=!0,this.prevButton.disabled=!0):this.currentPage==this.numPages&&(this.nextButton.disabled=!0,this.lastButton.disabled=!0),console.log(`Navigating to page ${this.currentPage}`),this.gotoCallback()}goToPreviousPage(){this.currentPage>1&&this.goToPage(this.currentPage-1)}goToNextPage(){this.currentPage<this.numPages&&this.goToPage(this.currentPage+1)}}window.AptTec=window.AptTec||{},window.AptTec.ViewerSources=Object.freeze({Url:"Url",Blob:"Blob",ArrayBuffer:"ArrayBuffer",DataURL:"DataURL"}),window.AptTec.Viewer=class{#o="";#s=null;#f=null;#l=null;#h=null;#u=null;#d=null;#c=null;constructor(e,r,t,i,a,o){if(!e)throw new Error("Mandatory argument 'viewerSource' is missing");if(!r)throw new Error("Mandatory argument 'source' is missing");if(!t)throw new Error("Mandatory argument 'fileFormat' is missing");if(!i)throw new Error("Mandatory argument 'imageContainerId' is missing");this.#d=t,this.#o=e,this.#s=r,this.#o===window.AptTec.ViewerSources.ArrayBuffer?(this.#l=r,this.#c=this.#o):this.#o===window.AptTec.ViewerSources.DataURL&&(this.#h=r,this.#c=this.#o),this.imageContainerId=i,this.toolbarContainer=a,this.pageToolbarContainer=o,this.imageSelector=`#${this.imageContainerId} #viewerImage`,this.imageOperations=new n(this.imageContainerId,this.toolbarContainer),this.navigationToolbar=null}async show(e=1){this.#c&&this.loadImage(e),this.#o===window.AptTec.ViewerSources.Url?await fetch(this.#s).then((e=>e.blob())).then((r=>this.loadfromBlob(r,e))):this.#o===window.AptTec.ViewerSources.Blob&&await this.loadfromBlob(this.#s,e)}async loadfromBlob(e,r){this.#d.includes("/tif")?await e.arrayBuffer().then((e=>{this.#c=window.AptTec.ViewerSources.ArrayBuffer,this.#l=e,this.loadImage(r)})):this.blobToDataURL(e,(function(e){this.#c=window.AptTec.ViewerSources.DataURL,this.#h=e,this.loadImage(r)}))}blobToDataURL(e,r){var t=new FileReader;t.onload=e=>{r(e.target.result)},t.readAsDataURL(e)}loadImage(e){const r=document.getElementById(this.imageContainerId);r.innerHTML="",r.innerHTML='<img id="viewerImage" alt="ViewerImage">',this.imageOperations.image=document.querySelector(this.imageSelector),this.#f&&URL.revokeObjectURL(this.#f),this.#c===window.AptTec.ViewerSources.DataURL?(this.#f=this.#h,this.pageCount=1):this.#f=this.#v(this.#l,e),this.navigationToolbar||(this.navigationToolbar=new a(this.pageCount,this.pageToolbarContainer,(()=>this.pagechanged()))),this.imageOperations.image.src=this.#f}pagechanged(){console.log(`Page changed to ${this.navigationToolbar.currentPage}`),this.loadImage(this.navigationToolbar.currentPage)}#v(e,t){const i=t-1;this.#u||(this.#u=r().decode(e),this.pageCount=this.#u.length);var n=this.#u,a=0,o=n[i];this.#u[i].subIFD&&(n=n.concat(this.#u[i].subIFD));for(var s=0;s<n.length;s++){var f=n[s];if(!(null==f.t258||f.t258.length<3)){var l=f.t256*f.t257;l>a&&(a=l,o=f)}}r().decodeImage(e,o,this.#u);var h=o.width,u=o.height;const d=r().toRGBA8(o);var c=document.createElement("canvas");c.width=h,c.height=u;var v=c.getContext("2d"),g=new ImageData(new Uint8ClampedArray(d.buffer),h,u);return v.putImageData(g,0,0),c.toDataURL()}},window.AptTec.FileInputViewer=class{constructor(e,r,t,i,n){this.fileIputId=e,this.imageContainerId=r,this.toolbarContainer=t,this.pageToolbarContainer=i,this.infoToolbarContainer=n,this.infoToolbarControl=document.querySelector(this.infoToolbarContainer),this.selectedFileType=null,document.getElementById(this.fileIputId).addEventListener("change",(e=>this.#g(e)))}#g(e){const r=e.target.files[0];if(r){if(this.selectedFileType=r.type,this.infoToolbarControl.style.display="inline-block",document.querySelector(".img-type").innerText=this.selectedFileType,document.querySelector(".img-size").innerText=(r.size/1024).toFixed(3)+" KB",!this.selectedFileType.startsWith("image/")&&!r.name.toLowerCase().includes(".tif"))return void this.#w("Please select a picture file format");const e=new FileReader;e.onload=e=>this.#m(e),this.selectedFileType.includes("/tif")||r.name.toLowerCase().includes(".tif")?(this.isTiff=!0,e.readAsArrayBuffer(r)):(this.isTiff=!1,e.readAsDataURL(r))}else this.#w("Please select a picture file format")}#m(e){var r=null,t=null;this.isTiff?(r=window.AptTec.ViewerSources.ArrayBuffer,t=new Uint8Array(e.target.result)):(r=window.AptTec.ViewerSources.DataURL,t=e.target.result);const i=new window.AptTec.Viewer(r,t,this.selectedFileType,this.imageContainerId,this.toolbarContainer,this.pageToolbarContainer);!async function(){await i.show()}()}#w(e){this.errorMessageControl=document.getElementById(this.imageContainerId),this.errorMessageControl.innerText=e,this.infoToolbarControl.style.display="none"}}})()})();
//# sourceMappingURL=AptTecImageViewer.bundle.js.map